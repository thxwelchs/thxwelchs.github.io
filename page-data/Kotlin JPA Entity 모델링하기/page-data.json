{"componentChunkName":"component---src-templates-post-tsx","path":"/Kotlin JPA Entity 모델링하기/","webpackCompilationHash":"2d74408910b4a1fbc21a","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA2ElEQVQY02NgAIJIsyLfYJOSTCCTEcT//eu3IAMe8P//f+F///7B2Jhq480LdwVaJbzYsWW/NVBB1t8/fwuAtBcQ6wKxJRBbAbEFEJsCsS8QxwKxAxDbA3EtVN4TiNnABsZ5p+7yMU26v3LtLgOgYPGfP3+TgXQ20BX9QLoOiGcC2dOBdBsQTwHiXJBBQDFnIF0KUgvEnUCsAzYw0KRgVa5F4Z3GnAJhkE1AL2sDaT0gtgNiI6jr7KAudgdiLagYyIU6QKwCNBzkIxWwgWIKFoJ6xibSDFQAAMSLvx5xS4Y5AAAAAElFTkSuQmCC","width":400,"height":90,"src":"/static/8637e594ca86d58e20988ba8c4cfc1e7/647de/thxwelchs-logo-v2.png","srcSet":"/static/8637e594ca86d58e20988ba8c4cfc1e7/647de/thxwelchs-logo-v2.png 1x"}}},"markdownRemark":{"html":"<p>최근 스프링부트를 개발 할 때 Kotlin으로 많이 개발하고 있는데요,</p>\n<p>특히나 이 포스팅에서는, JPA Entity 모델링 을 할 때 주의해야 할 점들을 살펴보겠습니다.</p>\n<h1>Entity 모델링</h1>\n<p>먼저 코틀린에서 Entity 클래스를 작성할 때는 <code class=\"language-text\">data class</code> 로 선언 하는 것보다는 일반 클래스로 선언하는 것이 좋습니다. 그 이유는, <code class=\"language-text\">data class</code> 는 <code class=\"language-text\">open</code> 혹은 <code class=\"language-text\">abstract</code>와 같은 키워드를 허용할 수 없으므로 다른 클래스의 부모클래스가 될 수 없기 때문입니다.  그래서 자바에서는 클래스 구분이 없어 신경쓰지 않았던 상속성을 가져가기 위함과, 연관되어있는 다른 Entity가 있다면 지연로딩을 위해서라도 일반 <code class=\"language-text\">class</code>로 선언 후 <code class=\"language-text\">open</code> 키워드를 붙여주어야 합니다.</p>\n<ol>\n<li>JPA에서 지향하는 Entity 객체는 Entity끼리도 상속성을 이룰 수 있어야 합니다.</li>\n<li>지연로딩 시 데이터 클래스에서 작동하지 않는 문제</li>\n</ol>\n<p><br/><br/></p>\n<h2>Entity가 되기 위한 클래스 표준 (Entity POJO Model)</h2>\n<h3>JPA에서 말하는 Entity POJO Model이란? (JPA는 그저 java에서 정의한 ORM 표준)</h3>\n<ol>\n<li>Entity는 final 클래스이면 안된다. ( 메소드나, 인스턴스 변수 또한 마찬가지 )</li>\n<li>Entity는 최상위 클래스여야 한다.</li>\n<li>Entity는 추상클래스, 구체클래스 모두 될 수 있다. (Entity는 Entity class뿐만 아니라 Entity가 아닌 class도 확장 할 수 있으며 Entity가 아닌 class는 Entity class를 확장 할 수 있습니다.)</li>\n<li>Entity는 public 또는 protected 접근제한자를 가진 인수없는 생성자(no-arg) 가 있어야 한다. (추가적으로 생성자를 정의 할 수도 있음)</li>\n<li>Enum 또는 interface는 Entity가 될 수 없다.</li>\n</ol>\n<h3>Hibernate에서 말하는 Entity Model이란? (Hibernate는 JPA의 실질적인 구현체)</h3>\n<ol>\n<li>Entity는 public 또는 protected 접근제한자를 가진 인수없는 생성자(no-arg) 가 있어야 한다. (추가적으로 생성자를 정의 할 수도 있음)</li>\n<li>Entity는 최상위 클래스 일 필요는 없다.</li>\n<li>기술적으로 hibernate는  영속 클래스 혹은 비영속 클래스 상태의 접근 방법(getter, setter 메소드)을 사용하여 최종 영속상태에 접근할 수 있다.\n그러나 이것은 Hibernate가 Entity의 lazy loading을 위한 프록시를 생성할 수 없게 하므로 일반적으로는 좋지 않다. <strong>즉 하이버네이트에서는 final 클래스가 아닌 클래스를 선호한다! 왜? 영속 상태를 관리하기 위해 proxy를 사용하고, lazy loading을 proxy 객체로 처리해야 하기 때문에</strong></li>\n</ol>\n<p>위와 같이 Entity 클래스가 되기 위해 권장되는 규칙이 꽤나 있는데, 저런 규칙을 지키지 않으면 어떤 문제를 일으키는지 코드로 살펴보겠습니다.</p>\n<p>다음과 같은 양방향성을 가진 두 엔티티가 있습니다. ( 최근 연습중인 도메인 모델이 식당입니다. ㅋㅋ)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 280px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.92857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACLUlEQVQoz32Ta4+aUBCG/f8/pUm/NG3TS/rFdNN23dVFQEEEDnKXi9wEEeHtgNt1Nc2e5GQ4yeGZd96ZM1J2KfggwSLKYBR76FkBNUmh7HK0XYd+dRTPn+fzW2uETsF7XceHxROE+WfM5THKWoYYGSibC7CH9UGOU3w3fDw6LgTXhOA5ED0LEzpn9QkjPQmg+BZsin7qw018ZIcd5kGM6gZ4bIFF6OKdquJen4HjPmIy+wJB+IpHNkV0aDASTRsPszmq/jat9lm6HNcoj6crYG/BHy/HcruFzNaIyhLZ8YCqrSHFOYLyiBHnpdC8CIrpQXdJrb2FYXuYesUz/OJbD34Ka6xMC0t5hZLyHehSc+rI95qApPB+7WK1UiAvJRi6Bk3VEVgm7jQfshMOoKpp0bTd8MMnLcUvh5pn++CkNZykQE05pbg6A+/cPWzLgUrQJC9e1PB+Bos63+urTy351w3gsZVj6u8RuC42jCGOIuB0hJlUiCpqipoeoGkGmM5IevsC1NIazX+m5Kdd0M5h2zZVJg2lWwaDGuaIqf7RhLIxtiGohh3NX5blZNYJ6+Rw1ZR/+8cmwzeWDgI4XsCc58FUBVPmU5c7KtkpYHs+RFGEJMuQZYUqOA4m9yW+BvaL25bkYYHpJsSDscXUDDEzA/y2UqQ1KRyTfF1jWIoCBI6DQfLTKKAX02B/NTaX+OZLuSNPeDfB3NkNcUYZpXAPPqyGzt4q7GexfWXB7f4LbQeL2Yk05hsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntity모델링하기/Untitled.png\"\n        title=\"img/KotlinJPAEntity모델링하기/Untitled.png\"\n        src=\"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled.png\"\n        srcset=\"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled.png 280w\"\n        sizes=\"(max-width: 280px) 100vw, 280px\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 309px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/33bdc4b207ba3415ae591fd36af777cc/fee6b/Untitled1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 178.31715210355986%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAACXBIWXMAAAsSAAALEgHS3X78AAAEfklEQVRIx5VWaXPiRhD1P0liY27MjRC6BToRiPtYzHrXdnartipfkv9fL90jcDCLWOdDVw/S8NTT/fr13OSLHVyyXKGNtHfX9t9ce8k+k23gPtckawnL0DqTTX6zz+Zp78n+m2tfLFW6sAchdGMATbOg6X2xNkyHfB+m5aArG7+OkC2bb6FcVfD5cYXlLMJms8Z6tcBqtcT20wbz6QTr9RKBH7xLz9UIixUZ69jEfD6GYQ+gaDoU3YCqm7D6A2G62f9YhLyhUO5iv3Cxf/pMR/cJkI5t2NAIZOCF8IIIKqXgw4DsM3kpKQRZV7Lxz7e/RDrS/nPza8pQpJxTelYpSZAbqlgf953axQiPLzgKpgbTQqzJCmSlfFOsRUroA0e7GiHzS9UdRKMxXNdHEEbw/RBBMERI5tHadT30FA29ngZVM1Ct98THUwGtfoDdOsJ4PMJiOcckHmM2m1LFZxjHMabTMXRNg6IoMAwD9YYiTnIR8C7bhqGpeF2bGE1mmC1X2O52mC0WkFVd0MV2XDieT9X2ha9dA8zk2pBlFcuRjWA4xXS+ERbHcwReRNxzYdoeDMslGlHXUOc81FKOnBSFClHo4Dab9PLdfQO/3T6g2dDw98sPOkHjrViJT6ly7owODPz2jqxEVim0BW1yF+wqbQqlzoESyZqflcsSamQFssqDjPLBKtUeivQslTbMPz8YYTmPqaITzGdUGLLJZIoZiUIYhlBVVZiiqKREGpotRUR+GZBy4nkBFrEDlyoYRRGGQ+pdXo8i4iUBEoim68Lr5FttNY2HbQKUMHRUfNs52Oy/CHF4ennF88tXqqiNvuPBJYLb5L2QiB6EaEl6OiBXuCupsE2Tjj7B6/4ZuuXDsgNIsklmUWQDbIlKbclAt2eJTvkph0m1DqD0td8zDdQp4d+3z/jjtioUh5/fUSc9kFb+eHwV4yF76O13Vb44lLjC5Gu5BooHATg9SZGEIncuX6ccSgZR8z+yktWLCej9GYF53273imbbFOufRgCH3e3ZpDJ9SF0N7Y6KnqRRLpN1R3iN+NZNQMlalA7m6sWZwi0WjOeIF2tsNyvEpDKqqhDHiGeCc4rgGxOZI+Woq8X2O7F9D0iC4A1MzEgQvDDhmmZYwky7D1sMJDsBLCSAtbPo3gGyZMWBgeetK7i32+9pwpnokXgafYckKiDZcsSsPoLUDkW7eOS7bAeT0MD3vY9PX14QU4vZjgOfImW9c2j+2gNXRCgKeQAspgFyXnqkgZ7D4jkStwTZoDHpLESxZCJvp2sKEeAjM1C9fOHIp2S+F6Rtvd1nsgX6c4k6oKQgV9HEPgZjGWux6pxQ7qwoR9AzO2pioYmKFJFscXu18EDFqHD+iEL5tCNf6hROQ6UqY8jSH45oYI1JuogBJAajEaVFM9MBL1+Y2jQrZISTpZAxljAGZTCehrphCvH9H4B8A+vhz7VGN68Yj0/PiBjIskXlTdtJ75T0O6IMf2DAcQP4NAF50rFc8bRj/+Ejn1bvTky/Jk2/+tv15OiPxTzu/xevHo/8JGyAfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntity모델링하기/Untitled%201.png\"\n        title=\"img/KotlinJPAEntity모델링하기/Untitled%201.png\"\n        src=\"/static/33bdc4b207ba3415ae591fd36af777cc/fee6b/Untitled1.png\"\n        srcset=\"/static/33bdc4b207ba3415ae591fd36af777cc/bc34b/Untitled1.png 293w,\n/static/33bdc4b207ba3415ae591fd36af777cc/fee6b/Untitled1.png 309w\"\n        sizes=\"(max-width: 309px) 100vw, 309px\"\n      />\n  </a>\n    </span></p>\n<p><br/><br/></p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Entity\ndata class Restaurant(\n        var name: String = &quot;&quot;,\n        @OneToMany(mappedBy = &quot;restaurant&quot;)\n        @OrderBy(&quot;name asc&quot;)\n        var menus: MutableSet&lt;Menu&gt; = TreeSet()\n): MutableEntity() {\n\n        fun addMenu(menu: Menu) {\n                menus.add(menu)\n                menu.restaurant = this\n        }\n}\n\n@Entity\ndata class Menu(\n        var name: String = &quot;&quot;,\n        var price: BigDecimal = BigDecimal.ZERO,\n        @ManyToOne(fetch = FetchType.LAZY)\n        @JoinColumn(name = &quot;restaurant_id&quot;)\n        var restaurant: Restaurant\n): MutableEntity()</code>\n        </deckgo-highlight-code>\n      \n<p>보시는 것과 같이 두 엔티티는 <code class=\"language-text\">@OneToMany</code>, <code class=\"language-text\">@ManyToOne</code> 으로 양방향을 가지고 있고, <code class=\"language-text\">LAZY fetch</code> 되게 되어있습니다. (<code class=\"language-text\">@OneToMany</code>에서 fetch 는 default가 LAZY 방식이므로 생략 하였습니다.)</p>\n<p>앞서 말씀드렸다시피 data class는 <code class=\"language-text\">open</code>이나 <code class=\"language-text\">abstract</code>가 될 수 없고 기본적으로 <code class=\"language-text\">final</code>로 선언되어집니다. 위 두 클래스를 자바 코드로 변형해보면 다음과 같습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 427px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8fd149d918a4c43790e050369251249f/f6b9c/Untitled2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.08665105386417%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACAElEQVQ4y42T63KbMBCFeZbW5i6Ji8TdwmBwIG0cp3YyvST91fd/hdMF0nTaTsf+8c1KDDpztHtkJNkOlitheymRwPZTWFQtl9aOmqvpLnvHoX8m3HReO96/GIfhBafuBUPzGcfuGbfdFzxMdXjG7vQDQ/8V5/47Dvtv0A9n1E9PqM+P0KcnNHdHbHf32Gw/Qb9iJHKPZOhRPo4oDjcIZQ3OKjBRwQs0uNggIAThhxX8qFrqTAmf/4kh0w6pbLBNeui0B8taBPoDylJjX1XzVdd2DNOWsP7CfMVyfmNwTi5ajezYIxlbeFFJvcjgsgwe4Ux9da/H4GENGWq06R5adYh3B6j2HqH+CJW3aPIcWUJOnWVIFwXDoIGrC7Chgd/WEA31anLGcjj+5DCH5xckqBbRS4Ii2sI2QzCqUXlLYiSa9Yg2I6LtHZJkRCbHuZfWNQ5FUIPFlLGQ8scoj8GUNYm1GS9YC78OXBI1hKjhUJ9430J0OxoQ9TQrIAL6FuYQBKe1fbXD6cqrAIzXCNMRrp1BZRUqrVFsiGqDSBZvYhcdBiENI0/hFeRC0QFPYrWK8H5iHePdWs6sLAXzClHqIQ1D1/SMRujhBpyCzSjoXDVg9BqSOKPg5wQlgaZ/0eGUQ2HTAVdDeTQgRS8l7+dJi5iurHJs0hIVtYGL/M3l//gJvojAAycVkaIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntity모델링하기/Untitled%202.png\"\n        title=\"img/KotlinJPAEntity모델링하기/Untitled%202.png\"\n        src=\"/static/8fd149d918a4c43790e050369251249f/f6b9c/Untitled2.png\"\n        srcset=\"/static/8fd149d918a4c43790e050369251249f/bc34b/Untitled2.png 293w,\n/static/8fd149d918a4c43790e050369251249f/f6b9c/Untitled2.png 427w\"\n        sizes=\"(max-width: 427px) 100vw, 427px\"\n      />\n  </a>\n    </span>\n<br/><br/>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 517px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/51269c629f86405c63734256224f326a/81e22/Untitled3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.315280464216634%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB4klEQVQoz3VT2ZKjMBDLx2y4bMxljM0RJiEhZHa2av//Z7QyIZukauZBtKtwC0nd7Fx+hNEf0OUIow5oiFRPyNwMZc/Q+Yg+O0HVPZKxh+hZuw5SGURxjTBhTWrCrNhJ5dAvM4b5glyPUCSodQ9V9IhTByEsUuEQywaRItINyQ+EcWrR9CeY9oh8oBJzRGtapGzahxohmwLf6BFt9YGNxJ+fhNIgaXsUyxfK6QYpLQoS1raDcVQp3hte8SB+Jd3FlCupJkk7pHlHa7RIayq3SGSzXf6eLPpWYe6Q/j1CLAOKhsrMhFIwfCoPflD2IBHMWKoWQfRCmDDDw3HGx+nKyU6wtNvUvBRvoa/Z8RyZ9/zePva0vfOHPGmhIouSky2pOPPTZHaRqNfLYaoRECFVx5IT5+R9n3cQhPWq8H+GCV+64gStzzDVBVU2oSsWGDPD2htcc4W73KDPV1TjGVV75bDOaCz3lTlnBQUUlh9p7gqDWEMwh+Hwm9Yv6NjUnb4wuD+0v6DIJ5hyQV3MKEuS8K7KuAlVhyxvUdV3CLkR+keadTi2C4bLCPc5IrseoEfWiovNjGP+FTrjavEnWG1GHnqt+/COp2WuScRs/JL+IvbJ/RyuQTerFQ8fjZD2x6k/hvIP0OV7H1+QZZwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%203.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%203.png\"\n        src=\"/static/51269c629f86405c63734256224f326a/81e22/Untitled3.png\"\n        srcset=\"/static/51269c629f86405c63734256224f326a/bc34b/Untitled3.png 293w,\n/static/51269c629f86405c63734256224f326a/81e22/Untitled3.png 517w\"\n        sizes=\"(max-width: 517px) 100vw, 517px\"\n      />\n  </a>\n    </span></p>\n<p>위 코드는 IntelliJ에서 kotlin → kotlin bytecode → decompile java code 한 결과라서 가독성은 떨어집니다.</p>\n<p>이제 간단한 repository test를 통해 Menu Entity를 조회 하고 Restaurant Entity를 지연로딩 해보겠습니다.</p>\n<p><strong>코드</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 623px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c52bb4a495e7a2eba3686514cc5a7fea/64096/Untitled4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.434991974317814%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABBElEQVQY023P7WqDQBCFYa+mMSZq1HXX9dukbYj1I7aBUOj938bbSVIohf54OLOwDHMcVeyxuqW0HVp3xKpFm45C3oVknYuiI5M/UdKyi5qHXftHeBO1OP1+ZnlbOJ9GvpaR6zzyOQ8sMveXiY/zwHWc6MeBepqxxxmzH8mOw8PrgBH2pcdWPU7slYRhQ7BrMOZAHFdEcoEfWpTOSBJDpizrMCdt3jHt5T4/BYqVnz4EKa6vcD2F40WWjc7ZmoIwFlGBMhWn/sAwPFM3jdQppWZNnHSSFe5aFrha8tfqh+OGhnWS3W0Dgx9YuS4jy0tsWRGnBRs/lwbSRJYFct3qttDT//oG/oWmIOcWiJ0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%204.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%204.png\"\n        src=\"/static/c52bb4a495e7a2eba3686514cc5a7fea/64096/Untitled4.png\"\n        srcset=\"/static/c52bb4a495e7a2eba3686514cc5a7fea/bc34b/Untitled4.png 293w,\n/static/c52bb4a495e7a2eba3686514cc5a7fea/da9f0/Untitled4.png 585w,\n/static/c52bb4a495e7a2eba3686514cc5a7fea/64096/Untitled4.png 623w\"\n        sizes=\"(max-width: 623px) 100vw, 623px\"\n      />\n  </a>\n    </span>\n<br/><br/>\n<strong>결과</strong></p>\n<p>정상적으로 초록막대와 함께 query 로그도 한번만 찍힌 것을 확인했습니다. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4d8d3ec05c6b7a77bbcd0c873245762f/670c0/Untitled5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.038824181919024%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAdUlEQVQI1y2MWxKDIBAEPZIPFFBYJJRRoHL/43TQ5KNrZqt2uovpg6SKcQfWNCSjfGEOFWUPfCiEWJG9sLqT1V9Pmu2N0i/6SRim8NCPQuflwsWMXhNGJ2wbKJ8Zlsg470jIPD9/tiZz/vz1lvetbWJp8qHJv65ORNTYSVPsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%205.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%205.png\"\n        src=\"/static/4d8d3ec05c6b7a77bbcd0c873245762f/913fc/Untitled5.png\"\n        srcset=\"/static/4d8d3ec05c6b7a77bbcd0c873245762f/bc34b/Untitled5.png 293w,\n/static/4d8d3ec05c6b7a77bbcd0c873245762f/da9f0/Untitled5.png 585w,\n/static/4d8d3ec05c6b7a77bbcd0c873245762f/913fc/Untitled5.png 1170w,\n/static/4d8d3ec05c6b7a77bbcd0c873245762f/efb0c/Untitled5.png 1755w,\n/static/4d8d3ec05c6b7a77bbcd0c873245762f/670c0/Untitled5.png 1803w\"\n        sizes=\"(max-width: 1170px) 100vw, 1170px\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1146px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b83ee2aa872e5a085123fb2f2d9838b4/12898/Untitled6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.654450261780106%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA5ElEQVQY0z1QW1LDQAzLdaAPCp1Cm2bfuyTZkLbT4YP7X8RILuRDY9lryV43pf5I/ryJj7OEfNEYy1V8mpeaDV8K5sZPD54u4hA1B8gPH0kaF2ZJBSJfNRJ1+pbS3zDoKsN4Fx8omCRjkLGDcr77CEM3igVCnOTp+V0aA6OYZ+nQGLAVeQ+TBHHEdhQ69NAkIe9MD17VnLXOjmrKoav1URquW/hlFGjGqTwBefoz5Pb6A54EfQE95A/DQbdmbfPSStO5qhOObcYNouwPXrHdnWW1Ocl62y6g4B98370Zrb/u7aL5BZgmsEmuc5n1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%206.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%206.png\"\n        src=\"/static/b83ee2aa872e5a085123fb2f2d9838b4/12898/Untitled6.png\"\n        srcset=\"/static/b83ee2aa872e5a085123fb2f2d9838b4/bc34b/Untitled6.png 293w,\n/static/b83ee2aa872e5a085123fb2f2d9838b4/da9f0/Untitled6.png 585w,\n/static/b83ee2aa872e5a085123fb2f2d9838b4/12898/Untitled6.png 1146w\"\n        sizes=\"(max-width: 1146px) 100vw, 1146px\"\n      />\n  </a>\n    </span></p>\n<p>그럼 정말로 문제 없는걸까요? 더 확실히 테스트해보기 위해 직렬화가 필요한 controller 테스트를 해보았습니다. ( 이 테스트는 service를 mocking하는 단위테스트로 작성하지 않고, 실질적인 테스트가 필요하여, 통합테스트로 진행했습니다. )</p>\n<p><strong>코드</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 786px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1a3bfb85dd69a1e72e47a3eeaf800704/9aac8/Untitled7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.099236641221374%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA90lEQVQY01WQWW7DMAxEfZjCjhVv8SLKWijFTpEC/Up7/7NMacct0o+BSAnzOFSWli9UF4dqnKHOGl1DmPoZ46G+M9Bybned1IWacFL60ISi1C+9Rrbev1HVTswWJFDSFn52WKwHGwcvWkNAkp6GJ7Aon/qFvNYZpwfKyqCpCYOkUClARY/KOvS0YBgZrYBUS8gFphTJJrSb3/IR+Wn6nzBeH1D1LA3t8etbRHtjNHfGJTCcvWJ2ATYyzuwxcYQJVxgX8fG5YCT3B96SZnwAS5layh9WMaAWY508GlmdiKGNh5O1Jx8wyPsG7k0AxwTLG3jF8p52/w+YBaHYpeeuxgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%207.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%207.png\"\n        src=\"/static/1a3bfb85dd69a1e72e47a3eeaf800704/9aac8/Untitled7.png\"\n        srcset=\"/static/1a3bfb85dd69a1e72e47a3eeaf800704/bc34b/Untitled7.png 293w,\n/static/1a3bfb85dd69a1e72e47a3eeaf800704/da9f0/Untitled7.png 585w,\n/static/1a3bfb85dd69a1e72e47a3eeaf800704/9aac8/Untitled7.png 786w\"\n        sizes=\"(max-width: 786px) 100vw, 786px\"\n      />\n  </a>\n    </span>\n<br/><br/>\n<strong>결과</strong></p>\n<p>테스트의 결과는 초록막대인데.. 찍힌 로그가 뭔가 이상합니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 934px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/439971cdb4b4dfdb354a47926869f71c/4ccff/Untitled8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.58244111349036%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABN0lEQVQoz1VRW3KDMBDjRm2IwRg/sR0CJJCZfvT+N1Flt02bD8aaXa1WWpq0fmJePxDzA1M6EPKOEHdYf4MNt4rddOfHWrjXmvEbjNsqdqx59jw5ntxGs+EDCfYKR2IXEpxe0IkAqVLtDeaKnjxhFrTC49Q6vJ8Mzl2A5pz1K+cXhGlDY9yKfHlww4aJG4Y0I9LdIBOUmZHygZFOFF1Ivp2MVagI90Pk3A0x7fVNlwON4nbjFih9gSYWNkKrGYIOy3DpST2j0+yNM9qODs902NoqXOfociSncJuRMYrlkW6KbeEo8k/QktSTXOIKihZnReztREHiIvQraD0Fy4Hz/PixfkDlv8hjjby/RBb99IxcFjre+CVycViKJa7lPaXPsMSSZKly/SmKzqVd0ZP7ckPi509x3zpfWsLzZYVya4oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%208.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%208.png\"\n        src=\"/static/439971cdb4b4dfdb354a47926869f71c/4ccff/Untitled8.png\"\n        srcset=\"/static/439971cdb4b4dfdb354a47926869f71c/bc34b/Untitled8.png 293w,\n/static/439971cdb4b4dfdb354a47926869f71c/da9f0/Untitled8.png 585w,\n/static/439971cdb4b4dfdb354a47926869f71c/4ccff/Untitled8.png 934w\"\n        sizes=\"(max-width: 934px) 100vw, 934px\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ac5077b77b8167a014b9f2cbf86f34b9/ffaf0/Untitled9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.608040201005025%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAtElEQVQY01WQaw6CMBCEuY9GQQtS6JtXEYzx/ocZdwvE+GMy2+zut5NmhV1xkSOUifBhhXFPGDtDNgNkO0CUblPlUdVdctZDdijJb8LivvfzQiO7thEn4aAJyDClI2lCS+IDzi+wJEf1FD/w3Up6YaQ6kPNx7vNsVQdkuZpxLn1KaBlIznAG8uCRmOt+eKf3UfMxDqDNnHY55QYUPqUyO5BhjfoBtd0W/oAjAcOS5o/vqpseX4Ani95JNFyfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%209.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%209.png\"\n        src=\"/static/ac5077b77b8167a014b9f2cbf86f34b9/913fc/Untitled9.png\"\n        srcset=\"/static/ac5077b77b8167a014b9f2cbf86f34b9/bc34b/Untitled9.png 293w,\n/static/ac5077b77b8167a014b9f2cbf86f34b9/da9f0/Untitled9.png 585w,\n/static/ac5077b77b8167a014b9f2cbf86f34b9/913fc/Untitled9.png 1170w,\n/static/ac5077b77b8167a014b9f2cbf86f34b9/ffaf0/Untitled9.png 1592w\"\n        sizes=\"(max-width: 1170px) 100vw, 1170px\"\n      />\n  </a>\n    </span></p>\n<p>객체를 직렬화 하기전까지는 서로 참조하는 값을 계속해서 참조 할 일이 없지만, 직렬화를 하기 위해 참조하는 과정에서 뭔가 하이버네이트 엔진이 HIkariProxyResultSet으로 부터 결과 값을 가져오는데 무한적으로 재귀호출을 하는 것 같습니다. ( 개발환경에서 허용된 메모리만큼 재귀호출이 되다가 결국엔 StackOverFlow가 발생합니다. 내부적으로 예외처리가 되있어 직접적으로 에러로 표시되진 않는 것 같습니다. )</p>\n<p>로그를 자세히 보시면 HikariProxyResultSet의 HashCode가 계속해서 바뀌고, 계속해서 새로운 객체를 참조하여 DB 데이터의 결과값을 가져오려고 시도합니다.</p>\n<p>이 문제를 해결하기 위해 제가 시도한 방법은 다음과 같습니다.</p>\n<ul>\n<li><code class=\"language-text\">data class</code> 를 <code class=\"language-text\">일반 class</code> 로 변경 후 <code class=\"language-text\">Hibernate</code>가 <code class=\"language-text\">Lazy load 객체</code>를 가져올 때 정상적으로 작동 할 수 있게 open 키워드 달아주어 상속 가능하게 만들기</li>\n<li>직렬화 시 무한 재귀에 빠지지 않게 하기 위해 <code class=\"language-text\">HibernateModule</code>을 빈으로 등록하여 jackson에configuration 하기</li>\n</ul>\n<h3>Data class → class 로 변경 후 open 키워드 달기</h3>\n<p>먼저 data class를 일반 class로 바꾸기</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Entity\nclass Menu(\n        var name: String = &quot;&quot;,\n        var price: BigDecimal = BigDecimal.ZERO,\n        @ManyToOne(fetch = FetchType.LAZY)\n        @JoinColumn(name = &quot;restaurant_id&quot;)\n        var restaurant: Restaurant\n): MutableEntity()\n\n@Entity\nclass Restaurant(\n        var name: String = &quot;&quot;,\n        @OneToMany(mappedBy = &quot;restaurant&quot;)\n        @OrderBy(&quot;name asc&quot;)\n        var menus: MutableSet&lt;Menu&gt; = TreeSet()\n): MutableEntity() {\n\n        internal fun addMenu(menu: Menu) {\n                menus.add(menu)\n                menu.restaurant = this\n        }\n}</code>\n        </deckgo-highlight-code>\n      \n<p>아까 위에서 소개해드렸던 JPA 표준 POJO Model 객체가 되기 위해 </p>\n<p>일일이 entity 마다 open 키워드와 빈 생성자를 작성하긴 귀찮으니,  kotlin jpa plugin 을 사용하여 자동적으로 모든 entity에 적용 시켜주겠습니다.</p>\n<p>적용하는 방법은 <code class=\"language-text\">build.gradle</code>(groovy dsl) 혹은 <code class=\"language-text\">build.gradle.kts</code> (kotlin dsl) 에서 설정 할 수 있습니다. </p>\n<p>저는 kotlin dsl을 사용하고 있으므로 다음과 같이 작성했습니다.</p>\n<p><em>build.grade.kts</em></p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">plugins {\n        ...\n    kotlin(&quot;plugin.jpa&quot;) version &quot;1.3.61&quot;\n}\n\nnoArg {\n    annotation(&quot;javax.persistence.Entity&quot;)\n    annotation(&quot;javax.persistence.MappedSuperclass&quot;)\n    annotation(&quot;javax.persistence.Embeddable&quot;)\n}\nallOpen {\n    annotation(&quot;javax.persistence.Entity&quot;)\n    annotation(&quot;javax.persistence.MappedSuperclass&quot;)\n    annotation(&quot;javax.persistence.Embeddable&quot;)\n}</code>\n        </deckgo-highlight-code>\n      \n<p>위와 같이 작성하고 나면 <code class=\"language-text\">Entity</code>, <code class=\"language-text\">MappedSuperclass</code>, <code class=\"language-text\">Embeddable</code> 의 어노테이션이 붙은 클래스에 빈 생성자와 open 키워드가 자동으로 정의됩니다.</p>\n<p><code class=\"language-text\">open</code> 키워드를 코드에서 정의하지 않았는데도, 자바로 변환한 코드에서는 원래의 <code class=\"language-text\">final class</code> 에서 <code class=\"language-text\">일반 class</code> 로 변경되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 841px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/49db6c6a6dd1eca5723f0a9bfcba3127/9131b/Untitled10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.74554102259215%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB6klEQVQoz51S2Y7bMAz0zyTxER+Sbcmy5UOynatJge5mtw3Qh/7/T0wpO7tAXwq0DwQFkZoZcuQ14wOqPqEzD4yXnxiP77DnXzDHB7R5Qd3eUOsrBeX2CmNusNMb+vGGbrhCqgNU86xTeGamYv8NLFCI0xppppEyjSiusPUL7ILyMza7HDxvYcY3pLNFpGqEoYQfis8ez0zfUZuvCLMKG7pYQPw1u0b/2ejO7i7jHQb7ijjvkbrIBvgRvd0RIb3zvlze0egjFTsUrEWSNohYh3BfYecAI4ngqcIBpqxfAfmAhGtUhYTIBUouUeUS3uX8irI0S3OhibE2yOozmJqQt2dwMWEfN6SyWEZm3I18ByfAOKlRSg0pWohKo2gaeAcyQcgZIaPiYURlB+RihBzOUP0BvGgRxop2WiOg0VhhMJg7vTFQnV2U8qQlUoUtrwjw9AO6u5GaGdVwRNONxHZAoU4EPIOX05LXMxGR+n54QSZ6NHZEKkci1UgSsezeGyzJLyw2W74sf+t/GPOnwx8uJ8yZckdKynNSmNUT4tKiIA8C2vcCmBPz1s9XV/8SqykdDL2JGZlH+9tzyvTV9jS26/GcY/8DGGUKgdD0fRQZJUi5XP+hA+T/COhMKZsRzUx7FZaMGsCIIE0r/Ab2aWea5588AQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%2010.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%2010.png\"\n        src=\"/static/49db6c6a6dd1eca5723f0a9bfcba3127/9131b/Untitled10.png\"\n        srcset=\"/static/49db6c6a6dd1eca5723f0a9bfcba3127/bc34b/Untitled10.png 293w,\n/static/49db6c6a6dd1eca5723f0a9bfcba3127/da9f0/Untitled10.png 585w,\n/static/49db6c6a6dd1eca5723f0a9bfcba3127/9131b/Untitled10.png 841w\"\n        sizes=\"(max-width: 841px) 100vw, 841px\"\n      />\n  </a>\n    </span></p>\n<h3>Jackson configuration</h3>\n<p>아직 lazy 로드 되기 전의 proxy 객체 또한 직렬화 하려고 하면 에러가 나기 때문에 다음과 같은 솔루션으로 직렬화 시 문제를 해결합니다. ( lazy 로드 되기 전의 proxy 객체는 null 처리 해줌 )</p>\n<p>저는 hibernate5 버전을 사용하고 있으므로 다음과 같이 작성 했습니다.</p>\n<p><em>build.gradle.kts</em></p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">dependencies {\n    ...\n    // Hibernate5Module이 지연로딩 되는 객체의 프로퍼티 직렬화를 가능하게 해준다. (jackson ObjectMapper support)\n    implementation(&quot;com.fasterxml.jackson.datatype:jackson-datatype-hibernate5:2.9.8&quot;)\n}</code>\n        </deckgo-highlight-code>\n      \n<p><em>JacksonConfig.kt</em></p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Configuration\nclass JacksonConfig {\n\n    @Bean\n    fun hibernate5Module(): Hibernate5Module {\n        // Hibernate5Module이 지연로딩 되는 객체의 프로퍼티 값이 비어있더라도 직렬화를 가능하게 해준다.\n        // 이 모듈을 bean으로 등록 안하면 hibernateLazyInitializer 라는 하이버네이트 프록시 객체의 프로퍼티를 직렬화 하려다가 에러남\n        return Hibernate5Module()\n    }\n}</code>\n        </deckgo-highlight-code>\n      \n<p>위 처럼 변경해준 뒤 다시 테스트를 돌려보면</p>\n<p>정상적으로 테스트 통과 후 한번만 쿼리하는 것을 볼 수 있습니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/db10cb8de14458109af3d0b7d44c30ad/02cf6/Untitled11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.59465478841871%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0klEQVQY0z2PWW7DMAxEfZ8mVSXL2pfIlrcESIDc/y5TSin6MRiQot6QQ1hOOLMhpBM236HKE2Z9Q+UH8u2BZX1hbqovbMeb/AltV0g1Q8hbFx8zfkQC4xGDDAWTyFB2gfQbmN/B3I4LPTq/IlJQiDtiPingDh92Cj+QqE5Up97bCJrwdTUYdKpQskC7iomA3B8Q4QSj5Pa5QwhoCW5sJd9owwpBAP4nqQpGmXFlHoNpwLH0IRUIRkBOJzEabJC2Tff42axBJz3/S+l2+gd2+Xb4BcVDiHlDCwhlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%2011.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%2011.png\"\n        src=\"/static/db10cb8de14458109af3d0b7d44c30ad/913fc/Untitled11.png\"\n        srcset=\"/static/db10cb8de14458109af3d0b7d44c30ad/bc34b/Untitled11.png 293w,\n/static/db10cb8de14458109af3d0b7d44c30ad/da9f0/Untitled11.png 585w,\n/static/db10cb8de14458109af3d0b7d44c30ad/913fc/Untitled11.png 1170w,\n/static/db10cb8de14458109af3d0b7d44c30ad/efb0c/Untitled11.png 1755w,\n/static/db10cb8de14458109af3d0b7d44c30ad/02cf6/Untitled11.png 1796w\"\n        sizes=\"(max-width: 1170px) 100vw, 1170px\"\n      />\n  </a>\n    </span>\n<br/><br/>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 300px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/32366886ed6e3611e910d59884b9e7ce/c3605/Untitled12.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACYklEQVQ4y41T2XKbQBDkMyxxLexyHwKEkFFhSbas+KhU7OT//6XTi6QYV5zYD10ztTC9M9O9hlIKwnXhOvYIzxNwhQfbFSMcISAIz/O+BEMIF54MEZXNCOH5SHwPqzhAl4SMCoqXWLYF27Y/heE6DlSUovv2ivbwhDBJsSgSPB967PoGt8MK9aKEw//GST6B4boOwqxCPRyw6LfI2w2q6zWGxz3KrsZq6JBkKeYmOySpxn8J9c2eCpA2ayw2d6h2T6j3j4iLGss8RR4qJMo/xUAi8LlXjqbrPoJxYbbmM6g0R3t8RdFtoAKFdR7hblng2FUYyhSbRYYmi8fl22fSv3dIMq2ibZkIixbd0y9Um/24yypSuKkySCkxM02YlkVxpkTOn/xdhxfCIK9QbR9IFiGjMHq/ukiLoX92HefDrqZnb4S0RZCWyNdb1Df3WB2e0eyPUGGIkp3etyV6jt3zojZPxs43JfM0wjXPKjbhnFQ+7dDmOAHVXh1/kuw74wuWtFEQ0YtZhC3352nPniHpTV9oXM7Em8pxHHOs005knMMPI8gooeHlOHZAo2tzf8nYetQkL1H1O3i+DyUdKn4Fk6pb7HpG/13NzTGalj36UYujofM549RG7NBmNylKKps1HZbDDuX1lq8nRsjO1npnaYiazzCjlVrapuKzLIkV84bfpkobmn0k7G/R3v3A8v4F3cNPxFlBM0s80INLki2igIQSBWOpcxpdExdxeBb1TCi4I+HLkTBfDVT5BlnbQ/L1FCyqWWRNRp2fMR15ah1DcW8WPWjOrt7BuhSz6F/PbIoL6W/2Psof4/qo3AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img/KotlinJPAEntityModeling/Untitled%2012.png\"\n        title=\"img/KotlinJPAEntityModeling/Untitled%2012.png\"\n        src=\"/static/32366886ed6e3611e910d59884b9e7ce/c3605/Untitled12.png\"\n        srcset=\"/static/32366886ed6e3611e910d59884b9e7ce/bc34b/Untitled12.png 293w,\n/static/32366886ed6e3611e910d59884b9e7ce/c3605/Untitled12.png 300w\"\n        sizes=\"(max-width: 300px) 100vw, 300px\"\n      />\n  </a>\n    </span></p>\n<p>실제로 데이터가 조회되었고, lazy fetch 모드로 설정되있고, 아직 꺼내지 않은 객체 restaurant.menus에 대해서는 null 처리가 되어있습니다. </p>\n<p>하지만 여기서 끝이 아닙니다. 현재까지는양방향관계에서  <code class=\"language-text\">@ManyToOne</code> 를 가진 쪽의 엔티티 조회에서 문제를 해결했는데요, </p>\n<p>아직 <code class=\"language-text\">@OneToMany</code>의 관계를 가진 엔티티를 lazy load 조회 할 때 문제가 있습니다.\n<br/>\n이 부분까지 해결하기 위해서는 여러가지의 솔루션이 있는데 그 중 하나를 다음 포스팅에서 소개하겠습니다.\n<a href=\"https://thxwelchs.github.io/JPA%20%EC%96%91%EB%B0%A9%ED%96%A5%20Entity%20%EB%AC%B4%ED%95%9C%20%EC%9E%AC%EA%B7%80%20%EB%AC%B8%EC%A0%9C%20%ED%95%B4%EA%B2%B0/\">JPA 양방향 관계 무한재귀 해결 포스팅 보러가기</a></p>\n<p>감사합니다.</p>\n<h1>참고</h1>\n<blockquote>\n<p>하이버네이트 공식 엔티티 모델링 가이드 <a href=\"https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#entity\">https://docs.jboss.org/hibernate/orm/5.4/userguide/html<em>single/Hibernate</em>User_Guide.html#entity</a>\nkotlin compiler-plugins(no-arg, all-open) <a href=\"https://kotlinlang.org/docs/reference/compiler-plugins.html\">https://kotlinlang.org/docs/reference/compiler-plugins.html</a>\n코틀린 JPA <a href=\"https://github.com/spring-guides/tut-spring-boot-kotlin#persistence-with-jpa\">https://github.com/spring-guides/tut-spring-boot-kotlin#persistence-with-jpa</a>\n객체지향적 상속성 활용한 엔티티 설계하기 <a href=\"https://victorydntmd.tistory.com/209\">https://victorydntmd.tistory.com/209</a></p>\n</blockquote>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"최근 스프링부트를 개발 할 때 Kotlin으로 많이 개발하고 있는데요,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"특히나 이 포스팅에서는, JPA Entity 모델링 을 할 때 주의해야 할 점들을 살펴보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Entity 모델링"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 코틀린에서 Entity 클래스를 작성할 때는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"data class"}]},{"type":"text","value":" 로 선언 하는 것보다는 일반 클래스로 선언하는 것이 좋습니다. 그 이유는, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"data class"}]},{"type":"text","value":" 는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"open"}]},{"type":"text","value":" 혹은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"abstract"}]},{"type":"text","value":"와 같은 키워드를 허용할 수 없으므로 다른 클래스의 부모클래스가 될 수 없기 때문입니다.  그래서 자바에서는 클래스 구분이 없어 신경쓰지 않았던 상속성을 가져가기 위함과, 연관되어있는 다른 Entity가 있다면 지연로딩을 위해서라도 일반 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"class"}]},{"type":"text","value":"로 선언 후 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"open"}]},{"type":"text","value":" 키워드를 붙여주어야 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"JPA에서 지향하는 Entity 객체는 Entity끼리도 상속성을 이룰 수 있어야 합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"지연로딩 시 데이터 클래스에서 작동하지 않는 문제"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Entity가 되기 위한 클래스 표준 (Entity POJO Model)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"JPA에서 말하는 Entity POJO Model이란? (JPA는 그저 java에서 정의한 ORM 표준)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Entity는 final 클래스이면 안된다. ( 메소드나, 인스턴스 변수 또한 마찬가지 )"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Entity는 최상위 클래스여야 한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Entity는 추상클래스, 구체클래스 모두 될 수 있다. (Entity는 Entity class뿐만 아니라 Entity가 아닌 class도 확장 할 수 있으며 Entity가 아닌 class는 Entity class를 확장 할 수 있습니다.)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Entity는 public 또는 protected 접근제한자를 가진 인수없는 생성자(no-arg) 가 있어야 한다. (추가적으로 생성자를 정의 할 수도 있음)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Enum 또는 interface는 Entity가 될 수 없다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Hibernate에서 말하는 Entity Model이란? (Hibernate는 JPA의 실질적인 구현체)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Entity는 public 또는 protected 접근제한자를 가진 인수없는 생성자(no-arg) 가 있어야 한다. (추가적으로 생성자를 정의 할 수도 있음)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Entity는 최상위 클래스 일 필요는 없다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"기술적으로 hibernate는  영속 클래스 혹은 비영속 클래스 상태의 접근 방법(getter, setter 메소드)을 사용하여 최종 영속상태에 접근할 수 있다.\n그러나 이것은 Hibernate가 Entity의 lazy loading을 위한 프록시를 생성할 수 없게 하므로 일반적으로는 좋지 않다. "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"즉 하이버네이트에서는 final 클래스가 아닌 클래스를 선호한다! 왜? 영속 상태를 관리하기 위해 proxy를 사용하고, lazy loading을 proxy 객체로 처리해야 하기 때문에"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위와 같이 Entity 클래스가 되기 위해 권장되는 규칙이 꽤나 있는데, 저런 규칙을 지키지 않으면 어떤 문제를 일으키는지 코드로 살펴보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"다음과 같은 양방향성을 가진 두 엔티티가 있습니다. ( 최근 연습중인 도메인 모델이 식당입니다. ㅋㅋ)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 280px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 58.92857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACLUlEQVQoz32Ta4+aUBCG/f8/pUm/NG3TS/rFdNN23dVFQEEEDnKXi9wEEeHtgNt1Nc2e5GQ4yeGZd96ZM1J2KfggwSLKYBR76FkBNUmh7HK0XYd+dRTPn+fzW2uETsF7XceHxROE+WfM5THKWoYYGSibC7CH9UGOU3w3fDw6LgTXhOA5ED0LEzpn9QkjPQmg+BZsin7qw018ZIcd5kGM6gZ4bIFF6OKdquJen4HjPmIy+wJB+IpHNkV0aDASTRsPszmq/jat9lm6HNcoj6crYG/BHy/HcruFzNaIyhLZ8YCqrSHFOYLyiBHnpdC8CIrpQXdJrb2FYXuYesUz/OJbD34Ka6xMC0t5hZLyHehSc+rI95qApPB+7WK1UiAvJRi6Bk3VEVgm7jQfshMOoKpp0bTd8MMnLcUvh5pn++CkNZykQE05pbg6A+/cPWzLgUrQJC9e1PB+Bos63+urTy351w3gsZVj6u8RuC42jCGOIuB0hJlUiCpqipoeoGkGmM5IevsC1NIazX+m5Kdd0M5h2zZVJg2lWwaDGuaIqf7RhLIxtiGohh3NX5blZNYJ6+Rw1ZR/+8cmwzeWDgI4XsCc58FUBVPmU5c7KtkpYHs+RFGEJMuQZYUqOA4m9yW+BvaL25bkYYHpJsSDscXUDDEzA/y2UqQ1KRyTfF1jWIoCBI6DQfLTKKAX02B/NTaX+OZLuSNPeDfB3NkNcUYZpXAPPqyGzt4q7GexfWXB7f4LbQeL2Yk05hsAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntity모델링하기/Untitled.png","title":"img/KotlinJPAEntity모델링하기/Untitled.png","src":"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled.png","srcSet":["/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled.png 280w"],"sizes":["(max-width:","280px)","100vw,","280px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 309px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/33bdc4b207ba3415ae591fd36af777cc/fee6b/Untitled1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 178.31715210355986%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAACXBIWXMAAAsSAAALEgHS3X78AAAEfklEQVRIx5VWaXPiRhD1P0liY27MjRC6BToRiPtYzHrXdnartipfkv9fL90jcDCLWOdDVw/S8NTT/fr13OSLHVyyXKGNtHfX9t9ce8k+k23gPtckawnL0DqTTX6zz+Zp78n+m2tfLFW6sAchdGMATbOg6X2xNkyHfB+m5aArG7+OkC2bb6FcVfD5cYXlLMJms8Z6tcBqtcT20wbz6QTr9RKBH7xLz9UIixUZ69jEfD6GYQ+gaDoU3YCqm7D6A2G62f9YhLyhUO5iv3Cxf/pMR/cJkI5t2NAIZOCF8IIIKqXgw4DsM3kpKQRZV7Lxz7e/RDrS/nPza8pQpJxTelYpSZAbqlgf953axQiPLzgKpgbTQqzJCmSlfFOsRUroA0e7GiHzS9UdRKMxXNdHEEbw/RBBMERI5tHadT30FA29ngZVM1Ct98THUwGtfoDdOsJ4PMJiOcckHmM2m1LFZxjHMabTMXRNg6IoMAwD9YYiTnIR8C7bhqGpeF2bGE1mmC1X2O52mC0WkFVd0MV2XDieT9X2ha9dA8zk2pBlFcuRjWA4xXS+ERbHcwReRNxzYdoeDMslGlHXUOc81FKOnBSFClHo4Dab9PLdfQO/3T6g2dDw98sPOkHjrViJT6ly7owODPz2jqxEVim0BW1yF+wqbQqlzoESyZqflcsSamQFssqDjPLBKtUeivQslTbMPz8YYTmPqaITzGdUGLLJZIoZiUIYhlBVVZiiqKREGpotRUR+GZBy4nkBFrEDlyoYRRGGQ+pdXo8i4iUBEoim68Lr5FttNY2HbQKUMHRUfNs52Oy/CHF4ennF88tXqqiNvuPBJYLb5L2QiB6EaEl6OiBXuCupsE2Tjj7B6/4ZuuXDsgNIsklmUWQDbIlKbclAt2eJTvkph0m1DqD0td8zDdQp4d+3z/jjtioUh5/fUSc9kFb+eHwV4yF76O13Vb44lLjC5Gu5BooHATg9SZGEIncuX6ccSgZR8z+yktWLCej9GYF53273imbbFOufRgCH3e3ZpDJ9SF0N7Y6KnqRRLpN1R3iN+NZNQMlalA7m6sWZwi0WjOeIF2tsNyvEpDKqqhDHiGeCc4rgGxOZI+Woq8X2O7F9D0iC4A1MzEgQvDDhmmZYwky7D1sMJDsBLCSAtbPo3gGyZMWBgeetK7i32+9pwpnokXgafYckKiDZcsSsPoLUDkW7eOS7bAeT0MD3vY9PX14QU4vZjgOfImW9c2j+2gNXRCgKeQAspgFyXnqkgZ7D4jkStwTZoDHpLESxZCJvp2sKEeAjM1C9fOHIp2S+F6Rtvd1nsgX6c4k6oKQgV9HEPgZjGWux6pxQ7qwoR9AzO2pioYmKFJFscXu18EDFqHD+iEL5tCNf6hROQ6UqY8jSH45oYI1JuogBJAajEaVFM9MBL1+Y2jQrZISTpZAxljAGZTCehrphCvH9H4B8A+vhz7VGN68Yj0/PiBjIskXlTdtJ75T0O6IMf2DAcQP4NAF50rFc8bRj/+Ejn1bvTky/Jk2/+tv15OiPxTzu/xevHo/8JGyAfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntity모델링하기/Untitled%201.png","title":"img/KotlinJPAEntity모델링하기/Untitled%201.png","src":"/static/33bdc4b207ba3415ae591fd36af777cc/fee6b/Untitled1.png","srcSet":["/static/33bdc4b207ba3415ae591fd36af777cc/bc34b/Untitled1.png 293w","/static/33bdc4b207ba3415ae591fd36af777cc/fee6b/Untitled1.png 309w"],"sizes":["(max-width:","309px)","100vw,","309px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Entity\ndata class Restaurant(\n        var name: String = \"\",\n        @OneToMany(mappedBy = \"restaurant\")\n        @OrderBy(\"name asc\")\n        var menus: MutableSet<Menu> = TreeSet()\n): MutableEntity() {\n\n        fun addMenu(menu: Menu) {\n                menus.add(menu)\n                menu.restaurant = this\n        }\n}\n\n@Entity\ndata class Menu(\n        var name: String = \"\",\n        var price: BigDecimal = BigDecimal.ZERO,\n        @ManyToOne(fetch = FetchType.LAZY)\n        @JoinColumn(name = \"restaurant_id\")\n        var restaurant: Restaurant\n): MutableEntity()"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"보시는 것과 같이 두 엔티티는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@OneToMany"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@ManyToOne"}]},{"type":"text","value":" 으로 양방향을 가지고 있고, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"LAZY fetch"}]},{"type":"text","value":" 되게 되어있습니다. ("},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@OneToMany"}]},{"type":"text","value":"에서 fetch 는 default가 LAZY 방식이므로 생략 하였습니다.)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"앞서 말씀드렸다시피 data class는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"open"}]},{"type":"text","value":"이나 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"abstract"}]},{"type":"text","value":"가 될 수 없고 기본적으로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"final"}]},{"type":"text","value":"로 선언되어집니다. 위 두 클래스를 자바 코드로 변형해보면 다음과 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 427px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/8fd149d918a4c43790e050369251249f/f6b9c/Untitled2.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 69.08665105386417%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACAElEQVQ4y42T63KbMBCFeZbW5i6Ji8TdwmBwIG0cp3YyvST91fd/hdMF0nTaTsf+8c1KDDpztHtkJNkOlitheymRwPZTWFQtl9aOmqvpLnvHoX8m3HReO96/GIfhBafuBUPzGcfuGbfdFzxMdXjG7vQDQ/8V5/47Dvtv0A9n1E9PqM+P0KcnNHdHbHf32Gw/Qb9iJHKPZOhRPo4oDjcIZQ3OKjBRwQs0uNggIAThhxX8qFrqTAmf/4kh0w6pbLBNeui0B8taBPoDylJjX1XzVdd2DNOWsP7CfMVyfmNwTi5ajezYIxlbeFFJvcjgsgwe4Ux9da/H4GENGWq06R5adYh3B6j2HqH+CJW3aPIcWUJOnWVIFwXDoIGrC7Chgd/WEA31anLGcjj+5DCH5xckqBbRS4Ii2sI2QzCqUXlLYiSa9Yg2I6LtHZJkRCbHuZfWNQ5FUIPFlLGQ8scoj8GUNYm1GS9YC78OXBI1hKjhUJ9430J0OxoQ9TQrIAL6FuYQBKe1fbXD6cqrAIzXCNMRrp1BZRUqrVFsiGqDSBZvYhcdBiENI0/hFeRC0QFPYrWK8H5iHePdWs6sLAXzClHqIQ1D1/SMRujhBpyCzSjoXDVg9BqSOKPg5wQlgaZ/0eGUQ2HTAVdDeTQgRS8l7+dJi5iurHJs0hIVtYGL/M3l//gJvojAAycVkaIAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntity모델링하기/Untitled%202.png","title":"img/KotlinJPAEntity모델링하기/Untitled%202.png","src":"/static/8fd149d918a4c43790e050369251249f/f6b9c/Untitled2.png","srcSet":["/static/8fd149d918a4c43790e050369251249f/bc34b/Untitled2.png 293w","/static/8fd149d918a4c43790e050369251249f/f6b9c/Untitled2.png 427w"],"sizes":["(max-width:","427px)","100vw,","427px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 517px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/51269c629f86405c63734256224f326a/81e22/Untitled3.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 61.315280464216634%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB4klEQVQoz3VT2ZKjMBDLx2y4bMxljM0RJiEhZHa2av//Z7QyIZukauZBtKtwC0nd7Fx+hNEf0OUIow5oiFRPyNwMZc/Q+Yg+O0HVPZKxh+hZuw5SGURxjTBhTWrCrNhJ5dAvM4b5glyPUCSodQ9V9IhTByEsUuEQywaRItINyQ+EcWrR9CeY9oh8oBJzRGtapGzahxohmwLf6BFt9YGNxJ+fhNIgaXsUyxfK6QYpLQoS1raDcVQp3hte8SB+Jd3FlCupJkk7pHlHa7RIayq3SGSzXf6eLPpWYe6Q/j1CLAOKhsrMhFIwfCoPflD2IBHMWKoWQfRCmDDDw3HGx+nKyU6wtNvUvBRvoa/Z8RyZ9/zePva0vfOHPGmhIouSky2pOPPTZHaRqNfLYaoRECFVx5IT5+R9n3cQhPWq8H+GCV+64gStzzDVBVU2oSsWGDPD2htcc4W73KDPV1TjGVV75bDOaCz3lTlnBQUUlh9p7gqDWEMwh+Hwm9Yv6NjUnb4wuD+0v6DIJ5hyQV3MKEuS8K7KuAlVhyxvUdV3CLkR+keadTi2C4bLCPc5IrseoEfWiovNjGP+FTrjavEnWG1GHnqt+/COp2WuScRs/JL+IvbJ/RyuQTerFQ8fjZD2x6k/hvIP0OV7H1+QZZwAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%203.png","title":"img/KotlinJPAEntityModeling/Untitled%203.png","src":"/static/51269c629f86405c63734256224f326a/81e22/Untitled3.png","srcSet":["/static/51269c629f86405c63734256224f326a/bc34b/Untitled3.png 293w","/static/51269c629f86405c63734256224f326a/81e22/Untitled3.png 517w"],"sizes":["(max-width:","517px)","100vw,","517px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위 코드는 IntelliJ에서 kotlin → kotlin bytecode → decompile java code 한 결과라서 가독성은 떨어집니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제 간단한 repository test를 통해 Menu Entity를 조회 하고 Restaurant Entity를 지연로딩 해보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"코드"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 623px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/c52bb4a495e7a2eba3686514cc5a7fea/64096/Untitled4.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 23.434991974317814%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABBElEQVQY023P7WqDQBCFYa+mMSZq1HXX9dukbYj1I7aBUOj938bbSVIohf54OLOwDHMcVeyxuqW0HVp3xKpFm45C3oVknYuiI5M/UdKyi5qHXftHeBO1OP1+ZnlbOJ9GvpaR6zzyOQ8sMveXiY/zwHWc6MeBepqxxxmzH8mOw8PrgBH2pcdWPU7slYRhQ7BrMOZAHFdEcoEfWpTOSBJDpizrMCdt3jHt5T4/BYqVnz4EKa6vcD2F40WWjc7ZmoIwFlGBMhWn/sAwPFM3jdQppWZNnHSSFe5aFrha8tfqh+OGhnWS3W0Dgx9YuS4jy0tsWRGnBRs/lwbSRJYFct3qttDT//oG/oWmIOcWiJ0AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%204.png","title":"img/KotlinJPAEntityModeling/Untitled%204.png","src":"/static/c52bb4a495e7a2eba3686514cc5a7fea/64096/Untitled4.png","srcSet":["/static/c52bb4a495e7a2eba3686514cc5a7fea/bc34b/Untitled4.png 293w","/static/c52bb4a495e7a2eba3686514cc5a7fea/da9f0/Untitled4.png 585w","/static/c52bb4a495e7a2eba3686514cc5a7fea/64096/Untitled4.png 623w"],"sizes":["(max-width:","623px)","100vw,","623px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"결과"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"정상적으로 초록막대와 함께 query 로그도 한번만 찍힌 것을 확인했습니다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/4d8d3ec05c6b7a77bbcd0c873245762f/670c0/Untitled5.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 10.038824181919024%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAdUlEQVQI1y2MWxKDIBAEPZIPFFBYJJRRoHL/43TQ5KNrZqt2uovpg6SKcQfWNCSjfGEOFWUPfCiEWJG9sLqT1V9Pmu2N0i/6SRim8NCPQuflwsWMXhNGJ2wbKJ8Zlsg470jIPD9/tiZz/vz1lvetbWJp8qHJv65ORNTYSVPsAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%205.png","title":"img/KotlinJPAEntityModeling/Untitled%205.png","src":"/static/4d8d3ec05c6b7a77bbcd0c873245762f/913fc/Untitled5.png","srcSet":["/static/4d8d3ec05c6b7a77bbcd0c873245762f/bc34b/Untitled5.png 293w","/static/4d8d3ec05c6b7a77bbcd0c873245762f/da9f0/Untitled5.png 585w","/static/4d8d3ec05c6b7a77bbcd0c873245762f/913fc/Untitled5.png 1170w","/static/4d8d3ec05c6b7a77bbcd0c873245762f/efb0c/Untitled5.png 1755w","/static/4d8d3ec05c6b7a77bbcd0c873245762f/670c0/Untitled5.png 1803w"],"sizes":["(max-width:","1170px)","100vw,","1170px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1146px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/b83ee2aa872e5a085123fb2f2d9838b4/12898/Untitled6.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 25.654450261780106%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA5ElEQVQY0z1QW1LDQAzLdaAPCp1Cm2bfuyTZkLbT4YP7X8RILuRDY9lryV43pf5I/ryJj7OEfNEYy1V8mpeaDV8K5sZPD54u4hA1B8gPH0kaF2ZJBSJfNRJ1+pbS3zDoKsN4Fx8omCRjkLGDcr77CEM3igVCnOTp+V0aA6OYZ+nQGLAVeQ+TBHHEdhQ69NAkIe9MD17VnLXOjmrKoav1URquW/hlFGjGqTwBefoz5Pb6A54EfQE95A/DQbdmbfPSStO5qhOObcYNouwPXrHdnWW1Ocl62y6g4B98370Zrb/u7aL5BZgmsEmuc5n1AAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%206.png","title":"img/KotlinJPAEntityModeling/Untitled%206.png","src":"/static/b83ee2aa872e5a085123fb2f2d9838b4/12898/Untitled6.png","srcSet":["/static/b83ee2aa872e5a085123fb2f2d9838b4/bc34b/Untitled6.png 293w","/static/b83ee2aa872e5a085123fb2f2d9838b4/da9f0/Untitled6.png 585w","/static/b83ee2aa872e5a085123fb2f2d9838b4/12898/Untitled6.png 1146w"],"sizes":["(max-width:","1146px)","100vw,","1146px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그럼 정말로 문제 없는걸까요? 더 확실히 테스트해보기 위해 직렬화가 필요한 controller 테스트를 해보았습니다. ( 이 테스트는 service를 mocking하는 단위테스트로 작성하지 않고, 실질적인 테스트가 필요하여, 통합테스트로 진행했습니다. )"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"코드"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 786px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/1a3bfb85dd69a1e72e47a3eeaf800704/9aac8/Untitled7.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 27.099236641221374%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA90lEQVQY01WQWW7DMAxEfZjCjhVv8SLKWijFTpEC/Up7/7NMacct0o+BSAnzOFSWli9UF4dqnKHOGl1DmPoZ46G+M9Bybned1IWacFL60ISi1C+9Rrbev1HVTswWJFDSFn52WKwHGwcvWkNAkp6GJ7Aon/qFvNYZpwfKyqCpCYOkUClARY/KOvS0YBgZrYBUS8gFphTJJrSb3/IR+Wn6nzBeH1D1LA3t8etbRHtjNHfGJTCcvWJ2ATYyzuwxcYQJVxgX8fG5YCT3B96SZnwAS5layh9WMaAWY508GlmdiKGNh5O1Jx8wyPsG7k0AxwTLG3jF8p52/w+YBaHYpeeuxgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%207.png","title":"img/KotlinJPAEntityModeling/Untitled%207.png","src":"/static/1a3bfb85dd69a1e72e47a3eeaf800704/9aac8/Untitled7.png","srcSet":["/static/1a3bfb85dd69a1e72e47a3eeaf800704/bc34b/Untitled7.png 293w","/static/1a3bfb85dd69a1e72e47a3eeaf800704/da9f0/Untitled7.png 585w","/static/1a3bfb85dd69a1e72e47a3eeaf800704/9aac8/Untitled7.png 786w"],"sizes":["(max-width:","786px)","100vw,","786px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"결과"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"테스트의 결과는 초록막대인데.. 찍힌 로그가 뭔가 이상합니다"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 934px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/439971cdb4b4dfdb354a47926869f71c/4ccff/Untitled8.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 34.58244111349036%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABN0lEQVQoz1VRW3KDMBDjRm2IwRg/sR0CJJCZfvT+N1Flt02bD8aaXa1WWpq0fmJePxDzA1M6EPKOEHdYf4MNt4rddOfHWrjXmvEbjNsqdqx59jw5ntxGs+EDCfYKR2IXEpxe0IkAqVLtDeaKnjxhFrTC49Q6vJ8Mzl2A5pz1K+cXhGlDY9yKfHlww4aJG4Y0I9LdIBOUmZHygZFOFF1Ivp2MVagI90Pk3A0x7fVNlwON4nbjFih9gSYWNkKrGYIOy3DpST2j0+yNM9qODs902NoqXOfociSncJuRMYrlkW6KbeEo8k/QktSTXOIKihZnReztREHiIvQraD0Fy4Hz/PixfkDlv8hjjby/RBb99IxcFjre+CVycViKJa7lPaXPsMSSZKly/SmKzqVd0ZP7ckPi509x3zpfWsLzZYVya4oAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%208.png","title":"img/KotlinJPAEntityModeling/Untitled%208.png","src":"/static/439971cdb4b4dfdb354a47926869f71c/4ccff/Untitled8.png","srcSet":["/static/439971cdb4b4dfdb354a47926869f71c/bc34b/Untitled8.png 293w","/static/439971cdb4b4dfdb354a47926869f71c/da9f0/Untitled8.png 585w","/static/439971cdb4b4dfdb354a47926869f71c/4ccff/Untitled8.png 934w"],"sizes":["(max-width:","934px)","100vw,","934px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/ac5077b77b8167a014b9f2cbf86f34b9/ffaf0/Untitled9.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 21.608040201005025%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAtElEQVQY01WQaw6CMBCEuY9GQQtS6JtXEYzx/ocZdwvE+GMy2+zut5NmhV1xkSOUifBhhXFPGDtDNgNkO0CUblPlUdVdctZDdijJb8LivvfzQiO7thEn4aAJyDClI2lCS+IDzi+wJEf1FD/w3Up6YaQ6kPNx7vNsVQdkuZpxLn1KaBlIznAG8uCRmOt+eKf3UfMxDqDNnHY55QYUPqUyO5BhjfoBtd0W/oAjAcOS5o/vqpseX4Ani95JNFyfAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%209.png","title":"img/KotlinJPAEntityModeling/Untitled%209.png","src":"/static/ac5077b77b8167a014b9f2cbf86f34b9/913fc/Untitled9.png","srcSet":["/static/ac5077b77b8167a014b9f2cbf86f34b9/bc34b/Untitled9.png 293w","/static/ac5077b77b8167a014b9f2cbf86f34b9/da9f0/Untitled9.png 585w","/static/ac5077b77b8167a014b9f2cbf86f34b9/913fc/Untitled9.png 1170w","/static/ac5077b77b8167a014b9f2cbf86f34b9/ffaf0/Untitled9.png 1592w"],"sizes":["(max-width:","1170px)","100vw,","1170px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"객체를 직렬화 하기전까지는 서로 참조하는 값을 계속해서 참조 할 일이 없지만, 직렬화를 하기 위해 참조하는 과정에서 뭔가 하이버네이트 엔진이 HIkariProxyResultSet으로 부터 결과 값을 가져오는데 무한적으로 재귀호출을 하는 것 같습니다. ( 개발환경에서 허용된 메모리만큼 재귀호출이 되다가 결국엔 StackOverFlow가 발생합니다. 내부적으로 예외처리가 되있어 직접적으로 에러로 표시되진 않는 것 같습니다. )"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"로그를 자세히 보시면 HikariProxyResultSet의 HashCode가 계속해서 바뀌고, 계속해서 새로운 객체를 참조하여 DB 데이터의 결과값을 가져오려고 시도합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이 문제를 해결하기 위해 제가 시도한 방법은 다음과 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"data class"}]},{"type":"text","value":" 를 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"일반 class"}]},{"type":"text","value":" 로 변경 후 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Hibernate"}]},{"type":"text","value":"가 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Lazy load 객체"}]},{"type":"text","value":"를 가져올 때 정상적으로 작동 할 수 있게 open 키워드 달아주어 상속 가능하게 만들기"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"직렬화 시 무한 재귀에 빠지지 않게 하기 위해 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"HibernateModule"}]},{"type":"text","value":"을 빈으로 등록하여 jackson에configuration 하기"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Data class → class 로 변경 후 open 키워드 달기"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 data class를 일반 class로 바꾸기"}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Entity\nclass Menu(\n        var name: String = \"\",\n        var price: BigDecimal = BigDecimal.ZERO,\n        @ManyToOne(fetch = FetchType.LAZY)\n        @JoinColumn(name = \"restaurant_id\")\n        var restaurant: Restaurant\n): MutableEntity()\n\n@Entity\nclass Restaurant(\n        var name: String = \"\",\n        @OneToMany(mappedBy = \"restaurant\")\n        @OrderBy(\"name asc\")\n        var menus: MutableSet<Menu> = TreeSet()\n): MutableEntity() {\n\n        internal fun addMenu(menu: Menu) {\n                menus.add(menu)\n                menu.restaurant = this\n        }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아까 위에서 소개해드렸던 JPA 표준 POJO Model 객체가 되기 위해 "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"일일이 entity 마다 open 키워드와 빈 생성자를 작성하긴 귀찮으니,  kotlin jpa plugin 을 사용하여 자동적으로 모든 entity에 적용 시켜주겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"적용하는 방법은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"build.gradle"}]},{"type":"text","value":"(groovy dsl) 혹은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"build.gradle.kts"}]},{"type":"text","value":" (kotlin dsl) 에서 설정 할 수 있습니다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"저는 kotlin dsl을 사용하고 있으므로 다음과 같이 작성했습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"build.grade.kts"}]}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"plugins {\n        ...\n    kotlin(\"plugin.jpa\") version \"1.3.61\"\n}\n\nnoArg {\n    annotation(\"javax.persistence.Entity\")\n    annotation(\"javax.persistence.MappedSuperclass\")\n    annotation(\"javax.persistence.Embeddable\")\n}\nallOpen {\n    annotation(\"javax.persistence.Entity\")\n    annotation(\"javax.persistence.MappedSuperclass\")\n    annotation(\"javax.persistence.Embeddable\")\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위와 같이 작성하고 나면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Entity"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"MappedSuperclass"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Embeddable"}]},{"type":"text","value":" 의 어노테이션이 붙은 클래스에 빈 생성자와 open 키워드가 자동으로 정의됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"open"}]},{"type":"text","value":" 키워드를 코드에서 정의하지 않았는데도, 자바로 변환한 코드에서는 원래의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"final class"}]},{"type":"text","value":" 에서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"일반 class"}]},{"type":"text","value":" 로 변경되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 841px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/49db6c6a6dd1eca5723f0a9bfcba3127/9131b/Untitled10.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 53.74554102259215%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB6klEQVQoz51S2Y7bMAz0zyTxER+Sbcmy5UOynatJge5mtw3Qh/7/T0wpO7tAXwq0DwQFkZoZcuQ14wOqPqEzD4yXnxiP77DnXzDHB7R5Qd3eUOsrBeX2CmNusNMb+vGGbrhCqgNU86xTeGamYv8NLFCI0xppppEyjSiusPUL7ILyMza7HDxvYcY3pLNFpGqEoYQfis8ez0zfUZuvCLMKG7pYQPw1u0b/2ejO7i7jHQb7ijjvkbrIBvgRvd0RIb3zvlze0egjFTsUrEWSNohYh3BfYecAI4ngqcIBpqxfAfmAhGtUhYTIBUouUeUS3uX8irI0S3OhibE2yOozmJqQt2dwMWEfN6SyWEZm3I18ByfAOKlRSg0pWohKo2gaeAcyQcgZIaPiYURlB+RihBzOUP0BvGgRxop2WiOg0VhhMJg7vTFQnV2U8qQlUoUtrwjw9AO6u5GaGdVwRNONxHZAoU4EPIOX05LXMxGR+n54QSZ6NHZEKkci1UgSsezeGyzJLyw2W74sf+t/GPOnwx8uJ8yZckdKynNSmNUT4tKiIA8C2vcCmBPz1s9XV/8SqykdDL2JGZlH+9tzyvTV9jS26/GcY/8DGGUKgdD0fRQZJUi5XP+hA+T/COhMKZsRzUx7FZaMGsCIIE0r/Ab2aWea5588AQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%2010.png","title":"img/KotlinJPAEntityModeling/Untitled%2010.png","src":"/static/49db6c6a6dd1eca5723f0a9bfcba3127/9131b/Untitled10.png","srcSet":["/static/49db6c6a6dd1eca5723f0a9bfcba3127/bc34b/Untitled10.png 293w","/static/49db6c6a6dd1eca5723f0a9bfcba3127/da9f0/Untitled10.png 585w","/static/49db6c6a6dd1eca5723f0a9bfcba3127/9131b/Untitled10.png 841w"],"sizes":["(max-width:","841px)","100vw,","841px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Jackson configuration"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아직 lazy 로드 되기 전의 proxy 객체 또한 직렬화 하려고 하면 에러가 나기 때문에 다음과 같은 솔루션으로 직렬화 시 문제를 해결합니다. ( lazy 로드 되기 전의 proxy 객체는 null 처리 해줌 )"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"저는 hibernate5 버전을 사용하고 있으므로 다음과 같이 작성 했습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"build.gradle.kts"}]}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"dependencies {\n    ...\n    // Hibernate5Module이 지연로딩 되는 객체의 프로퍼티 직렬화를 가능하게 해준다. (jackson ObjectMapper support)\n    implementation(\"com.fasterxml.jackson.datatype:jackson-datatype-hibernate5:2.9.8\")\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"JacksonConfig.kt"}]}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Configuration\nclass JacksonConfig {\n\n    @Bean\n    fun hibernate5Module(): Hibernate5Module {\n        // Hibernate5Module이 지연로딩 되는 객체의 프로퍼티 값이 비어있더라도 직렬화를 가능하게 해준다.\n        // 이 모듈을 bean으로 등록 안하면 hibernateLazyInitializer 라는 하이버네이트 프록시 객체의 프로퍼티를 직렬화 하려다가 에러남\n        return Hibernate5Module()\n    }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위 처럼 변경해준 뒤 다시 테스트를 돌려보면"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"정상적으로 테스트 통과 후 한번만 쿼리하는 것을 볼 수 있습니다"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/db10cb8de14458109af3d0b7d44c30ad/02cf6/Untitled11.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 17.59465478841871%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0klEQVQY0z2PWW7DMAxEfZ8mVSXL2pfIlrcESIDc/y5TSin6MRiQot6QQ1hOOLMhpBM236HKE2Z9Q+UH8u2BZX1hbqovbMeb/AltV0g1Q8hbFx8zfkQC4xGDDAWTyFB2gfQbmN/B3I4LPTq/IlJQiDtiPingDh92Cj+QqE5Up97bCJrwdTUYdKpQskC7iomA3B8Q4QSj5Pa5QwhoCW5sJd9owwpBAP4nqQpGmXFlHoNpwLH0IRUIRkBOJzEabJC2Tff42axBJz3/S+l2+gd2+Xb4BcVDiHlDCwhlAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%2011.png","title":"img/KotlinJPAEntityModeling/Untitled%2011.png","src":"/static/db10cb8de14458109af3d0b7d44c30ad/913fc/Untitled11.png","srcSet":["/static/db10cb8de14458109af3d0b7d44c30ad/bc34b/Untitled11.png 293w","/static/db10cb8de14458109af3d0b7d44c30ad/da9f0/Untitled11.png 585w","/static/db10cb8de14458109af3d0b7d44c30ad/913fc/Untitled11.png 1170w","/static/db10cb8de14458109af3d0b7d44c30ad/efb0c/Untitled11.png 1755w","/static/db10cb8de14458109af3d0b7d44c30ad/02cf6/Untitled11.png 1796w"],"sizes":["(max-width:","1170px)","100vw,","1170px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 300px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/32366886ed6e3611e910d59884b9e7ce/c3605/Untitled12.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 77.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACYklEQVQ4y41T2XKbQBDkMyxxLexyHwKEkFFhSbas+KhU7OT//6XTi6QYV5zYD10ztTC9M9O9hlIKwnXhOvYIzxNwhQfbFSMcISAIz/O+BEMIF54MEZXNCOH5SHwPqzhAl4SMCoqXWLYF27Y/heE6DlSUovv2ivbwhDBJsSgSPB967PoGt8MK9aKEw//GST6B4boOwqxCPRyw6LfI2w2q6zWGxz3KrsZq6JBkKeYmOySpxn8J9c2eCpA2ayw2d6h2T6j3j4iLGss8RR4qJMo/xUAi8LlXjqbrPoJxYbbmM6g0R3t8RdFtoAKFdR7hblng2FUYyhSbRYYmi8fl22fSv3dIMq2ibZkIixbd0y9Um/24yypSuKkySCkxM02YlkVxpkTOn/xdhxfCIK9QbR9IFiGjMHq/ukiLoX92HefDrqZnb4S0RZCWyNdb1Df3WB2e0eyPUGGIkp3etyV6jt3zojZPxs43JfM0wjXPKjbhnFQ+7dDmOAHVXh1/kuw74wuWtFEQ0YtZhC3352nPniHpTV9oXM7Em8pxHHOs005knMMPI8gooeHlOHZAo2tzf8nYetQkL1H1O3i+DyUdKn4Fk6pb7HpG/13NzTGalj36UYujofM549RG7NBmNylKKps1HZbDDuX1lq8nRsjO1npnaYiazzCjlVrapuKzLIkV84bfpkobmn0k7G/R3v3A8v4F3cNPxFlBM0s80INLki2igIQSBWOpcxpdExdxeBb1TCi4I+HLkTBfDVT5BlnbQ/L1FCyqWWRNRp2fMR15ah1DcW8WPWjOrt7BuhSz6F/PbIoL6W/2Psof4/qo3AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"img/KotlinJPAEntityModeling/Untitled%2012.png","title":"img/KotlinJPAEntityModeling/Untitled%2012.png","src":"/static/32366886ed6e3611e910d59884b9e7ce/c3605/Untitled12.png","srcSet":["/static/32366886ed6e3611e910d59884b9e7ce/bc34b/Untitled12.png 293w","/static/32366886ed6e3611e910d59884b9e7ce/c3605/Untitled12.png 300w"],"sizes":["(max-width:","300px)","100vw,","300px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"실제로 데이터가 조회되었고, lazy fetch 모드로 설정되있고, 아직 꺼내지 않은 객체 restaurant.menus에 대해서는 null 처리가 되어있습니다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"하지만 여기서 끝이 아닙니다. 현재까지는양방향관계에서  "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@ManyToOne"}]},{"type":"text","value":" 를 가진 쪽의 엔티티 조회에서 문제를 해결했는데요, "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아직 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@OneToMany"}]},{"type":"text","value":"의 관계를 가진 엔티티를 lazy load 조회 할 때 문제가 있습니다.\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n이 부분까지 해결하기 위해서는 여러가지의 솔루션이 있는데 그 중 하나를 다음 포스팅에서 소개하겠습니다.\n"},{"type":"element","tagName":"a","properties":{"href":"https://thxwelchs.github.io/JPA%20%EC%96%91%EB%B0%A9%ED%96%A5%20Entity%20%EB%AC%B4%ED%95%9C%20%EC%9E%AC%EA%B7%80%20%EB%AC%B8%EC%A0%9C%20%ED%95%B4%EA%B2%B0/"},"children":[{"type":"text","value":"JPA 양방향 관계 무한재귀 해결 포스팅 보러가기"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"감사합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"참고"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"하이버네이트 공식 엔티티 모델링 가이드 "},{"type":"element","tagName":"a","properties":{"href":"https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#entity"},"children":[{"type":"text","value":"https://docs.jboss.org/hibernate/orm/5.4/userguide/html"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"single/Hibernate"}]},{"type":"text","value":"User_Guide.html#entity"}]},{"type":"text","value":"\nkotlin compiler-plugins(no-arg, all-open) "},{"type":"element","tagName":"a","properties":{"href":"https://kotlinlang.org/docs/reference/compiler-plugins.html"},"children":[{"type":"text","value":"https://kotlinlang.org/docs/reference/compiler-plugins.html"}]},{"type":"text","value":"\n코틀린 JPA "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/spring-guides/tut-spring-boot-kotlin#persistence-with-jpa"},"children":[{"type":"text","value":"https://github.com/spring-guides/tut-spring-boot-kotlin#persistence-with-jpa"}]},{"type":"text","value":"\n객체지향적 상속성 활용한 엔티티 설계하기 "},{"type":"element","tagName":"a","properties":{"href":"https://victorydntmd.tistory.com/209"},"children":[{"type":"text","value":"https://victorydntmd.tistory.com/209"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"excerpt":"최근 스프링부트를 개발 할 때 Kotlin으로 많이 개발하고 있는데요, 특히나 이 포스팅에서는, JPA Entity 모델링 을 할 때 주의해야 할 점들을 살펴보겠습니다. Entity 모델링 먼저 코틀린에서 Entity…","timeToRead":7,"frontmatter":{"title":"Kotlin JPA Entity 모델링하기","userDate":"6 March 2020","date":"2020-03-06T22:28:00.000Z","tags":["kotlin","jpa","entity"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHu01Eg/8QAGBAAAgMAAAAAAAAAAAAAAAAAAQIAICH/2gAIAQEAAQUCORWJr//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAAgITH/2gAIAQEABj8Chi//xAAZEAEBAAMBAAAAAAAAAAAAAAABEQAgIWH/2gAIAQEAAT8haOLisZ9uv//aAAwDAQACAAMAAAAQ+A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAgMAAAAAAAAAAAAAAAABABEgQVH/2gAIAQEAAT8QONjkY0hoG3H/2Q==","aspectRatio":1.78,"src":"/static/d4600748e32e427b776548f4d5ce4cbe/771ce/%EC%BD%94%ED%8B%80%EB%A6%B0JPA%EB%AA%A8%EB%8D%B8%EB%A7%81%ED%95%98%EA%B8%B0-postbg.jpg","srcSet":"/static/d4600748e32e427b776548f4d5ce4cbe/f8f18/%EC%BD%94%ED%8B%80%EB%A6%B0JPA%EB%AA%A8%EB%8D%B8%EB%A7%81%ED%95%98%EA%B8%B0-postbg.jpg 930w,\n/static/d4600748e32e427b776548f4d5ce4cbe/771ce/%EC%BD%94%ED%8B%80%EB%A6%B0JPA%EB%AA%A8%EB%8D%B8%EB%A7%81%ED%95%98%EA%B8%B0-postbg.jpg 1424w","sizes":"(max-width: 1424px) 100vw, 1424px"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEr0lEQVQ4y2NggIKK7GoGXRVJhv///4P54bY+WaXlRdEeOa4TdNS0V8krGa8P9J/UWFbZ4WFv6V0SFuArAFIXGhLB0FXQwIAV2Jg6MIFoBRNdRVsV6/9JniEvTaNSfyjInPxvK7j8f4xi239T3fp3egq2/8vjM6NAatMCEliwGjajZRaDv04wM4jtrOs2P9U67+x+qy33QrU2vVBSO7S2XG/x4cUOnXsrHHZtMpKMuJtll3QF6BtWkPqJld2YBvp7B4JpkJdV+VRuFKrmnD3mf/lsqFrHHxEe1pO+Hq4v8/ML/jc11u3LsEi/4qPo9L++oNgEpKcsJpsJw0Af3yiYgcwSogrnerQ6/h/WWPS807xsuZ2Gw/e8nNxfhYVF/xuSai9HSKS8t1dx+d9T2AA2sDSmENPA8NA0MN32/z+LmYzu6SqbuZ86rPb/r3HsWFZdU/KiorLyf1F63us5Lv2bbBTT//uY+//fUrfAFKSnr7AVm4EFcBeqiBtcjNFd8z9G/+H/CPnO/7kZqd+trWz/VyVl17TLd9zUDYz7Zeds+785pNUMpKcQmwsDIzMgBi78z8znoHGhyLD5/1OtQ1Vplmn7CjPz/rt6e76rtI7PyzPtui6nm3tVXc/sf05WLdjA+IRcTANdA4MhBtr+Z5Z3VLxgaFLzP1O6aXNLTsm5jNzs/xVlpZ9zLeKPGmo1XlBWqr7j6OT9Jy4uFWxgZEQ8poEyHgpg2uS/PZO+n86ZILGS//nCxQ8bM4vPhsZF/k/2iPw9wbZ2j65d/vTgoII+f7+QN3HhcZYgPbGRWAx09vaHhSGjvLjGzUwpvyX14SUH6xpqv0elxvxvC6j+H6q44Jm20aQ91lZx+1zNHd5Oq5qsA9LTWtiAaaCNtTMkgR9axSrEKXY6ISz5Qlld3Z/8rKL/ubGpf/1tGn7JaU36q6ux5aG8QvF7X22Pdy8OXJcE6ZnVMoURw0ALdWMYk8VIVe9kdV3r//KK2v+lBcV/Yy3jfomoe/43WK78USAg5LM4S9b/UsP0k8tvL+IHJ7XaekwDTfVswTQbrySHgarRzpacluM9nf0/M7PS/peY5/7fYbr0W2FUwnO3YufXztK+L9P0o/f3Hl4MLiAq86owDbR18IGFIRMnp8A1e2G3/42GNf+nerf+azKo/L9VfdbnjQazf2zXm3t5uVH/A1kx+a8p0akqID0RfhGYBmoo6IFpMV5BdiN1m63u5kl7M1X7HocrTP1fplP3f53N7JdLbCe9mWvec6NULuOLm7Hn1+bWLnmQnvzEAkwD9XQhXj6ySotZWcXzsJxK01d72xWXC4w2/W+LXvyyNb/nXU1q++95gZP21esXXnIy9PrmFRUBNtDXMwTTQHcvSLL5/G8uq4CwzkNZqa7/sjobPmVpzXtZbjcJmCt6vrQkTP61zHrx73na3f81JNT/xxVmK4H0REXEYRqYmprA4OgQD5YICgxs8fJI+KpvlHkhwqz8dIZF0cUKj5rzi9wnXS5wr7mbEZjxP9DDZ3H0nhXg8jM5MQ17ib148RQ4u7o2Mzg41HW5vaPJAQtL3SPGxlpHzewM99m7WexwD3bNganLLslHMQMA1vLffALEkU8AAAAASUVORK5CYII=","width":151,"height":151,"src":"/static/bf7f9f29887116a6d496e42f356b60db/b3147/thxwelchs.png","srcSet":"/static/bf7f9f29887116a6d496e42f356b60db/b3147/thxwelchs.png 1x"}}]}}}},"relatedPosts":{"totalCount":5,"edges":[{"node":{"id":"2baf5d38-24bb-581d-84fa-fcb7ed46d5e1","timeToRead":3,"excerpt":"Java 와일드카드 제네릭  제네릭은 Unbound wildcard라고 불리며, 어떤 타입이 될지 모른다 라는 의미입니다. wildcard…","frontmatter":{"title":"제네릭 1편 와일드카드 (Generic Wildcard)"},"fields":{"slug":"/GENERIC-1/"}}},{"node":{"id":"b6b53e17-cc4d-5945-8c2f-edb6bbf12c82","timeToRead":2,"excerpt":"JPA ORM으로 개발하다보면 꽤나 많은 양방향 참조가 필요한 모델들이 있습니다. 그런데 문제는 이런 양방향관계를 가진 객체를 직렬화 하려고 할 때 무한참조가 되어 StackOverFlow를 발생시키는데요. 그렇다고 해서 ORM…","frontmatter":{"title":"JPA 양방향 Entity 무한재귀 문제해결"},"fields":{"slug":"/JPA 양방향 Entity 무한 재귀 문제 해결/"}}},{"node":{"id":"0218b7f8-6134-560a-a6e9-196cdda33de2","timeToRead":1,"excerpt":"안녕하세요 이번에 소개할 내용은 코틀린에서의 필드(field)와 속성(property…","frontmatter":{"title":"코틀린 필드와 속성"},"fields":{"slug":"/kotlin-property/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/Kotlin JPA Entity 모델링하기/","prev":{"excerpt":"2020년이 되면서 javascript 표준 규격인 ECMA script 에도 몇가지 추가된 사항들이 생겼습니다!\n 어떤 것들이 있는지 한번 살펴보겠습니다. 널 병합 연산자 (Nullish coalescing operator…","timeToRead":3,"frontmatter":{"title":"ES2020","tags":["javascript","es2020","ecma script","ECMA"],"date":"2020-02-29T22:31:55.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.78,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHvSsjRX//EABgQAAMBAQAAAAAAAAAAAAAAAAECEQAg/9oACAEBAAEFAiZkanj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGH/8QAGBAAAgMAAAAAAAAAAAAAAAAAABEBIGH/2gAIAQEABj8CJayv/8QAGBABAQADAAAAAAAAAAAAAAAAATEAESD/2gAIAQEAAT8hAbZigdRz/9oADAMBAAIAAwAAABD4D//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABYRAQEBAAAAAAAAAAAAAAAAAAEQUf/aAAgBAgEBPxBCjk//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAgQWH/2gAIAQEAAT8QISoNjsjQ2O1//9k=","sizes":"(max-width: 1424px) 100vw, 1424px","src":"/static/b9d3879f84d259be41f5e4820f4ebfef/771ce/ES2020-postbg.jpg","srcSet":"/static/b9d3879f84d259be41f5e4820f4ebfef/f8f18/ES2020-postbg.jpg 930w,\n/static/b9d3879f84d259be41f5e4820f4ebfef/771ce/ES2020-postbg.jpg 1424w"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"fixed":{"src":"/static/bf7f9f29887116a6d496e42f356b60db/b3147/thxwelchs.png"}}]}}},"fields":{"layout":"post","slug":"/ES2020/"}},"next":{"excerpt":"JPA ORM으로 개발하다보면 꽤나 많은 양방향 참조가 필요한 모델들이 있습니다. 그런데 문제는 이런 양방향관계를 가진 객체를 직렬화 하려고 할 때 무한참조가 되어 StackOverFlow를 발생시키는데요. 그렇다고 해서 ORM…","timeToRead":2,"frontmatter":{"title":"JPA 양방향 Entity 무한재귀 문제해결","tags":["kotlin","jpa","entity"],"date":"2020-03-06T22:47:00.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.78,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHuV1BI/8QAGBABAQADAAAAAAAAAAAAAAAAAQIAESD/2gAIAQEAAQUCreFK8f/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAQADAAAAAAAAAAAAAAAAAAEAIDL/2gAIAQEABj8CmUr/AP/EABoQAAICAwAAAAAAAAAAAAAAAAEhAEERIDH/2gAIAQEAAT8hwMcFRkQvX//aAAwDAQACAAMAAAAQ9w//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QoX//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgEFAAAAAAAAAAAAAAABESEAIDFRcbH/2gAIAQEAAT8QQ3oSi16rDAJJ4b+6f//Z","sizes":"(max-width: 1424px) 100vw, 1424px","src":"/static/4bf18ab37cd31474fd591b9287a49f4c/771ce/postbg.jpg","srcSet":"/static/4bf18ab37cd31474fd591b9287a49f4c/f8f18/postbg.jpg 930w,\n/static/4bf18ab37cd31474fd591b9287a49f4c/771ce/postbg.jpg 1424w"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"fixed":{"src":"/static/bf7f9f29887116a6d496e42f356b60db/b3147/thxwelchs.png"}}]}}},"fields":{"layout":"post","slug":"/JPA 양방향 Entity 무한 재귀 문제 해결/"}},"primaryTag":"kotlin"}}}