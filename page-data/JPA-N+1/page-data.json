{"componentChunkName":"component---src-templates-post-tsx","path":"/JPA-N+1/","webpackCompilationHash":"4614e52e856315037400","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA2ElEQVQY02NgAIJIsyLfYJOSTCCTEcT//eu3IAMe8P//f+F///7B2Jhq480LdwVaJbzYsWW/NVBB1t8/fwuAtBcQ6wKxJRBbAbEFEJsCsS8QxwKxAxDbA3EtVN4TiNnABsZ5p+7yMU26v3LtLgOgYPGfP3+TgXQ20BX9QLoOiGcC2dOBdBsQTwHiXJBBQDFnIF0KUgvEnUCsAzYw0KRgVa5F4Z3GnAJhkE1AL2sDaT0gtgNiI6jr7KAudgdiLagYyIU6QKwCNBzkIxWwgWIKFoJ6xibSDFQAAMSLvx5xS4Y5AAAAAElFTkSuQmCC","width":400,"height":90,"src":"/static/8637e594ca86d58e20988ba8c4cfc1e7/647de/thxwelchs-logo-v2.png","srcSet":"/static/8637e594ca86d58e20988ba8c4cfc1e7/647de/thxwelchs-logo-v2.png 1x"}}},"markdownRemark":{"html":"<h1>JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유</h1>\n<ul>\n<li>Kotlin</li>\n<li>SpringBoot(2.2.4)</li>\n<li>querydsl(4.2.1)</li>\n</ul>\n<br/>\n<h1>문제</h1>\n<p>JPA로 쿼리를 하다보면, N + 1 문제를 마주하게 될 수도 있는데요.</p>\n<p>사실 저의 문제는 정확하게 말하면 N+1 문제는 아닙니다. N+1이란\n@OneToMany의 관계에서 One에 해당하는 엔티티를 조회하면 Many의 해당하는 엔티티가 지연로딩 되어 그 갯수만큼 더 조회한다고 하여 One+N(Many) N+1현상이라고 하는데 저의 경우엔 @ManyToOne의 조회인데도 One에 해당하는\n엔티티가 영속성 컨텍스트에 존재하지 않으면 쿼리하게 되는 현상입니다.</p>\n<p>저는 보통  <code class=\"language-text\">@Query</code> 어노테이션에 JPQL 쿼리를 작성해서 해결하곤 했었습니다.</p>\n<p>근데 querydsl에도 fetchJoin이 있다는걸 최근(?)에서야 알고 사용해보려고 하는데 문제가 해결이 되지 않았습니다. 그 이유는.. 참 어처구니가 없었는데요 혹시나 이런 경우를 겪고 있는 분이 계실까 해서 공유차 포스팅합니다.</p>\n<p>이유는 저처럼 join 함수를 잘못 이해하고 사용하면 매개변수 타입에 따라 fetchJoin 함수를 호출하여도 N + 1 문제가 해결이 안될수도 있다는 것인데요 ㅋㅋ</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 241px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4aaedf67b06c9852ae700e6f222a2bbf/b41b4/Untitled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.72199170124482%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAAETElEQVQ4yyWU+1fSdxjH+b92ds7+ju2HnZ1TbbVyZ2WZLl3LsqyZXbTmpRWIIMolQJEERC4JgoBCkhfkooLcxEtlq3XOa4/f/cThA5/n837ez+v9qA7f1clupQlFvKxuJChW1vG9drGUWmB+wcerWScO1xRPhvrpG3iMw2nHYjVitk6gHRtBb1CTyafw+KZY30yiSq+lWEpG2CykSCTDRGNBMtk0OoMWp3uK+cUA/tAcw+ohxi065oKzTFjGmfW70U2MMvXKhjfo4nXEQzwVRhWJhchvp4nEAvJCilDUT0AKmG0m3L4ZYidKF4MYzAZC8pg/7MNkMzL5yo434GEt94atcobSXo7tWhZVda9E/XCLUjVDub5JdietqBozjeGbnyO6FOJt5g3P1MMMa4YIx0OMS3GL3cyoXsvKeoJyI0e+vM7WXh7V5y/HVPfzcpinVM/SeF9kxjMlLY/iCbhJrERxzEwy+GyA7vt3cHqmeWm38ELznDn5vbZfYKu4RrGaJSdFVR8/HVHZz4nkrFK0UF7DYBwV401y0Ywv6GH470FFYVdPF08H+9Hq1HTfuy0FXTSOtgmG3Gzm0ri906g+icL9D0VqR1tUDrZYy68oFwwTOozS2oPH92lrb+FWdyfdPbfpeXCPtmstnDrzg3ShEd+XpZBDKPEpA1U1DuqKD+GYj5WNJXbFh2gixMioWpQNMfh8gNFxLWrdC7SGEZm0AZegdPKYVs7iyXkMJp3YYmOjkEa1nIqLZw7u3L2F+eW4HL7F7rBgGNdjshgFD49M1Ma0IGR1vGRWJuv2zmCdtDAypqGwm6F6WMQ6bWFaeFXV9yu8WU3IRRe71QLBBT8P+3plgiN45maILM3zoL9XUbqykWT5bRy98GcwjzHjdQodmxSKEgbxczkVRbVdKhBfDiupKO8V2NxeRavX8HSgX3wJKN/jqUUWlyNE5X8Ot10B3R/y4RER5XqOKacV9+w05Zpg84XPHLwvKejUj3ZEQYyB4b941PcQq90k/iaJJReFS70y6RM/J8QaryTmpP1SXcgobrCRTVGqCNj/fP4gYG9TrGd4/6nG2ISGi1cu0vu4F51kNRoLsxAPc/vPLtp+b6Xzzk30Rr0kySg51pKQuB28K1IRuGuHO8Lhv8fU5KAoHO6L0vnFOZouNdEqqNjEeH/Qy+uFAP2DfWj0aiWCbp8LnSi92fUH6bUEDbn/P3pS8FgK7krlnUaWkmTRH/LS++g+LW3NDAw9EX9ku0jrk06bMrCIqHXJlJ8M9NEpBU2ydTputGG06lkXhlUfBezKUYkdCXdDFAal4LWOVi78ck757OhslyGJMmnzZLIuj5O+/kdcvtrMmZ9Pc7ntMucu/MTX33wl20eH6vD4gJ1qTpbCqjC1Ietpht/aWyUNV7l+o52Wa1f48fwZmlsv0dpxld+utynJudB0juYrv3K+6Sw9vXf57vtvOXX2NP8B+SQ+C2CoiKEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled.png\"\n        title=\"JPA%20N%201/Untitled.png\"\n        src=\"/static/4aaedf67b06c9852ae700e6f222a2bbf/b41b4/Untitled.png\"\n        srcset=\"/static/4aaedf67b06c9852ae700e6f222a2bbf/b41b4/Untitled.png 241w\"\n        sizes=\"(max-width: 241px) 100vw, 241px\"\n      />\n  </a>\n    </span></p>\n<h1>예제 구성</h1>\n<p>먼저 상황을 설명하기 위해 </p>\n<p>제가 구성한 예제 구성은 다음과 같습니다. </p>\n<p><code class=\"language-text\">Restaurant(식당)</code>과 <code class=\"language-text\">Menu(식당의 메뉴)</code>를 표현하는 다음과 같은 ERD와 엔티티가 있습니다.</p>\n<h2>데이터베이스 ERD</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 280px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.92857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACLUlEQVQoz32Ta4+aUBCG/f8/pUm/NG3TS/rFdNN23dVFQEEEDnKXi9wEEeHtgNt1Nc2e5GQ4yeGZd96ZM1J2KfggwSLKYBR76FkBNUmh7HK0XYd+dRTPn+fzW2uETsF7XceHxROE+WfM5THKWoYYGSibC7CH9UGOU3w3fDw6LgTXhOA5ED0LEzpn9QkjPQmg+BZsin7qw018ZIcd5kGM6gZ4bIFF6OKdquJen4HjPmIy+wJB+IpHNkV0aDASTRsPszmq/jat9lm6HNcoj6crYG/BHy/HcruFzNaIyhLZ8YCqrSHFOYLyiBHnpdC8CIrpQXdJrb2FYXuYesUz/OJbD34Ka6xMC0t5hZLyHehSc+rI95qApPB+7WK1UiAvJRi6Bk3VEVgm7jQfshMOoKpp0bTd8MMnLcUvh5pn++CkNZykQE05pbg6A+/cPWzLgUrQJC9e1PB+Bos63+urTy351w3gsZVj6u8RuC42jCGOIuB0hJlUiCpqipoeoGkGmM5IevsC1NIazX+m5Kdd0M5h2zZVJg2lWwaDGuaIqf7RhLIxtiGohh3NX5blZNYJ6+Rw1ZR/+8cmwzeWDgI4XsCc58FUBVPmU5c7KtkpYHs+RFGEJMuQZYUqOA4m9yW+BvaL25bkYYHpJsSDscXUDDEzA/y2UqQ1KRyTfF1jWIoCBI6DQfLTKKAX02B/NTaX+OZLuSNPeDfB3NkNcUYZpXAPPqyGzt4q7GexfWXB7f4LbQeL2Yk05hsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled1.png\"\n        title=\"JPA%20N%201/Untitled1.png\"\n        src=\"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled1.png\"\n        srcset=\"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled1.png 280w\"\n        sizes=\"(max-width: 280px) 100vw, 280px\"\n      />\n  </a>\n    </span></p>\n<h2>엔티티 ERD</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 251px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b427b48566fd34333afd6904d51cd61d/4f2f1/Untitled2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 203.58565737051794%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled2.png\"\n        title=\"JPA%20N%201/Untitled2.png\"\n        src=\"/static/b427b48566fd34333afd6904d51cd61d/4f2f1/Untitled2.png\"\n        srcset=\"/static/b427b48566fd34333afd6904d51cd61d/4f2f1/Untitled2.png 251w\"\n        sizes=\"(max-width: 251px) 100vw, 251px\"\n      />\n  </a>\n    </span></p>\n<h2>Restaurant 엔티티 코드</h2>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Entity\ndata class Restaurant(\n        var name: String = &quot;&quot;\n): MutableEntity()</code>\n        </deckgo-highlight-code>\n      \n<h2>Menu 엔티티 코드</h2>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Entity\ndata class Menu(\n        @ManyToOne\n        var restaurant: Restaurant,\n        var price: BigDecimal = BigDecimal.ZERO,\n        var name: String = &quot;&quot;\n): MutableEntity()</code>\n        </deckgo-highlight-code>\n      \n<h2>데이터</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 323px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85c053342824f6bf2604fdfa924dd1af/c7ab7/Untitled3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.625386996904027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA7ElEQVQY033PQU/CQBCG4f7/32NMNKJGBUIREAq6QNstu23ZQmILxZNtX7aewcOTOczkmxnHz74RgSSKDR9yx0ga5ipjLQRxknIsS/K8oCguy63j4UCyz+n7Gc4ijJl6c1ahxv1SdL01/dkS1x3hLQQbnRJvd+jEXKSsODUEasvrQuHItECaktBWX+8Z2bDOi8vNQ5dOd8zd84CJXRS0/SS/KrCUKXCquqH1W1WUpx/7ZsJgOGQ68/CDALFcISNtZ2rqpqGur2tzHJUdUVnJxhwQkWHsCW4fezz13rm3l765MyafIXp/YvM3+78zbhRu8BFmec0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled3.png\"\n        title=\"JPA%20N%201/Untitled3.png\"\n        src=\"/static/85c053342824f6bf2604fdfa924dd1af/c7ab7/Untitled3.png\"\n        srcset=\"/static/85c053342824f6bf2604fdfa924dd1af/bc34b/Untitled3.png 293w,\n/static/85c053342824f6bf2604fdfa924dd1af/c7ab7/Untitled3.png 323w\"\n        sizes=\"(max-width: 323px) 100vw, 323px\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 358px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/10da870a8839e8ed23d6f9a223d2c6fc/13038/Untitled4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.27932960893855%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACGklEQVQozzWSW3eiQBCE+f8/aF/2ITm72RiNiYhcFRBQFAWEgHJT8+2AJw99TlFdNVN0j7SKElb2ktX2yHwdIbtbTMvC0HV0Tcd3bfRNzNwJmYUplrUiWLvIXozm7dCCiKWhszkkvGhrJM3ZsjAdNHvLu75mojq8TRXmuoOs2SwMh7ERiPIZKxbPLxPeZxqKs2O+3KAK30xd8vap8jRZIMV5RVq0RGnBZp+SflW4/o5EcD2fir66PeEevviUteEyfRWIXkMyeBsO2YUPWR2CScWlpaw68rIiSrIB99XzQ+9csxSHBekZRdGYzhRxYUgxaJpBmxUVC9XAtD2kMDkTJheCKMfeHNmlF7ZxyYMXFRfIvpjdLmf0LvM8+mBueuxPteiVg97bZ0zEGGTDRaqajrq9UZQXjmk24J6rmiuVwJdLjRkmHIoawzQYTabIiiqSNfx406xANyyWjlhKcCjZxGccsUHD3Q/YF1zPB0eBdxn/zFDMMWc803mdavz+MxbLCB9/diyxt6lYis5kbiG13Y2+6qblS6T8+W67K+1V8HWDc8iIyxrP85nJCkvb5RuEp6O73gffynZwvQBpHRV4Is1qk4insxvSrfcFAx+VuOGJV2uP4ic8/x3z6+mN0cwU7/YkdPngdcKMv+P5I+Htfuf+/U3TNGT514B77oe/dh3rOCc59wk9sc0FymIxpGza7qG53fF9D88P+A9Qx+BIAzoPIwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled4.png\"\n        title=\"JPA%20N%201/Untitled4.png\"\n        src=\"/static/10da870a8839e8ed23d6f9a223d2c6fc/13038/Untitled4.png\"\n        srcset=\"/static/10da870a8839e8ed23d6f9a223d2c6fc/bc34b/Untitled4.png 293w,\n/static/10da870a8839e8ed23d6f9a223d2c6fc/13038/Untitled4.png 358w\"\n        sizes=\"(max-width: 358px) 100vw, 358px\"\n      />\n  </a>\n    </span></p>\n<h2>문제의 코드</h2>\n<p>문제의 코드 입니다. (어떤게 문제인지 바로 아시겠나요?)</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">class MenuRepositoryCustomImpl: MenuRepositoryCustom, QuerydslRepositorySupport(Menu::class.java) {\n    override fun findAllJoinRestaurant(): MutableList&lt;Menu&gt; {\n        val m = QMenu.menu\n        val r = QRestaurant.restaurant\n        return from(m)\n                .leftJoin(r)\n                .on(r.id.eq(m.restaurant.id))\n                .fetchJoin()\n                .fetch()\n    }\n}</code>\n        </deckgo-highlight-code>\n      \n<p>함수 호출을 위해 테스트코드를 작성하고 실행했습니다.\n( 테스트의 결과값 보다는 N+1 쿼리가 수행되는 것을 보기 위함이므로 일단 테스트는 통과하게끔 했습니다. )</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Test\nfun `Menu 만 조회했는데, Restaurant 가 조회되는 N+1 현상 테스트` () {\n    val menus = menuRepository.findAllJoinRestaurant()\n\n    assertTrue(true)\n}</code>\n        </deckgo-highlight-code>\n      \n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 681px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ca29f3317ce1b991208902715823f9f7/e8a1d/idea64_xOWUXfJUQM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.32892804698973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADC0lEQVQ4y4WS6ZaaQBCFeZiMrCI4LLJvIqBGAZdxlkyScd7/FW6qW3SSSc7Jj+/corr7dlU1QpS20IIQiusTHsamj7EeQTdiKJMZZNuDbHlQWP4+w9jOMZmmUBQHI8mCKNuQKGYqyg6EKGsxblKoRQRtHsMIQ0yjGG6YkGkA2fSGywgnhOrRPifC2Eqhm4QekpHFTSXFhpBULYw0xSSJMfFiiIYHyQog6j4kLYA0cSGZDlU4g0Zr6pSqNlyoJhlPCM27VckN82UP20gwM1LE0xIzt0aSVciyEn6YwcwLmEUNx6vgGhmMwUDk7f6r5aSFOqYEuUuyC1G8bFZVm+bENlNO9XCnznBHh77Q2p1kY3Sr6nKWmbFYSPMOCs1K90JougvX9hHRnPQJPYZGbWouLGrVt3wY+gzufQDPCTCl2Yrc0P0DIS1aKNIUluogMF1Elosu97CMXJSeAz9wMItdZIVHD+UiDmzEtkNjuqcOTMiSAXE0uSGU62co2RvUxRnaiqjfYM/foZfv9OrvkAmJYpHFpHJxhpSdIefv9GcwzlDyD4SsPNIvscTIriE6NSSngWI1GN3XuCOYipxLTqQ1xshi8fIvhCTrkYQbJEFLbOHNaoT+mlrbIA1brjHlI8ol9B16S4q/0t4NXKeETT+6YxekF2iGB8yrJyzqF5QEi8vqeeDlFl/zv68Xi0fkixPpB0K+6BHnVOH/KK66veVSij8j9P0LqkWHvOzohg/ysv3/JZ/ghk2zQ788oG72qEgZ9eqAZnVEUV6ML7CLep7L5pfvfIhZnu3hhhUZbQeDZn3kht3+FfuHn+hJd8cf2B1+oN19u8TElrri2r1QnvYcvqOmc6xKgQXb9Ych037/nR9guh8Mmfnx9HYzYsouYZyezlhvH8mQKizrHVbU9qKmlqnaBbHaPNKGp5uuB+2pEmbWrB+w/Hri6yzedM+cf7bM5tftXocKX3mFzIiN4XD6ydtr+2+81W6okFdLY2DzFOZVj5ooqx1YtYxrBVe9xqwiHvPLH26wHOuAefwCLiufqApM+kkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled5.png\"\n        title=\"JPA%20N%201/Untitled5.png\"\n        src=\"/static/ca29f3317ce1b991208902715823f9f7/e8a1d/idea64_xOWUXfJUQM.png\"\n        srcset=\"/static/ca29f3317ce1b991208902715823f9f7/bc34b/idea64_xOWUXfJUQM.png 293w,\n/static/ca29f3317ce1b991208902715823f9f7/da9f0/idea64_xOWUXfJUQM.png 585w,\n/static/ca29f3317ce1b991208902715823f9f7/e8a1d/idea64_xOWUXfJUQM.png 681w\"\n        sizes=\"(max-width: 681px) 100vw, 681px\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/529686da0e8c95478ee8f7bb8c2acff1/9d48f/Untitled6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 4.8233314638250135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAAO0lEQVQI12OwtnX/D8KW1q7/bWw9wNjKBigGxLb2nv9t7UB8N7AaGyjbBqoHxDe3dP6vo2v5X1ffCowBaKciVI5FWuoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled6.png\"\n        title=\"JPA%20N%201/Untitled6.png\"\n        src=\"/static/529686da0e8c95478ee8f7bb8c2acff1/913fc/Untitled6.png\"\n        srcset=\"/static/529686da0e8c95478ee8f7bb8c2acff1/bc34b/Untitled6.png 293w,\n/static/529686da0e8c95478ee8f7bb8c2acff1/da9f0/Untitled6.png 585w,\n/static/529686da0e8c95478ee8f7bb8c2acff1/913fc/Untitled6.png 1170w,\n/static/529686da0e8c95478ee8f7bb8c2acff1/efb0c/Untitled6.png 1755w,\n/static/529686da0e8c95478ee8f7bb8c2acff1/9d48f/Untitled6.png 1783w\"\n        sizes=\"(max-width: 1170px) 100vw, 1170px\"\n      />\n  </a>\n    </span>\n해당 함수를 호출해서 query하면!? N + 1현상이 발생합니다.</p>\n<p>첫번째 쿼리인 menu left outer join restaurant 를 했는데도 불구하고, 밑에 세개의 추가 쿼리가 실행되었습니다.</p>\n<p>왜 이럴까? 하고 querydsl의 <code class=\"language-text\">leftJoin</code> 함수가 정의된 <code class=\"language-text\">JPQLQuery</code> 인터페이스를 추적 해보았습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 460px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7cd075e617306d11657e6ed3c7d8ad5a/700eb/Untitled7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.173913043478265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABWElEQVQoz3VSa3OCMBDMr7E+ICS85aFIUQpqgVq1dqYd+/9/xPaSQsfp2A/L7u1cNpcbmHBWcIKKUMOyHzVL/wnS3fywV8ImVr5w1/CiBlxmGE99TGYBIew50B6bGBG4s4agQzYFu+FWh6nDKsT2Kx3ohrteU898rz1TLHWfcAp9ZmpGYOpj8xSCgg3Cw8TDaOxoKK1uVXwL5Q3+oAcww0xwjk84zDuETgkpcszoElOudMPowf4/+E+twEya7hgfcQg7RF6NINjDpaf6Saf3Z9k5hQV3p7kHNqMJQ5kj5Atw0mOabkaXTM0YhrWkPWX9Gtx+ClfrAaq+Bcs3r8jqC7L2itX+E3l5QlU2aLcvaOoGxe4d+fMV6/YLRf2GYnNGtf1AvbsgL45IFi3SrPsFM60YXKSwnAzcVhORFgkEQcqEfpEF7ZN8xeSZVgKLaiFTrQ1OL+EDx/gGVfEFJhu/nEUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled7.png\"\n        title=\"JPA%20N%201/Untitled7.png\"\n        src=\"/static/7cd075e617306d11657e6ed3c7d8ad5a/700eb/Untitled7.png\"\n        srcset=\"/static/7cd075e617306d11657e6ed3c7d8ad5a/bc34b/Untitled7.png 293w,\n/static/7cd075e617306d11657e6ed3c7d8ad5a/700eb/Untitled7.png 460w\"\n        sizes=\"(max-width: 460px) 100vw, 460px\"\n      />\n  </a>\n    </span></p>\n<p>언뜻 보기에 함수의 주석 설명에는</p>\n<ul>\n<li>주어진 target 매개변수를 기반으로 left join이 생성되어 질 것이고,</li>\n<li>fetchJoin을 사용하기 위해서는 fetchJoin 파라미터를 해당 join 에 추가 (<strong>정확하게는 파라미터로 이해하기보다는, fetch join 할 join 함수 뒤에 fetchJoin 함수를 추가해주면 됩니다.</strong>)</li>\n</ul>\n<p>하라고 되어있습니다. 이렇게만 보면 제 코드에서 <code class=\"language-text\">leftJoin</code> 함수에 매개변수로 넘겨준 target이 restaurant이니 맞는 것 같기도 합니다만 현재 문제에서 안되는 이유를 찾기 위해 코드를 추적하다 querydsl fetchJoin은 다음과 같이 동작하여 JPQLQuery를 생성한다는 것을 알게되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 834px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b1ffa0c14526d6534fbf70eab3e727c2/d5e2e/idea64_G1UvBO54eI.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.02398081534771%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB+0lEQVQ4y5WSW3vSQBCG82cqgbZECKVBICEbciDkRE6Eg1JbngesF970/3/ObkVQKerF+8zsJjP7zUEyrQJdzUWzcQ9F0XCndtFpaZDrKmq1Nmry/yG5XoWht8Y1e8RduINabPEh/YJba4u6+YCG+ZnskcZfkKxxAW0QoqEYuLk10HivQ1YGqCs6+QbZI/wsN/WLSD9Lvu5B1YboMw/eJIfJAvSHHgb6D8jXRz5umhqVplJLOmeRGCm873m4qrchyx0MDB/z5RZpvoEzKYgctpcJn9kzStjDVY36S8Hv5D8RCftUclefoD2wRcI4XSPJPiKerYXPbVps4E1LtNQRlJbxJpLBMpjjksr8BMddY2QlRCwwWPRqT88sJaVzMIo5h+T6JSVMMDRD6ITBQnE+YDmpsCO6N8xA/HN48BySS2Uk8UIMwiaYfVR0ijNdw/aXlDy+nHBEr+fLJ5RhhZCS2+5MBHEYD6YydVI2W7wgLr8J/7SC35Ecv0C2eMIqqlAFJXw/h3dgmmNMD4ysCENaGb42XIVowVsKmZcgozVZRQtEpNAL5uBtmHC1tC6mzRXPhGXCTy4rNKlnafWAVViSwgIp4Th8GK+Y40gMig/kX5CcYIP54wuqfI8826HM9ijKr8jmz8irZyTkp+UeMX0P6FtENsx+JUh34p7b77Nh9ksPOEoDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled8.png\"\n        title=\"JPA%20N%201/Untitled8.png\"\n        src=\"/static/b1ffa0c14526d6534fbf70eab3e727c2/d5e2e/idea64_G1UvBO54eI.png\"\n        srcset=\"/static/b1ffa0c14526d6534fbf70eab3e727c2/bc34b/idea64_G1UvBO54eI.png 293w,\n/static/b1ffa0c14526d6534fbf70eab3e727c2/da9f0/idea64_G1UvBO54eI.png 585w,\n/static/b1ffa0c14526d6534fbf70eab3e727c2/d5e2e/idea64_G1UvBO54eI.png 834w\"\n        sizes=\"(max-width: 834px) 100vw, 834px\"\n      />\n  </a>\n    </span></p>\n<p>디버그 된 변수를 살펴보시면 <code class=\"language-text\">self</code>에 <code class=\"language-text\">JPQLQuery</code>가 텍스트 로 표현되고 있습니다. </p>\n<p>가만살펴보니 뭔가 이상합니다. 흠 네.. 지금껏 멍청하게 target을 잘못 전달하고 있었던 것이었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 708px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/44460dcff0f905267982c0ab1e966588/d1f1a/Untitled9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.69491525423729%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACYElEQVQ4y22UTU5qQRCF79JYBUtwAQ6IYcjUxD2IjkDCRDD+xiggCAFFUSKo8QcURAQVRVDPy1emfQyspNO3u6tPnTpVfb3v729NDuz4+Fivr68ajUb6/PzUcDjUx8eH3t/f7fvt7U3dbleDwcDuZLNZbW5uamNjQ54mzAHe3d3p8fHRvsfjsYEAzLcbLghBb29vNT8/r62tLXkOZJLhy8uLGo2GXXAGIGtGv99Xq9XSzc2N6vW6nafTaS0sLPwwdEDOSO3+/t6Ybm9va25uTplMxvyur681OzurQCCg1dVVXVxc/O5Ho9H/DL++viwN0sHa7bbptLKyounpaa2trenw8FDPz88ql8sKhUKKxWIWGCNttDSGiEwaMOMCYj89PanX61lxHh4eVKvVDBAC+LrgnCMDknDmAYLDZNoAdjodKwzMna6wdpIQmBkygGPMHkz+MgAQHnAcAS8UCjo9PTVWsAcMP4Ax9j2XGqLCAGYUw6XKmUvn4OBAOzs7v5UG0AXEEomEPC5dXl5aFRGbgVaAkxZiwwAQ1gRg5h6grLGTkxPF43F59NJfRvWoMjOpw4J0K5WKzVdXV1Y4ND47O7MeBMsrFovWnK5dcIBds9k0FrChydEKlkiDJIDxSvANBoM6Ojr6AeT90aCpVMpaA504hAVrlzqg6OtejXuiU1NT2t/f1/n5ufl5yWRSy8vLYt7b29Pu7q7y+bxKpZKq1aoxRStA2Kd5YcKr8Pv9ikQixpw9/LxwOKzFxUVzgCng6+vr9ufI5XImNrpRHB4/jHw+n2ZmZiwA7QR70l9aWtI/Qg1LRYcIKpgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled9.png\"\n        title=\"JPA%20N%201/Untitled9.png\"\n        src=\"/static/44460dcff0f905267982c0ab1e966588/d1f1a/Untitled9.png\"\n        srcset=\"/static/44460dcff0f905267982c0ab1e966588/bc34b/Untitled9.png 293w,\n/static/44460dcff0f905267982c0ab1e966588/da9f0/Untitled9.png 585w,\n/static/44460dcff0f905267982c0ab1e966588/d1f1a/Untitled9.png 708w\"\n        sizes=\"(max-width: 708px) 100vw, 708px\"\n      />\n  </a>\n    </span></p>\n<p>fetch Join이 되려면 </p>\n<p>타겟이 restaurant가 아닌 menu의 프로퍼티로 존재하는 menu.restaurant가 되어야 하는것이었습니다.</p>\n<p><br>\n그래서 코드를 다음과 같이 수정하고 해결하였습니다!</p>\n<h2>수정된 코드</h2>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">class MenuRepositoryCustomImpl: MenuRepositoryCustom, QuerydslRepositorySupport(Menu::class.java) {\n    override fun findAllJoinRestaurant(): MutableList&lt;Menu&gt; {\n        val m = QMenu.menu\n        val r = QRestaurant.restaurant\n        return from(m)\n                //.leftJoin(r)\n                .leftJoin(m.restaurant)\n                //.on(r.id.eq(m.restaurant.id)) entity 연관관계 기반으로 어차피 맵핑되서 join함 on 조건을 주면 fetch 할 때 with 에 property를 에\n                .fetchJoin()\n                .fetch()\n    }\n}</code>\n        </deckgo-highlight-code>\n      \n<h2>수정 후 쿼리</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 583px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/35e216d7838ea09162167e1c3dc717aa/a99e1/Untitled10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.6861063464837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADGklEQVQ4y5WT6XLaWBCF9TCJBQJjDGgxBO0rAiEktEFssrhmXLYzmb95gzzBvO6Zvlc4tuMkk/nxVTcNde7pBcGwMihagL44gtqfYnAmQ5tMMJ8oGA3GEMUziCe/j+AFBWZuA+nNDufuAZP0A8bFAbPiGvP4BqfmHt15Q+x+CyGMS+jRFUTrHXrWAbL5EVJwQGdxiTN6QLLe/y8E3cygqj4kau2sM0aHbA+7Q4K10MfJqwd6xCnE14NfIph2DnW6QK93AWVsYzg3odk6LNOBqvg4P3egTCIo8gLDcx2dnkpox/gkl1q4oDaN8Lo7gTTQoMkWevocp7aB8WhOD83Q68/Q77+hXMNJZ/JDREkhQQUC27JGDjs9BV2i0yU6MuUqRppD37lQLhyMZIMwMVasR+izrNqYUN6RZIhdGYLjFtAuIohDmTY9haReQOxRPpjCXjSIkwZhXMF01rDc9AWOn1Fco9tXW0HXr2FYOTxnh9g7wLcq2E4Jx62RpDtkdEI5ET2IEq14Gxm6tcRMX2JupDRDp4DtVfDDSwThFbxgD9ffkWCFYFFwwWx7hU1+hVW6x5Icr+ih9eYt3CDngoadgO3C8WoItpdRMeXFljWHvWrYq28uWO1pq6zG2mWi7Le6teI6Qpq9pRaTZ23wtrhY8kLkKQ919rBuxrwmRHGBfLNHFG15i4yQal6Yccc/WsT3cEFyaVIuOCRQfbhFQ3/BkPLlqsJiyWb6H4LfumjFDGqZ1YWQhlwc/kRFYgUJ5STMXDJB005etPkInUxYww13JJRxUS64oI3V5LAmoX1SoyHRJeWsZdP5mSA593I0119x/fc/iLNbOpmIBDc0w3WD8t0N9iRUU7sxuVssWftbcrnhuEHabpIG3270mBPGMX8Yj+CTUHG4wY5iuaJjZrOk6NGS2El4YU4xO275kcfNP5+tEJKr6j05jLe4XJW4JHc7qqVRjiDY0KFvePt+RDfnp8cxJNzZU9q7XUJI6s9o/viCZnuPbXGPgiiLO1TlJ5TVZ6wpbut7pNVfnKz6hKy8wzJ/zmp7h8XmFv8CfSjNQ8sp3agAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled10.png\"\n        title=\"JPA%20N%201/Untitled10.png\"\n        src=\"/static/35e216d7838ea09162167e1c3dc717aa/a99e1/Untitled10.png\"\n        srcset=\"/static/35e216d7838ea09162167e1c3dc717aa/bc34b/Untitled10.png 293w,\n/static/35e216d7838ea09162167e1c3dc717aa/a99e1/Untitled10.png 583w\"\n        sizes=\"(max-width: 583px) 100vw, 583px\"\n      />\n  </a>\n    </span></p>\n<p>N + 1이 해결 되고 join 쿼리 한번만 수행 되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bb9c707870a618152342643277064f0c/0d03e/Untitled11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 2.262443438914027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAAMElEQVQI12MwNLb7b2Ri/9/E1OG/gRGUbeYIZ5sC2SAazDaHsEF6jIHqQTRIDJkPABrAIN/Y5pM/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled11.png\"\n        title=\"JPA%20N%201/Untitled11.png\"\n        src=\"/static/bb9c707870a618152342643277064f0c/913fc/Untitled11.png\"\n        srcset=\"/static/bb9c707870a618152342643277064f0c/bc34b/Untitled11.png 293w,\n/static/bb9c707870a618152342643277064f0c/da9f0/Untitled11.png 585w,\n/static/bb9c707870a618152342643277064f0c/913fc/Untitled11.png 1170w,\n/static/bb9c707870a618152342643277064f0c/efb0c/Untitled11.png 1755w,\n/static/bb9c707870a618152342643277064f0c/0d03e/Untitled11.png 1768w\"\n        sizes=\"(max-width: 1170px) 100vw, 1170px\"\n      />\n  </a>\n    </span></p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Kotlin"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"SpringBoot(2.2.4)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"querydsl(4.2.1)"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"문제"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"JPA로 쿼리를 하다보면, N + 1 문제를 마주하게 될 수도 있는데요."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"사실 저의 문제는 정확하게 말하면 N+1 문제는 아닙니다. N+1이란\n@OneToMany의 관계에서 One에 해당하는 엔티티를 조회하면 Many의 해당하는 엔티티가 지연로딩 되어 그 갯수만큼 더 조회한다고 하여 One+N(Many) N+1현상이라고 하는데 저의 경우엔 @ManyToOne의 조회인데도 One에 해당하는\n엔티티가 영속성 컨텍스트에 존재하지 않으면 쿼리하게 되는 현상입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"저는 보통  "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Query"}]},{"type":"text","value":" 어노테이션에 JPQL 쿼리를 작성해서 해결하곤 했었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"근데 querydsl에도 fetchJoin이 있다는걸 최근(?)에서야 알고 사용해보려고 하는데 문제가 해결이 되지 않았습니다. 그 이유는.. 참 어처구니가 없었는데요 혹시나 이런 경우를 겪고 있는 분이 계실까 해서 공유차 포스팅합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이유는 저처럼 join 함수를 잘못 이해하고 사용하면 매개변수 타입에 따라 fetchJoin 함수를 호출하여도 N + 1 문제가 해결이 안될수도 있다는 것인데요 ㅋㅋ"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 241px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/4aaedf67b06c9852ae700e6f222a2bbf/b41b4/Untitled.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 86.72199170124482%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAAETElEQVQ4yyWU+1fSdxjH+b92ds7+ju2HnZ1TbbVyZ2WZLl3LsqyZXbTmpRWIIMolQJEERC4JgoBCkhfkooLcxEtlq3XOa4/f/cThA5/n837ez+v9qA7f1clupQlFvKxuJChW1vG9drGUWmB+wcerWScO1xRPhvrpG3iMw2nHYjVitk6gHRtBb1CTyafw+KZY30yiSq+lWEpG2CykSCTDRGNBMtk0OoMWp3uK+cUA/tAcw+ohxi065oKzTFjGmfW70U2MMvXKhjfo4nXEQzwVRhWJhchvp4nEAvJCilDUT0AKmG0m3L4ZYidKF4MYzAZC8pg/7MNkMzL5yo434GEt94atcobSXo7tWhZVda9E/XCLUjVDub5JdietqBozjeGbnyO6FOJt5g3P1MMMa4YIx0OMS3GL3cyoXsvKeoJyI0e+vM7WXh7V5y/HVPfzcpinVM/SeF9kxjMlLY/iCbhJrERxzEwy+GyA7vt3cHqmeWm38ELznDn5vbZfYKu4RrGaJSdFVR8/HVHZz4nkrFK0UF7DYBwV401y0Ywv6GH470FFYVdPF08H+9Hq1HTfuy0FXTSOtgmG3Gzm0ri906g+icL9D0VqR1tUDrZYy68oFwwTOozS2oPH92lrb+FWdyfdPbfpeXCPtmstnDrzg3ShEd+XpZBDKPEpA1U1DuqKD+GYj5WNJXbFh2gixMioWpQNMfh8gNFxLWrdC7SGEZm0AZegdPKYVs7iyXkMJp3YYmOjkEa1nIqLZw7u3L2F+eW4HL7F7rBgGNdjshgFD49M1Ma0IGR1vGRWJuv2zmCdtDAypqGwm6F6WMQ6bWFaeFXV9yu8WU3IRRe71QLBBT8P+3plgiN45maILM3zoL9XUbqykWT5bRy98GcwjzHjdQodmxSKEgbxczkVRbVdKhBfDiupKO8V2NxeRavX8HSgX3wJKN/jqUUWlyNE5X8Ot10B3R/y4RER5XqOKacV9+w05Zpg84XPHLwvKejUj3ZEQYyB4b941PcQq90k/iaJJReFS70y6RM/J8QaryTmpP1SXcgobrCRTVGqCNj/fP4gYG9TrGd4/6nG2ISGi1cu0vu4F51kNRoLsxAPc/vPLtp+b6Xzzk30Rr0kySg51pKQuB28K1IRuGuHO8Lhv8fU5KAoHO6L0vnFOZouNdEqqNjEeH/Qy+uFAP2DfWj0aiWCbp8LnSi92fUH6bUEDbn/P3pS8FgK7krlnUaWkmTRH/LS++g+LW3NDAw9EX9ku0jrk06bMrCIqHXJlJ8M9NEpBU2ydTputGG06lkXhlUfBezKUYkdCXdDFAal4LWOVi78ck757OhslyGJMmnzZLIuj5O+/kdcvtrMmZ9Pc7ntMucu/MTX33wl20eH6vD4gJ1qTpbCqjC1Ietpht/aWyUNV7l+o52Wa1f48fwZmlsv0dpxld+utynJudB0juYrv3K+6Sw9vXf57vtvOXX2NP8B+SQ+C2CoiKEAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled.png","title":"JPA%20N%201/Untitled.png","src":"/static/4aaedf67b06c9852ae700e6f222a2bbf/b41b4/Untitled.png","srcSet":["/static/4aaedf67b06c9852ae700e6f222a2bbf/b41b4/Untitled.png 241w"],"sizes":["(max-width:","241px)","100vw,","241px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"예제 구성"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 상황을 설명하기 위해 "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"제가 구성한 예제 구성은 다음과 같습니다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Restaurant(식당)"}]},{"type":"text","value":"과 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Menu(식당의 메뉴)"}]},{"type":"text","value":"를 표현하는 다음과 같은 ERD와 엔티티가 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"데이터베이스 ERD"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 280px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 58.92857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACLUlEQVQoz32Ta4+aUBCG/f8/pUm/NG3TS/rFdNN23dVFQEEEDnKXi9wEEeHtgNt1Nc2e5GQ4yeGZd96ZM1J2KfggwSLKYBR76FkBNUmh7HK0XYd+dRTPn+fzW2uETsF7XceHxROE+WfM5THKWoYYGSibC7CH9UGOU3w3fDw6LgTXhOA5ED0LEzpn9QkjPQmg+BZsin7qw018ZIcd5kGM6gZ4bIFF6OKdquJen4HjPmIy+wJB+IpHNkV0aDASTRsPszmq/jat9lm6HNcoj6crYG/BHy/HcruFzNaIyhLZ8YCqrSHFOYLyiBHnpdC8CIrpQXdJrb2FYXuYesUz/OJbD34Ka6xMC0t5hZLyHehSc+rI95qApPB+7WK1UiAvJRi6Bk3VEVgm7jQfshMOoKpp0bTd8MMnLcUvh5pn++CkNZykQE05pbg6A+/cPWzLgUrQJC9e1PB+Bos63+urTy351w3gsZVj6u8RuC42jCGOIuB0hJlUiCpqipoeoGkGmM5IevsC1NIazX+m5Kdd0M5h2zZVJg2lWwaDGuaIqf7RhLIxtiGohh3NX5blZNYJ6+Rw1ZR/+8cmwzeWDgI4XsCc58FUBVPmU5c7KtkpYHs+RFGEJMuQZYUqOA4m9yW+BvaL25bkYYHpJsSDscXUDDEzA/y2UqQ1KRyTfF1jWIoCBI6DQfLTKKAX02B/NTaX+OZLuSNPeDfB3NkNcUYZpXAPPqyGzt4q7GexfWXB7f4LbQeL2Yk05hsAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled1.png","title":"JPA%20N%201/Untitled1.png","src":"/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled1.png","srcSet":["/static/0458039850fbca4e9e1332d4825576ee/b8b05/Untitled1.png 280w"],"sizes":["(max-width:","280px)","100vw,","280px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"엔티티 ERD"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 251px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/b427b48566fd34333afd6904d51cd61d/4f2f1/Untitled2.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 203.58565737051794%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled2.png","title":"JPA%20N%201/Untitled2.png","src":"/static/b427b48566fd34333afd6904d51cd61d/4f2f1/Untitled2.png","srcSet":["/static/b427b48566fd34333afd6904d51cd61d/4f2f1/Untitled2.png 251w"],"sizes":["(max-width:","251px)","100vw,","251px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Restaurant 엔티티 코드"}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Entity\ndata class Restaurant(\n        var name: String = \"\"\n): MutableEntity()"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Menu 엔티티 코드"}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Entity\ndata class Menu(\n        @ManyToOne\n        var restaurant: Restaurant,\n        var price: BigDecimal = BigDecimal.ZERO,\n        var name: String = \"\"\n): MutableEntity()"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"데이터"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 323px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/85c053342824f6bf2604fdfa924dd1af/c7ab7/Untitled3.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 26.625386996904027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA7ElEQVQY033PQU/CQBCG4f7/32NMNKJGBUIREAq6QNstu23ZQmILxZNtX7aewcOTOczkmxnHz74RgSSKDR9yx0ga5ipjLQRxknIsS/K8oCguy63j4UCyz+n7Gc4ijJl6c1ahxv1SdL01/dkS1x3hLQQbnRJvd+jEXKSsODUEasvrQuHItECaktBWX+8Z2bDOi8vNQ5dOd8zd84CJXRS0/SS/KrCUKXCquqH1W1WUpx/7ZsJgOGQ68/CDALFcISNtZ2rqpqGur2tzHJUdUVnJxhwQkWHsCW4fezz13rm3l765MyafIXp/YvM3+78zbhRu8BFmec0AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled3.png","title":"JPA%20N%201/Untitled3.png","src":"/static/85c053342824f6bf2604fdfa924dd1af/c7ab7/Untitled3.png","srcSet":["/static/85c053342824f6bf2604fdfa924dd1af/bc34b/Untitled3.png 293w","/static/85c053342824f6bf2604fdfa924dd1af/c7ab7/Untitled3.png 323w"],"sizes":["(max-width:","323px)","100vw,","323px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 358px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/10da870a8839e8ed23d6f9a223d2c6fc/13038/Untitled4.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 50.27932960893855%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACGklEQVQozzWSW3eiQBCE+f8/aF/2ITm72RiNiYhcFRBQFAWEgHJT8+2AJw99TlFdNVN0j7SKElb2ktX2yHwdIbtbTMvC0HV0Tcd3bfRNzNwJmYUplrUiWLvIXozm7dCCiKWhszkkvGhrJM3ZsjAdNHvLu75mojq8TRXmuoOs2SwMh7ERiPIZKxbPLxPeZxqKs2O+3KAK30xd8vap8jRZIMV5RVq0RGnBZp+SflW4/o5EcD2fir66PeEevviUteEyfRWIXkMyeBsO2YUPWR2CScWlpaw68rIiSrIB99XzQ+9csxSHBekZRdGYzhRxYUgxaJpBmxUVC9XAtD2kMDkTJheCKMfeHNmlF7ZxyYMXFRfIvpjdLmf0LvM8+mBueuxPteiVg97bZ0zEGGTDRaqajrq9UZQXjmk24J6rmiuVwJdLjRkmHIoawzQYTabIiiqSNfx406xANyyWjlhKcCjZxGccsUHD3Q/YF1zPB0eBdxn/zFDMMWc803mdavz+MxbLCB9/diyxt6lYis5kbiG13Y2+6qblS6T8+W67K+1V8HWDc8iIyxrP85nJCkvb5RuEp6O73gffynZwvQBpHRV4Is1qk4insxvSrfcFAx+VuOGJV2uP4ic8/x3z6+mN0cwU7/YkdPngdcKMv+P5I+Htfuf+/U3TNGT514B77oe/dh3rOCc59wk9sc0FymIxpGza7qG53fF9D88P+A9Qx+BIAzoPIwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled4.png","title":"JPA%20N%201/Untitled4.png","src":"/static/10da870a8839e8ed23d6f9a223d2c6fc/13038/Untitled4.png","srcSet":["/static/10da870a8839e8ed23d6f9a223d2c6fc/bc34b/Untitled4.png 293w","/static/10da870a8839e8ed23d6f9a223d2c6fc/13038/Untitled4.png 358w"],"sizes":["(max-width:","358px)","100vw,","358px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"문제의 코드"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"문제의 코드 입니다. (어떤게 문제인지 바로 아시겠나요?)"}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"class MenuRepositoryCustomImpl: MenuRepositoryCustom, QuerydslRepositorySupport(Menu::class.java) {\n    override fun findAllJoinRestaurant(): MutableList<Menu> {\n        val m = QMenu.menu\n        val r = QRestaurant.restaurant\n        return from(m)\n                .leftJoin(r)\n                .on(r.id.eq(m.restaurant.id))\n                .fetchJoin()\n                .fetch()\n    }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"함수 호출을 위해 테스트코드를 작성하고 실행했습니다.\n( 테스트의 결과값 보다는 N+1 쿼리가 수행되는 것을 보기 위함이므로 일단 테스트는 통과하게끔 했습니다. )"}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Test\nfun `Menu 만 조회했는데, Restaurant 가 조회되는 N+1 현상 테스트` () {\n    val menus = menuRepository.findAllJoinRestaurant()\n\n    assertTrue(true)\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 681px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/ca29f3317ce1b991208902715823f9f7/e8a1d/idea64_xOWUXfJUQM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 96.32892804698973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADC0lEQVQ4y4WS6ZaaQBCFeZiMrCI4LLJvIqBGAZdxlkyScd7/FW6qW3SSSc7Jj+/corr7dlU1QpS20IIQiusTHsamj7EeQTdiKJMZZNuDbHlQWP4+w9jOMZmmUBQHI8mCKNuQKGYqyg6EKGsxblKoRQRtHsMIQ0yjGG6YkGkA2fSGywgnhOrRPifC2Eqhm4QekpHFTSXFhpBULYw0xSSJMfFiiIYHyQog6j4kLYA0cSGZDlU4g0Zr6pSqNlyoJhlPCM27VckN82UP20gwM1LE0xIzt0aSVciyEn6YwcwLmEUNx6vgGhmMwUDk7f6r5aSFOqYEuUuyC1G8bFZVm+bENlNO9XCnznBHh77Q2p1kY3Sr6nKWmbFYSPMOCs1K90JougvX9hHRnPQJPYZGbWouLGrVt3wY+gzufQDPCTCl2Yrc0P0DIS1aKNIUluogMF1Elosu97CMXJSeAz9wMItdZIVHD+UiDmzEtkNjuqcOTMiSAXE0uSGU62co2RvUxRnaiqjfYM/foZfv9OrvkAmJYpHFpHJxhpSdIefv9GcwzlDyD4SsPNIvscTIriE6NSSngWI1GN3XuCOYipxLTqQ1xshi8fIvhCTrkYQbJEFLbOHNaoT+mlrbIA1brjHlI8ol9B16S4q/0t4NXKeETT+6YxekF2iGB8yrJyzqF5QEi8vqeeDlFl/zv68Xi0fkixPpB0K+6BHnVOH/KK66veVSij8j9P0LqkWHvOzohg/ysv3/JZ/ghk2zQ788oG72qEgZ9eqAZnVEUV6ML7CLep7L5pfvfIhZnu3hhhUZbQeDZn3kht3+FfuHn+hJd8cf2B1+oN19u8TElrri2r1QnvYcvqOmc6xKgQXb9Ych037/nR9guh8Mmfnx9HYzYsouYZyezlhvH8mQKizrHVbU9qKmlqnaBbHaPNKGp5uuB+2pEmbWrB+w/Hri6yzedM+cf7bM5tftXocKX3mFzIiN4XD6ydtr+2+81W6okFdLY2DzFOZVj5ooqx1YtYxrBVe9xqwiHvPLH26wHOuAefwCLiufqApM+kkAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled5.png","title":"JPA%20N%201/Untitled5.png","src":"/static/ca29f3317ce1b991208902715823f9f7/e8a1d/idea64_xOWUXfJUQM.png","srcSet":["/static/ca29f3317ce1b991208902715823f9f7/bc34b/idea64_xOWUXfJUQM.png 293w","/static/ca29f3317ce1b991208902715823f9f7/da9f0/idea64_xOWUXfJUQM.png 585w","/static/ca29f3317ce1b991208902715823f9f7/e8a1d/idea64_xOWUXfJUQM.png 681w"],"sizes":["(max-width:","681px)","100vw,","681px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/529686da0e8c95478ee8f7bb8c2acff1/9d48f/Untitled6.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 4.8233314638250135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAAO0lEQVQI12OwtnX/D8KW1q7/bWw9wNjKBigGxLb2nv9t7UB8N7AaGyjbBqoHxDe3dP6vo2v5X1ffCowBaKciVI5FWuoAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled6.png","title":"JPA%20N%201/Untitled6.png","src":"/static/529686da0e8c95478ee8f7bb8c2acff1/913fc/Untitled6.png","srcSet":["/static/529686da0e8c95478ee8f7bb8c2acff1/bc34b/Untitled6.png 293w","/static/529686da0e8c95478ee8f7bb8c2acff1/da9f0/Untitled6.png 585w","/static/529686da0e8c95478ee8f7bb8c2acff1/913fc/Untitled6.png 1170w","/static/529686da0e8c95478ee8f7bb8c2acff1/efb0c/Untitled6.png 1755w","/static/529686da0e8c95478ee8f7bb8c2acff1/9d48f/Untitled6.png 1783w"],"sizes":["(max-width:","1170px)","100vw,","1170px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n해당 함수를 호출해서 query하면!? N + 1현상이 발생합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"첫번째 쿼리인 menu left outer join restaurant 를 했는데도 불구하고, 밑에 세개의 추가 쿼리가 실행되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"왜 이럴까? 하고 querydsl의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"leftJoin"}]},{"type":"text","value":" 함수가 정의된 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"JPQLQuery"}]},{"type":"text","value":" 인터페이스를 추적 해보았습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 460px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/7cd075e617306d11657e6ed3c7d8ad5a/700eb/Untitled7.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 42.173913043478265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABWElEQVQoz3VSa3OCMBDMr7E+ICS85aFIUQpqgVq1dqYd+/9/xPaSQsfp2A/L7u1cNpcbmHBWcIKKUMOyHzVL/wnS3fywV8ImVr5w1/CiBlxmGE99TGYBIew50B6bGBG4s4agQzYFu+FWh6nDKsT2Kx3ohrteU898rz1TLHWfcAp9ZmpGYOpj8xSCgg3Cw8TDaOxoKK1uVXwL5Q3+oAcww0xwjk84zDuETgkpcszoElOudMPowf4/+E+twEya7hgfcQg7RF6NINjDpaf6Saf3Z9k5hQV3p7kHNqMJQ5kj5Atw0mOabkaXTM0YhrWkPWX9Gtx+ClfrAaq+Bcs3r8jqC7L2itX+E3l5QlU2aLcvaOoGxe4d+fMV6/YLRf2GYnNGtf1AvbsgL45IFi3SrPsFM60YXKSwnAzcVhORFgkEQcqEfpEF7ZN8xeSZVgKLaiFTrQ1OL+EDx/gGVfEFJhu/nEUAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled7.png","title":"JPA%20N%201/Untitled7.png","src":"/static/7cd075e617306d11657e6ed3c7d8ad5a/700eb/Untitled7.png","srcSet":["/static/7cd075e617306d11657e6ed3c7d8ad5a/bc34b/Untitled7.png 293w","/static/7cd075e617306d11657e6ed3c7d8ad5a/700eb/Untitled7.png 460w"],"sizes":["(max-width:","460px)","100vw,","460px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"언뜻 보기에 함수의 주석 설명에는"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"주어진 target 매개변수를 기반으로 left join이 생성되어 질 것이고,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"fetchJoin을 사용하기 위해서는 fetchJoin 파라미터를 해당 join 에 추가 ("},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"정확하게는 파라미터로 이해하기보다는, fetch join 할 join 함수 뒤에 fetchJoin 함수를 추가해주면 됩니다."}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"하라고 되어있습니다. 이렇게만 보면 제 코드에서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"leftJoin"}]},{"type":"text","value":" 함수에 매개변수로 넘겨준 target이 restaurant이니 맞는 것 같기도 합니다만 현재 문제에서 안되는 이유를 찾기 위해 코드를 추적하다 querydsl fetchJoin은 다음과 같이 동작하여 JPQLQuery를 생성한다는 것을 알게되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 834px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/b1ffa0c14526d6534fbf70eab3e727c2/d5e2e/idea64_G1UvBO54eI.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 70.02398081534771%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB+0lEQVQ4y5WSW3vSQBCG82cqgbZECKVBICEbciDkRE6Eg1JbngesF970/3/ObkVQKerF+8zsJjP7zUEyrQJdzUWzcQ9F0XCndtFpaZDrKmq1Nmry/yG5XoWht8Y1e8RduINabPEh/YJba4u6+YCG+ZnskcZfkKxxAW0QoqEYuLk10HivQ1YGqCs6+QbZI/wsN/WLSD9Lvu5B1YboMw/eJIfJAvSHHgb6D8jXRz5umhqVplJLOmeRGCm873m4qrchyx0MDB/z5RZpvoEzKYgctpcJn9kzStjDVY36S8Hv5D8RCftUclefoD2wRcI4XSPJPiKerYXPbVps4E1LtNQRlJbxJpLBMpjjksr8BMddY2QlRCwwWPRqT88sJaVzMIo5h+T6JSVMMDRD6ITBQnE+YDmpsCO6N8xA/HN48BySS2Uk8UIMwiaYfVR0ijNdw/aXlDy+nHBEr+fLJ5RhhZCS2+5MBHEYD6YydVI2W7wgLr8J/7SC35Ecv0C2eMIqqlAFJXw/h3dgmmNMD4ysCENaGb42XIVowVsKmZcgozVZRQtEpNAL5uBtmHC1tC6mzRXPhGXCTy4rNKlnafWAVViSwgIp4Th8GK+Y40gMig/kX5CcYIP54wuqfI8826HM9ijKr8jmz8irZyTkp+UeMX0P6FtENsx+JUh34p7b77Nh9ksPOEoDAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled8.png","title":"JPA%20N%201/Untitled8.png","src":"/static/b1ffa0c14526d6534fbf70eab3e727c2/d5e2e/idea64_G1UvBO54eI.png","srcSet":["/static/b1ffa0c14526d6534fbf70eab3e727c2/bc34b/idea64_G1UvBO54eI.png 293w","/static/b1ffa0c14526d6534fbf70eab3e727c2/da9f0/idea64_G1UvBO54eI.png 585w","/static/b1ffa0c14526d6534fbf70eab3e727c2/d5e2e/idea64_G1UvBO54eI.png 834w"],"sizes":["(max-width:","834px)","100vw,","834px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"디버그 된 변수를 살펴보시면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"self"}]},{"type":"text","value":"에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"JPQLQuery"}]},{"type":"text","value":"가 텍스트 로 표현되고 있습니다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"가만살펴보니 뭔가 이상합니다. 흠 네.. 지금껏 멍청하게 target을 잘못 전달하고 있었던 것이었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 708px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/44460dcff0f905267982c0ab1e966588/d1f1a/Untitled9.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 76.69491525423729%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACYElEQVQ4y22UTU5qQRCF79JYBUtwAQ6IYcjUxD2IjkDCRDD+xiggCAFFUSKo8QcURAQVRVDPy1emfQyspNO3u6tPnTpVfb3v729NDuz4+Fivr68ajUb6/PzUcDjUx8eH3t/f7fvt7U3dbleDwcDuZLNZbW5uamNjQ54mzAHe3d3p8fHRvsfjsYEAzLcbLghBb29vNT8/r62tLXkOZJLhy8uLGo2GXXAGIGtGv99Xq9XSzc2N6vW6nafTaS0sLPwwdEDOSO3+/t6Ybm9va25uTplMxvyur681OzurQCCg1dVVXVxc/O5Ho9H/DL++viwN0sHa7bbptLKyounpaa2trenw8FDPz88ql8sKhUKKxWIWGCNttDSGiEwaMOMCYj89PanX61lxHh4eVKvVDBAC+LrgnCMDknDmAYLDZNoAdjodKwzMna6wdpIQmBkygGPMHkz+MgAQHnAcAS8UCjo9PTVWsAcMP4Ax9j2XGqLCAGYUw6XKmUvn4OBAOzs7v5UG0AXEEomEPC5dXl5aFRGbgVaAkxZiwwAQ1gRg5h6grLGTkxPF43F59NJfRvWoMjOpw4J0K5WKzVdXV1Y4ND47O7MeBMsrFovWnK5dcIBds9k0FrChydEKlkiDJIDxSvANBoM6Ojr6AeT90aCpVMpaA504hAVrlzqg6OtejXuiU1NT2t/f1/n5ufl5yWRSy8vLYt7b29Pu7q7y+bxKpZKq1aoxRStA2Kd5YcKr8Pv9ikQixpw9/LxwOKzFxUVzgCng6+vr9ufI5XImNrpRHB4/jHw+n2ZmZiwA7QR70l9aWtI/Qg1LRYcIKpgAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled9.png","title":"JPA%20N%201/Untitled9.png","src":"/static/44460dcff0f905267982c0ab1e966588/d1f1a/Untitled9.png","srcSet":["/static/44460dcff0f905267982c0ab1e966588/bc34b/Untitled9.png 293w","/static/44460dcff0f905267982c0ab1e966588/da9f0/Untitled9.png 585w","/static/44460dcff0f905267982c0ab1e966588/d1f1a/Untitled9.png 708w"],"sizes":["(max-width:","708px)","100vw,","708px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"fetch Join이 되려면 "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"타겟이 restaurant가 아닌 menu의 프로퍼티로 존재하는 menu.restaurant가 되어야 하는것이었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n그래서 코드를 다음과 같이 수정하고 해결하였습니다!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"수정된 코드"}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"class MenuRepositoryCustomImpl: MenuRepositoryCustom, QuerydslRepositorySupport(Menu::class.java) {\n    override fun findAllJoinRestaurant(): MutableList<Menu> {\n        val m = QMenu.menu\n        val r = QRestaurant.restaurant\n        return from(m)\n                //.leftJoin(r)\n                .leftJoin(m.restaurant)\n                //.on(r.id.eq(m.restaurant.id)) entity 연관관계 기반으로 어차피 맵핑되서 join함 on 조건을 주면 fetch 할 때 with 에 property를 에\n                .fetchJoin()\n                .fetch()\n    }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"수정 후 쿼리"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 583px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/35e216d7838ea09162167e1c3dc717aa/a99e1/Untitled10.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 100.6861063464837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADGklEQVQ4y5WT6XLaWBCF9TCJBQJjDGgxBO0rAiEktEFssrhmXLYzmb95gzzBvO6Zvlc4tuMkk/nxVTcNde7pBcGwMihagL44gtqfYnAmQ5tMMJ8oGA3GEMUziCe/j+AFBWZuA+nNDufuAZP0A8bFAbPiGvP4BqfmHt15Q+x+CyGMS+jRFUTrHXrWAbL5EVJwQGdxiTN6QLLe/y8E3cygqj4kau2sM0aHbA+7Q4K10MfJqwd6xCnE14NfIph2DnW6QK93AWVsYzg3odk6LNOBqvg4P3egTCIo8gLDcx2dnkpox/gkl1q4oDaN8Lo7gTTQoMkWevocp7aB8WhOD83Q68/Q77+hXMNJZ/JDREkhQQUC27JGDjs9BV2i0yU6MuUqRppD37lQLhyMZIMwMVasR+izrNqYUN6RZIhdGYLjFtAuIohDmTY9haReQOxRPpjCXjSIkwZhXMF01rDc9AWOn1Fco9tXW0HXr2FYOTxnh9g7wLcq2E4Jx62RpDtkdEI5ET2IEq14Gxm6tcRMX2JupDRDp4DtVfDDSwThFbxgD9ffkWCFYFFwwWx7hU1+hVW6x5Icr+ih9eYt3CDngoadgO3C8WoItpdRMeXFljWHvWrYq28uWO1pq6zG2mWi7Le6teI6Qpq9pRaTZ23wtrhY8kLkKQ919rBuxrwmRHGBfLNHFG15i4yQal6Yccc/WsT3cEFyaVIuOCRQfbhFQ3/BkPLlqsJiyWb6H4LfumjFDGqZ1YWQhlwc/kRFYgUJ5STMXDJB005etPkInUxYww13JJRxUS64oI3V5LAmoX1SoyHRJeWsZdP5mSA593I0119x/fc/iLNbOpmIBDc0w3WD8t0N9iRUU7sxuVssWftbcrnhuEHabpIG3270mBPGMX8Yj+CTUHG4wY5iuaJjZrOk6NGS2El4YU4xO275kcfNP5+tEJKr6j05jLe4XJW4JHc7qqVRjiDY0KFvePt+RDfnp8cxJNzZU9q7XUJI6s9o/viCZnuPbXGPgiiLO1TlJ5TVZ6wpbut7pNVfnKz6hKy8wzJ/zmp7h8XmFv8CfSjNQ8sp3agAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled10.png","title":"JPA%20N%201/Untitled10.png","src":"/static/35e216d7838ea09162167e1c3dc717aa/a99e1/Untitled10.png","srcSet":["/static/35e216d7838ea09162167e1c3dc717aa/bc34b/Untitled10.png 293w","/static/35e216d7838ea09162167e1c3dc717aa/a99e1/Untitled10.png 583w"],"sizes":["(max-width:","583px)","100vw,","583px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"N + 1이 해결 되고 join 쿼리 한번만 수행 되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/bb9c707870a618152342643277064f0c/0d03e/Untitled11.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 2.262443438914027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAAMElEQVQI12MwNLb7b2Ri/9/E1OG/gRGUbeYIZ5sC2SAazDaHsEF6jIHqQTRIDJkPABrAIN/Y5pM/AAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled11.png","title":"JPA%20N%201/Untitled11.png","src":"/static/bb9c707870a618152342643277064f0c/913fc/Untitled11.png","srcSet":["/static/bb9c707870a618152342643277064f0c/bc34b/Untitled11.png 293w","/static/bb9c707870a618152342643277064f0c/da9f0/Untitled11.png 585w","/static/bb9c707870a618152342643277064f0c/913fc/Untitled11.png 1170w","/static/bb9c707870a618152342643277064f0c/efb0c/Untitled11.png 1755w","/static/bb9c707870a618152342643277064f0c/0d03e/Untitled11.png 1768w"],"sizes":["(max-width:","1170px)","100vw,","1170px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]}],"data":{"quirksMode":false}},"excerpt":"JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유 Kotlin SpringBoot(2.2.4) querydsl(4.2.1) 문제 JPA로 쿼리를 하다보면, N +…","timeToRead":4,"frontmatter":{"title":"JPA N+1현상 삽질","userDate":"24 February 2020","date":"2020-02-24T02:08:55.000Z","tags":["springboot","jpa","N+1","fetch join"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeJedEA//8QAFhABAQEAAAAAAAAAAAAAAAAAASAx/9oACAEBAAEFAjUJ/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAACAx/9oACAEBAAY/Air/AP/EABoQAQACAwEAAAAAAAAAAAAAAAEAEBEhUYH/2gAIAQEAAT8hI7ODsMaz8ojX/9oADAMBAAIAAwAAABDrz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQADAAMAAAAAAAAAAAAAAAEAETEQUbH/2gAIAQEAAT8QBAtqLqWMH0I9jvBKbHZ//9k=","aspectRatio":1.78,"src":"/static/7addc8c3b7e92bb4253ac9a7ce3c174d/771ce/JPA-N%2B1-postbg.jpg","srcSet":"/static/7addc8c3b7e92bb4253ac9a7ce3c174d/f8f18/JPA-N%2B1-postbg.jpg 930w,\n/static/7addc8c3b7e92bb4253ac9a7ce3c174d/771ce/JPA-N%2B1-postbg.jpg 1424w","sizes":"(max-width: 1424px) 100vw, 1424px"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEr0lEQVQ4y2NggIKK7GoGXRVJhv///4P54bY+WaXlRdEeOa4TdNS0V8krGa8P9J/UWFbZ4WFv6V0SFuArAFIXGhLB0FXQwIAV2Jg6MIFoBRNdRVsV6/9JniEvTaNSfyjInPxvK7j8f4xi239T3fp3egq2/8vjM6NAatMCEliwGjajZRaDv04wM4jtrOs2P9U67+x+qy33QrU2vVBSO7S2XG/x4cUOnXsrHHZtMpKMuJtll3QF6BtWkPqJld2YBvp7B4JpkJdV+VRuFKrmnD3mf/lsqFrHHxEe1pO+Hq4v8/ML/jc11u3LsEi/4qPo9L++oNgEpKcsJpsJw0Af3yiYgcwSogrnerQ6/h/WWPS807xsuZ2Gw/e8nNxfhYVF/xuSai9HSKS8t1dx+d9T2AA2sDSmENPA8NA0MN32/z+LmYzu6SqbuZ86rPb/r3HsWFZdU/KiorLyf1F63us5Lv2bbBTT//uY+//fUrfAFKSnr7AVm4EFcBeqiBtcjNFd8z9G/+H/CPnO/7kZqd+trWz/VyVl17TLd9zUDYz7Zeds+785pNUMpKcQmwsDIzMgBi78z8znoHGhyLD5/1OtQ1Vplmn7CjPz/rt6e76rtI7PyzPtui6nm3tVXc/sf05WLdjA+IRcTANdA4MhBtr+Z5Z3VLxgaFLzP1O6aXNLTsm5jNzs/xVlpZ9zLeKPGmo1XlBWqr7j6OT9Jy4uFWxgZEQ8poEyHgpg2uS/PZO+n86ZILGS//nCxQ8bM4vPhsZF/k/2iPw9wbZ2j65d/vTgoII+f7+QN3HhcZYgPbGRWAx09vaHhSGjvLjGzUwpvyX14SUH6xpqv0elxvxvC6j+H6q44Jm20aQ91lZx+1zNHd5Oq5qsA9LTWtiAaaCNtTMkgR9axSrEKXY6ISz5Qlld3Z/8rKL/ubGpf/1tGn7JaU36q6ux5aG8QvF7X22Pdy8OXJcE6ZnVMoURw0ALdWMYk8VIVe9kdV3r//KK2v+lBcV/Yy3jfomoe/43WK78USAg5LM4S9b/UsP0k8tvL+IHJ7XaekwDTfVswTQbrySHgarRzpacluM9nf0/M7PS/peY5/7fYbr0W2FUwnO3YufXztK+L9P0o/f3Hl4MLiAq86owDbR18IGFIRMnp8A1e2G3/42GNf+nerf+azKo/L9VfdbnjQazf2zXm3t5uVH/A1kx+a8p0akqID0RfhGYBmoo6IFpMV5BdiN1m63u5kl7M1X7HocrTP1fplP3f53N7JdLbCe9mWvec6NULuOLm7Hn1+bWLnmQnvzEAkwD9XQhXj6ySotZWcXzsJxK01d72xWXC4w2/W+LXvyyNb/nXU1q++95gZP21esXXnIy9PrmFRUBNtDXMwTTQHcvSLL5/G8uq4CwzkNZqa7/sjobPmVpzXtZbjcJmCt6vrQkTP61zHrx73na3f81JNT/xxVmK4H0REXEYRqYmprA4OgQD5YICgxs8fJI+KpvlHkhwqz8dIZF0cUKj5rzi9wnXS5wr7mbEZjxP9DDZ3H0nhXg8jM5MQ17ib148RQ4u7o2Mzg41HW5vaPJAQtL3SPGxlpHzewM99m7WexwD3bNganLLslHMQMA1vLffALEkU8AAAAASUVORK5CYII=","width":151,"height":151,"src":"/static/bf7f9f29887116a6d496e42f356b60db/b3147/thxwelchs.png","srcSet":"/static/bf7f9f29887116a6d496e42f356b60db/b3147/thxwelchs.png 1x"}}]}}}},"relatedPosts":{"totalCount":1,"edges":[{"node":{"id":"1e550767-421d-58d0-a737-033120344502","timeToRead":4,"excerpt":"JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유 Kotlin SpringBoot(2.2.4) querydsl(4.2.1) 문제 JPA로 쿼리를 하다보면, N +…","frontmatter":{"title":"JPA N+1현상 삽질"},"fields":{"slug":"/JPA-N+1/"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/JPA-N+1/","prev":{"excerpt":"안녕하세요 이번에는 React로 프론트엔드 개발할 때 Visual Studio Code + Debugger for Chrome…","timeToRead":4,"frontmatter":{"title":"React debugging 하기","tags":["react","deubg"],"date":"2020-02-11T23:33:04.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.78,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHcXRIr/8QAFhABAQEAAAAAAAAAAAAAAAAAAQIg/9oACAEBAAEFArUkXP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAQUAAAAAAAAAAAAAAAAAAAEgISIx/9oACAEBAAY/Aq6JDf/EABoQAQABBQAAAAAAAAAAAAAAAAExABEgIWH/2gAIAQEAAT8hSIvSSkb5j//aAAwDAQACAAMAAAAQeA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAWEQADAAAAAAAAAAAAAAAAAAAQESH/2gAIAQIBAT8QVH//xAAbEAEBAAEFAAAAAAAAAAAAAAABERAAITFBUf/aAAgBAQABPxDqIwS6RM1F3ZeZAOCY/9k=","sizes":"(max-width: 1424px) 100vw, 1424px","src":"/static/3e6b6a2f984747d9cc583f58840faa5e/771ce/react-debug-postbg.jpg","srcSet":"/static/3e6b6a2f984747d9cc583f58840faa5e/f8f18/react-debug-postbg.jpg 930w,\n/static/3e6b6a2f984747d9cc583f58840faa5e/771ce/react-debug-postbg.jpg 1424w"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"fixed":{"src":"/static/bf7f9f29887116a6d496e42f356b60db/b3147/thxwelchs.png"}}]}}},"fields":{"layout":"post","slug":"/react-debug/"}},"next":{"excerpt":"Spring 다형성, 상속성을 이용한 중복코드 줄여보기 스프링부트를 활용하면 상당 부분 설정이 편리해진 부분이 있었지만, 흔한 MVC 패턴에서(물론 실제 개발은 MVVM…","timeToRead":6,"frontmatter":{"title":"Spring 중복코드 줄여보기","tags":["java","kotlin","spring","다형성","상속성"],"date":"2020-02-25T12:51:55.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.78,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHFYmSoB//EABcQAAMBAAAAAAAAAAAAAAAAAAECESD/2gAIAQEAAQUCUUskGP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwIq/wD/xAAXEAEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAEBAAE/IYBZgqF4Z5//2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAIDAQAAAAAAAAAAAAAAAQAxEBEhgf/aAAgBAQABPxAHQF6rRE2vutcPbjeFI3P/2Q==","sizes":"(max-width: 1424px) 100vw, 1424px","src":"/static/a35a8e884b14f74b53a5eaa0d438e2f3/771ce/SPRING-DUPLICATION-postbg.jpg","srcSet":"/static/a35a8e884b14f74b53a5eaa0d438e2f3/f8f18/SPRING-DUPLICATION-postbg.jpg 930w,\n/static/a35a8e884b14f74b53a5eaa0d438e2f3/771ce/SPRING-DUPLICATION-postbg.jpg 1424w"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"fixed":{"src":"/static/bf7f9f29887116a6d496e42f356b60db/b3147/thxwelchs.png"}}]}}},"fields":{"layout":"post","slug":"/SPRING-DUPLICATION/"}},"primaryTag":"springboot"}}}