{"componentChunkName":"component---src-templates-post-tsx","path":"/JPA-N+1/","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDklEQVQY003QwUoCURiG4WOExAQVuapFkUFg2cbIKDQMLY1iKMukJEvSMLR0FYqg0K42Ea1aSMsuoe6kVXQHYovGWc3pPTATLh6+/3wzwxx+kQqcLiUC9WpyQZ/8eHsXX5/fbinlkGVZgvznnPt6j5rhYtacXpz5ay+56I0M+WJpiqOeYWbIW8xgFn54MY8JLCOMQ/vZFlqYwro43sw8puNl0zMSiVOcG7+9bfIBJ7hHBXdoo4FnbqOySl6Sc3hCCU2hrxZfKxs1uaYFdYqYaZhZcgcHuEaSD9XLZfUTZpW72EceEaQQRVEs+gqh7MpV8yK4N6128NPpjtn7cNu7GoCrb3caRu15mN6ZBzH+B9oQInTA7ID+AAAAAElFTkSuQmCC","width":400,"height":90,"src":"/static/8637e594ca86d58e20988ba8c4cfc1e7/497c6/thxwelchs-logo-v2.png","srcSet":"/static/8637e594ca86d58e20988ba8c4cfc1e7/497c6/thxwelchs-logo-v2.png 1x"}}},"markdownRemark":{"html":"<h1>JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유</h1>\n<ul>\n<li>Kotlin</li>\n<li>SpringBoot(2.2.4)</li>\n<li>querydsl(4.2.1)</li>\n</ul>\n<br/>\n<h1>문제</h1>\n<p>JPA로 쿼리를 하다보면, N + 1 문제를 마주하게 될 수도 있는데요.</p>\n<p>사실 저의 문제는 정확하게 말하면 N+1 문제는 아닙니다. N+1이란\n@OneToMany의 관계에서 One에 해당하는 엔티티를 조회하면 Many의 해당하는 엔티티가 지연로딩 되어 그 갯수만큼 더 조회한다고 하여 One+N(Many) N+1현상이라고 하는데 저의 경우엔 @ManyToOne의 조회인데도 One에 해당하는\n엔티티가 영속성 컨텍스트에 존재하지 않으면 쿼리하게 되는 현상입니다.</p>\n<p>저는 보통  <code class=\"language-text\">@Query</code> 어노테이션에 JPQL 쿼리를 작성해서 해결하곤 했었습니다.</p>\n<p>근데 querydsl에도 fetchJoin이 있다는걸 최근(?)에서야 알고 사용해보려고 하는데 문제가 해결이 되지 않았습니다. 그 이유는.. 참 어처구니가 없었는데요 혹시나 이런 경우를 겪고 있는 분이 계실까 해서 공유차 포스팅합니다.</p>\n<p>이유는 저처럼 join 함수를 잘못 이해하고 사용하면 매개변수 타입에 따라 fetchJoin 함수를 호출하여도 N + 1 문제가 해결이 안될수도 있다는 것인데요 ㅋㅋ</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 241px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4aaedf67b06c9852ae700e6f222a2bbf/e27e9/Untitled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.72199170124482%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAETklEQVQ4yyWUaVNTZxiGz/9qZ/o32g/tOJ3aaREHaQUaRAraalEU2StrxIQAScjKFiALSwIEshGWAGHNBgQQQVw7Vx+PH85kcuY993tvz6Pkz3Js762yFJ1leTXIXnqNYGgG/7yXmYCXkYlhxr0umtuaeNZcx8iYk0GrEfuQFa2+m+4XbawkQrgm7aysL6FEYktEYgtsJCPEVhbwz3lJbMXR971kyGVnMTbHlAC/6NXiHLPi83sw2YxM+MYZdJjlv1t9QvEAsbUgSigSJH24SSjqZ2snzmLEj3fWjW3Ypn4UjAYEdJ4BSz/umQn8i7MYrQM4Rx2Mu12sbEbIne6ROdnhIL+Dcn5xwsn5PkenuxyebpM62mI+NIuuXyc3e1WG8USUDm0Hja31XwAtA5gsRl7qe1hPRskJ2J6QSp3toXz4dMXR2S5ZeZnJb5O/SDE64aDf2IvLMyZSFrA5LXQKYE3dP9iGLDiG7XRpO5kVe/Kv9sWiKAfZLdYEXHn7/kIFzOSTQn2XnWyC3r4eLDYTg+KVa3KEltZG2jr/5UHt39Q1POF5ewuVVRUCbOHsIi0BTpLcXcXtHUX5+N87Xl1lOX2T5ujVAclUQuT0Y+jX0zdg4PHTGjQVZdx/WM2T+sc0tTZQdb+SgsJf6NF1ElsVBQ6j+DnEYtiPks7usyCeWZ1GAovTZIVleHkBXW8PHd0d6Ad0kq4Di9OMwWRQk/XPzzDhHuOFrovl9aBY5JRqjbIh9VNW15flwJTcXC8SrKxsxOgz6TGa++RmqyTuodeok6oMMDw+xPTclNpBg1zUK+d20gnO3x1jthsxi0XK8UmOiDBy+1wcn6YJRgI0ND8TOd1MeseISVk7etrpMWhZ346znAgLSxOOUTuTU+Nkj7dZ2wgzt+Bjdz+BcpjPsr4ZJSppZo6lS4dJ+kVac0sjswEfW/vrIivGUmwRX8Aj0k14ZtxSdh9j7hEJc0f8G2HU5eAgs4HyiQ+cv8mqSZ9eZtQOPmuso6GpXoLRsbwWFtYLdPZ00CC2aPVa9EY9k1J6rwDvS10OT/ZI5b78Ku8+XpF/nSKd3+Ly/bFUxUBhcSGPnj5SuxiQAJZkmmrqarhTVU71g3vq1JhlntvaW5kLenl9lZNyJ9WWKG8/F1u6lJIpyb8+ICzzXHqnhNLyEnUJTM948ExPqgzNdpMajFuY9Uoofz2oloUQZvtglZPLtAxFGuVKGGbPUxycbKuT4pWP6yWUkrLfeFInLM0GrI5Bhl1OdUkEQ/OMuIZobKmnQhi3dT3nRtGvPKy9Tzguy+G9FDt/mSMjc3j+NifyAvxRXkpR8U0qKjWU/6mh5XkT2pddKkuL3Uyt2FFYdIOfC36iuKRIzpfw9TdfyYprlpRPc2xKIeMS/ednxGWjsvou5RUaqu7dpUTzO9eu/8CNWwWUlN+muOwWmrtl3C4tRnOnlJtFBdTV1/Lj9Wt8+/13/A/eaTr2CfhIZAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled.png\"\n        title=\"JPA%20N%201/Untitled.png\"\n        src=\"/static/4aaedf67b06c9852ae700e6f222a2bbf/e27e9/Untitled.png\"\n        srcset=\"/static/4aaedf67b06c9852ae700e6f222a2bbf/e27e9/Untitled.png 241w\"\n        sizes=\"(max-width: 241px) 100vw, 241px\"\n      />\n  </a>\n    </span></p>\n<h1>예제 구성</h1>\n<p>먼저 상황을 설명하기 위해 </p>\n<p>제가 구성한 예제 구성은 다음과 같습니다. </p>\n<p><code class=\"language-text\">Restaurant(식당)</code>과 <code class=\"language-text\">Menu(식당의 메뉴)</code>를 표현하는 다음과 같은 ERD와 엔티티가 있습니다.</p>\n<h2>데이터베이스 ERD</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 280px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0458039850fbca4e9e1332d4825576ee/f1fc5/Untitled1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.92857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACJ0lEQVQoz32SaW/TQBCG/f9/C4iPiKqtBBTRhtKQ017HR3wkTnwkdXwkjpM8rN1CW1ox0sjj1ew7z+yMoq0iboKIr37IRMZaEmGsY/pRQrE/0NjpdJLeRjy3l38PBwong5vY4Z1QUQcf6Q4vKEsVM7WJy/0zwYfr5nrDe8PjzJxyZ4/p2ILuVOPKnjDLtyi9MEFzbRbriLQqSYqMvCpQk5TVtn4laKxXXM5sOr7ORL+kN7hAiM8MnFu8vEBRFzG9sUq82bYt7B/pzbQmKZ8Ej4+C3bDkV5Aw1IaEWclOnjVZXl7hpDuUzizFmIeoloM+9RiZLqaMf3oJ2YFXNkgqdAmhWxarYk9enyirgxSTgpsK5bsdoRsWEyHwXZdFsCANF/T9mCvhtdTNcLb1kY28+Gmacu7l2BKiN1Txo1Wb4+f7VlT5EpT4iwhT6ETJ6i9JU81b521cH0+tN3a3LLgOCpZhhO84zOZzdnlGcF/IodQo4r7CcmZYhkFVP/XoSsG0Oj5txJ83lILnbsZsscSaCISu49kWbnTPvDigfJPVnFmAoU+YBwGhrHyodrIFOZTt66Fcz3M+mClj0+G2N6TT7TFWNX7oLk4mCS+9DD+MEarcQ+m6blDKFhr8t9bGk+T9qESLMtRwg4hzhIz7YU4s85UziS9sn/FoyJ2sNjFNlpLU2exfrM3z7/9MuZVvosVl6/p6x2gpC6y2jJJtO9l/CY+P7b/lTc5vjTuKy4ma6AgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled1.png\"\n        title=\"JPA%20N%201/Untitled1.png\"\n        src=\"/static/0458039850fbca4e9e1332d4825576ee/f1fc5/Untitled1.png\"\n        srcset=\"/static/0458039850fbca4e9e1332d4825576ee/f1fc5/Untitled1.png 280w\"\n        sizes=\"(max-width: 280px) 100vw, 280px\"\n      />\n  </a>\n    </span></p>\n<h2>엔티티 ERD</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 251px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b427b48566fd34333afd6904d51cd61d/fe9a0/Untitled2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 203.58565737051794%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled2.png\"\n        title=\"JPA%20N%201/Untitled2.png\"\n        src=\"/static/b427b48566fd34333afd6904d51cd61d/fe9a0/Untitled2.png\"\n        srcset=\"/static/b427b48566fd34333afd6904d51cd61d/fe9a0/Untitled2.png 251w\"\n        sizes=\"(max-width: 251px) 100vw, 251px\"\n      />\n  </a>\n    </span></p>\n<h2>Restaurant 엔티티 코드</h2>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@Entity\ndata class Restaurant(\n        var name: String = &quot;&quot;\n): MutableEntity()</code>\n        </deckgo-highlight-code>\n<h2>Menu 엔티티 코드</h2>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@Entity\ndata class Menu(\n        @ManyToOne\n        var restaurant: Restaurant,\n        var price: BigDecimal = BigDecimal.ZERO,\n        var name: String = &quot;&quot;\n): MutableEntity()</code>\n        </deckgo-highlight-code>\n<h2>데이터</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 323px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85c053342824f6bf2604fdfa924dd1af/bfd06/Untitled3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.621160409556317%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5klEQVQY033Me2uCUByHcd//O2qwW6spaFNz07xO8xpUnrlkLIsnjQ02aPvjw3Pg9+VIXrXBdBxekxQlWPUKtLhiYVnEccKubanrGiEG4qLmTVCta67tEsmOcizHx40ydC9FNhweNIuJrKJoJnMnIFxWhElJ8A8/LnnyMqRi01JuPxiargS2nzCWZ4xuH5n2H99MVGbPIfm6/bL78f6t2rZI++7Ivjv0OkTzTpblTBUF3ZzjLFxczyeKl3zuO7rDsD2ee8lwk6JCEPaGvkQVhh0yGqvcyTpXfe8VE8VwicrmvPve/uUE9LNuaYri7EAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled3.png\"\n        title=\"JPA%20N%201/Untitled3.png\"\n        src=\"/static/85c053342824f6bf2604fdfa924dd1af/bfd06/Untitled3.png\"\n        srcset=\"/static/85c053342824f6bf2604fdfa924dd1af/8890b/Untitled3.png 293w,\n/static/85c053342824f6bf2604fdfa924dd1af/bfd06/Untitled3.png 323w\"\n        sizes=\"(max-width: 323px) 100vw, 323px\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 358px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/10da870a8839e8ed23d6f9a223d2c6fc/46af1/Untitled4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.170648464163826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFElEQVQozz2S7XKiQBBFff8X2n+bTVlJ1I0gH6KiiCIoiIAIqCHGsw2WO1VT1XXm9p2Z7u6Y3o7Z1GLi7VGcLb2pi2EY6JqGNhrhzG2MlZwtfAbrCFM3WDoOw6XEqwDV2WDpGstdwh91RsdyAiwRG/aGobVCsVz6qsV4EWDON5i2x5vl8TlZ0xsa/O4O+KvNMJchpmgmyx2jicvrh8LrQKdTnGvK6400r4jTE0X1RbhPWlZcbpzKK3ZUEBxOqNoYZWSy2oRUzbloG10iubph4awDOvHxzCG/sJMET559OF3b3fD4eJFLSnQ/wwmPDD5H9Ic6c/lqLDlxVrXabZwzUHQmi/XT8MpO4CZMSf6bPS7apwVjMXSjh2G3N2TmBmRl3Ro2+iZP0S2mUs9OVlzJq5ooyQmitI0b9uQHKYO2jvGTAlU3eRPDgaKJWcmxbDRfbPcpo8aweeEuqQizs3w3ZenHRBI37Mn9MKO/iLC3RxRjJo0x6fZV3G3SasP03MYDdYwuE9IpL7UU+FuKfyY9lm3csCfPTxW2mIZZwXRmy7dVKb7P7Y405cpZNIcsZzK1WXrSlLV0cBOXzL24HQE/rlhHJxruCXeDhHdbRkRm8aXb49fLBx/qFMuNRJO3uU6Q8vquoIwdOiBXyarrL6qq4rHuPPntu2YrLz+dLwSBj7OwsedzNkHA/efnob7/sNsGRPs9/wDaF+D/CSWjdQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled4.png\"\n        title=\"JPA%20N%201/Untitled4.png\"\n        src=\"/static/10da870a8839e8ed23d6f9a223d2c6fc/46af1/Untitled4.png\"\n        srcset=\"/static/10da870a8839e8ed23d6f9a223d2c6fc/8890b/Untitled4.png 293w,\n/static/10da870a8839e8ed23d6f9a223d2c6fc/46af1/Untitled4.png 358w\"\n        sizes=\"(max-width: 358px) 100vw, 358px\"\n      />\n  </a>\n    </span></p>\n<h2>문제의 코드</h2>\n<p>문제의 코드 입니다. (어떤게 문제인지 바로 아시겠나요?)</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">class MenuRepositoryCustomImpl: MenuRepositoryCustom, QuerydslRepositorySupport(Menu::class.java) {\n    override fun findAllJoinRestaurant(): MutableList&lt;Menu&gt; {\n        val m = QMenu.menu\n        val r = QRestaurant.restaurant\n        return from(m)\n                .leftJoin(r)\n                .on(r.id.eq(m.restaurant.id))\n                .fetchJoin()\n                .fetch()\n    }\n}</code>\n        </deckgo-highlight-code>\n<p>함수 호출을 위해 테스트코드를 작성하고 실행했습니다.\n( 테스트의 결과값 보다는 N+1 쿼리가 수행되는 것을 보기 위함이므로 일단 테스트는 통과하게끔 했습니다. )</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@Test\nfun `Menu 만 조회했는데, Restaurant 가 조회되는 N+1 현상 테스트` () {\n    val menus = menuRepository.findAllJoinRestaurant()\n\n    assertTrue(true)\n}</code>\n        </deckgo-highlight-code>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 681px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ca29f3317ce1b991208902715823f9f7/ad007/idea64_xOWUXfJUQM.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.24573378839591%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC9klEQVQ4y62UW3PaSBCF9V8SjC4Ig3VBVyQkhLiDJITtOLGTvDn5/88nZ0Z4zSa7D1u1D191q3t01GeaQolnR5hZAiOOMJiGGDkRRncpLHcGY+xDnwTEh2GHuHVzDCdzjOwMhjHBjWajrzlQdVfGvuZCibMjBmUCfUbBLIbp+7iNQlheCNMMoZoedMeH5vpQHQ+aF8Bw2XMzjCxyG1PIlqKq7kBJ1xWsOCMpbC+FPo4xcFNON5XobgCNgsNxiPFthOGIwqYLzeT0A36Ik75NKQVnqxqWGcEexIhGOTynQDKdY5bmCMME42mO8WwFOyhhjRKYhgdV2nvnb5aj+AB9OEHPdPBRtfHxxsKHnoVeX2Cjd0P6Dj4wl33SUx3eXydwLSZyJStqGEPa8WLcjT1M/QjrWcJJA4xHHms+AtqeRzFcy8eUd5sGEVyb1g33YvUdJc0raEzGhg/f4kErwHIaoYxDZEEAlwu64/Y9Ls1ibRL6UnjEjxkD3qUQldvuUMr9F+jFK/TND+iHVwx2r7DKn9AWP6EWF5j3ix/vz0XX18s/UZKswYC/O3UYQ7tCvYrqb7Xr+u8oaXbCPHvAIn9CkX9CktTIZ/esPcqaiAXJZmf2n5ClLXKeL/JHxNMDgmiL8AoKNsiK8/+GslidkOR7JNmfpPl/R6mrJ2zKGnNSLJsO5vmi+seP/DsHCh645WWNetNitW6xZCzXJ6y299jueYecvli+0bDXytq8bC498XHWV7zXRX0R5KH9loLbM9Zkyeem/Yr24TtO5684M7b331GfXmStffiGqnmWedV8Qd2+yDPLzVlOqgiB/aabbsWiaBx5sDo9y1gzCgHxshATz7vDJ/aecag/Y199loL741M3oRh5s6IF2ippY0EbG9rd8iURxctbyaOc5kCBNa9kvXuQfZHvKLZ7ExQiR1peXyyLKYW90/03KSBiQ+ud5S6vpIMX6UIgzzKKe+SfQ4U5yQWLjm7bp6vY5X8tqWzefxGXM2IXQvAX1omhAyscfFUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled5.png\"\n        title=\"JPA%20N%201/Untitled5.png\"\n        src=\"/static/ca29f3317ce1b991208902715823f9f7/ad007/idea64_xOWUXfJUQM.png\"\n        srcset=\"/static/ca29f3317ce1b991208902715823f9f7/8890b/idea64_xOWUXfJUQM.png 293w,\n/static/ca29f3317ce1b991208902715823f9f7/1f316/idea64_xOWUXfJUQM.png 585w,\n/static/ca29f3317ce1b991208902715823f9f7/ad007/idea64_xOWUXfJUQM.png 681w\"\n        sizes=\"(max-width: 681px) 100vw, 681px\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/529686da0e8c95478ee8f7bb8c2acff1/d33d3/Untitled6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 4.778156996587031%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOklEQVQI12OwsnH/b2Pn8d/S2vW/tS2EbQ0Us7Jx+29r7wnGMD5IDqQerM7WA0yDxHX1rf7r6FmBaQBpSSJeAjFzHAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled6.png\"\n        title=\"JPA%20N%201/Untitled6.png\"\n        src=\"/static/529686da0e8c95478ee8f7bb8c2acff1/463a7/Untitled6.png\"\n        srcset=\"/static/529686da0e8c95478ee8f7bb8c2acff1/8890b/Untitled6.png 293w,\n/static/529686da0e8c95478ee8f7bb8c2acff1/1f316/Untitled6.png 585w,\n/static/529686da0e8c95478ee8f7bb8c2acff1/463a7/Untitled6.png 1170w,\n/static/529686da0e8c95478ee8f7bb8c2acff1/e1fbe/Untitled6.png 1755w,\n/static/529686da0e8c95478ee8f7bb8c2acff1/d33d3/Untitled6.png 1783w\"\n        sizes=\"(max-width: 1170px) 100vw, 1170px\"\n      />\n  </a>\n    </span>\n해당 함수를 호출해서 query하면!? N + 1현상이 발생합니다.</p>\n<p>첫번째 쿼리인 menu left outer join restaurant 를 했는데도 불구하고, 밑에 세개의 추가 쿼리가 실행되었습니다.</p>\n<p>왜 이럴까? 하고 querydsl의 <code class=\"language-text\">leftJoin</code> 함수가 정의된 <code class=\"language-text\">JPQLQuery</code> 인터페이스를 추적 해보았습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 460px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7cd075e617306d11657e6ed3c7d8ad5a/b3f9e/Untitled7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.32081911262799%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYUlEQVQoz4WR63KCMBCFeZh6Qe6EJAZBRBBQlNZLO/by/q9xukRrdaYz/fHNybJZcnbXYGKFkFfwWAnHz+BHK312g1yrFy7h96q/LRCKNSxnhpEZYTwRmpHJbximHSOgS5HaEVuI+BlMrqmwAVcdoulWI2Z70hac8jzuEPD6auBipteJrWD0rzn0U8uawiIdW/L2Wn/WaCfyioBJhT19bFKdRscChuOmeI1P6GQHEVZwnVRf+GlrOGYPLf2H4XkZ3tMzDmoPJVqoKbUpN5DJgWZXwPbmdy7FnVvxJ4ZlJ0j9EqmTwaXzmJxZbkYtJLD9Jc0px2AY4mkQXFQTaB2MetgDRlYekNZvSDYfmDdnZMUeVdFiW3VYr1pklMvWn8i3X1hURyyKI8r6jKo+Yb54gUp2iNNfDMZz2l4FnrSI4oY2XELKJbVeIFYFbb4GU81FBcWC8hRLtQLjBY0lR8CWN74Bfn4FeUGF4c8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled7.png\"\n        title=\"JPA%20N%201/Untitled7.png\"\n        src=\"/static/7cd075e617306d11657e6ed3c7d8ad5a/b3f9e/Untitled7.png\"\n        srcset=\"/static/7cd075e617306d11657e6ed3c7d8ad5a/8890b/Untitled7.png 293w,\n/static/7cd075e617306d11657e6ed3c7d8ad5a/b3f9e/Untitled7.png 460w\"\n        sizes=\"(max-width: 460px) 100vw, 460px\"\n      />\n  </a>\n    </span></p>\n<p>언뜻 보기에 함수의 주석 설명에는</p>\n<ul>\n<li>주어진 target 매개변수를 기반으로 left join이 생성되어 질 것이고,</li>\n<li>fetchJoin을 사용하기 위해서는 fetchJoin 파라미터를 해당 join 에 추가 (<strong>정확하게는 파라미터로 이해하기보다는, fetch join 할 join 함수 뒤에 fetchJoin 함수를 추가해주면 됩니다.</strong>)</li>\n</ul>\n<p>하라고 되어있습니다. 이렇게만 보면 제 코드에서 <code class=\"language-text\">leftJoin</code> 함수에 매개변수로 넘겨준 target이 restaurant이니 맞는 것 같기도 합니다만 현재 문제에서 안되는 이유를 찾기 위해 코드를 추적하다 querydsl fetchJoin은 다음과 같이 동작하여 JPQLQuery를 생성한다는 것을 알게되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 834px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b1ffa0c14526d6534fbf70eab3e727c2/7df40/idea64_G1UvBO54eI.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.96587030716725%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB/ElEQVQ4y4WSWXPaQBCE988kIEwibgoMSFrdoPsO4NiObYhdectL/n1nVgTKRQJ5+GpmS7u93bNimp5hMDQgSyN8lscY9kboUW00e2g0ukTvjO5VmO2UmNp3uOHfMAz26BfPmEav9VrSHtDSHut6RKyvwXQjx/jWQ0tW0f6kotVR0JTnkGQFUkf9i6asXIXVkUcm5PYE/ckcM+7CdlIo2gq3MxuzuXNivnBx0x7ROPpoSgM0RT2DBHMMxxY+0MwkaQhVD1BtXhCldzDdDKaTwbBTWG4OzQjRao/xsTlAgwRFPYdxijyZehgpLrpTnZz5tViUfkWYbE8k+T2JZuj0FMjdyzCFp+BGCce9h2lvyGF4EYUHUHkCbhZ05t8wm6KIzQtyJhCHNCM6oVvJQZDTN82rE6h6dPFS5nolwqCih6B5uWk9p/NNQthcbmE4FfXB1RRMIwfF+gkZCXteAcOKalEBN0TMg+t0+wt+9gML1asvEC7fJznCbBLJvjxh45coqXeXGZx36FZMcQPM1SWJrU6OLzrUlyny9TPWfgV/VcAhUYeqS5j0u3AzJgHC/IMRXYVxO0ZWPWDj5eQwR7zKYVohOaMHMcmN7h9i1w/yf5gdPqJ6/Iky3SMnCiLL35AU35GWrwiLN8T5Hn66g5eISlA99l6ywyre1b2ovwGCq/XLCwAGBgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled8.png\"\n        title=\"JPA%20N%201/Untitled8.png\"\n        src=\"/static/b1ffa0c14526d6534fbf70eab3e727c2/7df40/idea64_G1UvBO54eI.png\"\n        srcset=\"/static/b1ffa0c14526d6534fbf70eab3e727c2/8890b/idea64_G1UvBO54eI.png 293w,\n/static/b1ffa0c14526d6534fbf70eab3e727c2/1f316/idea64_G1UvBO54eI.png 585w,\n/static/b1ffa0c14526d6534fbf70eab3e727c2/7df40/idea64_G1UvBO54eI.png 834w\"\n        sizes=\"(max-width: 834px) 100vw, 834px\"\n      />\n  </a>\n    </span></p>\n<p>디버그 된 변수를 살펴보시면 <code class=\"language-text\">self</code>에 <code class=\"language-text\">JPQLQuery</code>가 텍스트 로 표현되고 있습니다. </p>\n<p>가만살펴보니 뭔가 이상합니다. 흠 네.. 지금껏 멍청하게 target을 잘못 전달하고 있었던 것이었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 708px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/44460dcff0f905267982c0ab1e966588/6106f/Untitled9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.79180887372013%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUUlEQVQ4y22TS0vyURDGz2ds7VLoG7hpE7Ro4UdwEQhRtMlI1NTQIlIRkSxUvEXmpfJ+17ImfvNyfF00MJzzP2fmmXmeM3/z8/Mj1rHv728pFAqyWCzk6+tL1uu1rFYr+fz8lOVyqfvZbCaDwUBjiL+9vZVwOCzxeFyMbJkFbbVammALAMwKKAWIY53P5+rEHx0dKaixQDhJ2Gg00iCCSaQj9gBPJhMpl8tSLBalUqmoY/f393JyciJmm641kt/f36XRaMjZ2Zm4XC5JJpPaYalUkoODA9nd3ZVAICD1el1zkOn8/Pw/ZasNK512Oh3p9XoSiUTE7XarPtlsVu+r1ap4PB7tihgMYLo1luJ0Ot1Qwvv9vozHYz0D5Pn5WRMoRrxlRh731gzJdLb9KFC2HdqXZm+74X44HOors7eAgBsu/jIKoaNN6Ha7EovFJJ1Ob8aGO+IYJ+zj4+MfIOLncjmp1WpKDeGpRpfQs6PCyyI+35wDCLgdoePjYzEkNZtNeXp62ujESjWSENvOGx1zjrfbbb3Hsevra0kkEmJeXl7+pGwTAMHRi/nL5/Pa6fbwMz4+n0+ZmlQqpd2hBQ8AVbri8u3tbTPkvDhacg4rpgC7u7uT/f19PX99fRUTjUa1AnP2+PgoFGClCPShh07Iwn7bQqGQOJ1OZUPXDL65vLyUi4sLBUWDm5sbBc1kMhoEEN0gPMURPhgMyt7enjgcDi0OdWJgZvipvV6v/mJ+v1+1uLq60ur8bg8PD+qAc8ZvuLOzI6enpyoFXVOU7g4PD+UX7sJILZuQWp0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled9.png\"\n        title=\"JPA%20N%201/Untitled9.png\"\n        src=\"/static/44460dcff0f905267982c0ab1e966588/6106f/Untitled9.png\"\n        srcset=\"/static/44460dcff0f905267982c0ab1e966588/8890b/Untitled9.png 293w,\n/static/44460dcff0f905267982c0ab1e966588/1f316/Untitled9.png 585w,\n/static/44460dcff0f905267982c0ab1e966588/6106f/Untitled9.png 708w\"\n        sizes=\"(max-width: 708px) 100vw, 708px\"\n      />\n  </a>\n    </span></p>\n<p>fetch Join이 되려면 </p>\n<p>타겟이 restaurant가 아닌 menu의 프로퍼티로 존재하는 menu.restaurant가 되어야 하는것이었습니다.</p>\n<p><br>\n그래서 코드를 다음과 같이 수정하고 해결하였습니다!</p>\n<h2>수정된 코드</h2>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">class MenuRepositoryCustomImpl: MenuRepositoryCustom, QuerydslRepositorySupport(Menu::class.java) {\n    override fun findAllJoinRestaurant(): MutableList&lt;Menu&gt; {\n        val m = QMenu.menu\n        val r = QRestaurant.restaurant\n        return from(m)\n                //.leftJoin(r)\n                .leftJoin(m.restaurant)\n                //.on(r.id.eq(m.restaurant.id)) entity 연관관계 기반으로 어차피 맵핑되서 join함 on 조건을 주면 fetch 할 때 with 에 property를 에\n                .fetchJoin()\n                .fetch()\n    }\n}</code>\n        </deckgo-highlight-code>\n<h2>수정 후 쿼리</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 583px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/35e216d7838ea09162167e1c3dc717aa/d8a90/Untitled10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.6825938566553%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADLklEQVQ4y5WT2XbiRhRF9TO2BgxtBklgQEhoQhODBJKY2oEHOsNKx3aSp3xBHvPFJ7dKYNPuJKvzsFdpKJ17zz0lYWRm6Kg2GmIL3UYfjZaKvqbC1LpofehAvP0A8aZB67ch+EGOnvcRsnlAMzxBy35Ac33CQ/ETBtPPuLOPkK0DlPHxmxD8MMeDu8HtsEBtUKDV30CyckjjFepGAXm4/l8IhplyyzXxHk1ZhSzdo1Nrok2IYh23N9c0Kvv/gWCOM6hdHzWlh07HQtMwodsjjEwXujZBq8XWGLoa4r5pQFJ0SLV/QKngghoJ3sht1Bs96G0TynCI+miI5v0DZLkLhYoptR5kRcOt1HlHm68SvWMIIyuFqvsQayqkOw2iolJabcgkoPZ9DIwJegOP9ozJiU3FLzj8vtv3+CrKdCJoZILj5tBIUGrpqA8HuNP7JKah3jLgxRtE0xITCs60Z7Cc+VfYXgbDSiDf6fQdWbbdAiYlGriPmHpH+OM1HErd9TaYpzss8wOWxQFhXHCBsctYcFgRhmHFGI7oepzSDO0VvSzg+luO7ZEgYdlL+OEKs3RP7DBb7JDMWMdrJPMtpnO2N4VJRUbjKQkvuY7AHo6oCnt4DataXb+9u3Rknvezbx0/43sZ7LkwX1Ale1rZuZqNaU//dW7vYTN8FQyiFZZkKQzIIl1PiCDKyf6Cd8E/+kr4+p72kSCD3QsuzWR9+BFlWAnFSUEBkOAkfRP8QmB2dkC22Vi43Yj2ngVD6i7fn1CQYEFJpiTKwrgIXs/tFV5oAT9+hJ8cYLnVHLlgnH1E8fg973CblChJNCJRhyybr4LvhKkb2y+wPf2J489/kegRhhnyIkKU7ZE/fsKehHKyG5AwszyJaKbUpRewJOdVkmb8mqhhRvwvGhg+hiR2CVDw6WytyPKausqpwxmtAa3OJKMuMn4sHD+9Sn/+RSBvVM+EKN2i/O4TdtTRnjrcJzlZL7AIMkyoQ5d3mcEnHK8KxXQugSTnUOLzuU3oHO5+x+b0B8rVE7LiCStG/gvK8gX55jekmxcU22daf+Wsti9Yrp8wK54xJ2ZnFuUzouwz/galys6f0lJ8kQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled10.png\"\n        title=\"JPA%20N%201/Untitled10.png\"\n        src=\"/static/35e216d7838ea09162167e1c3dc717aa/d8a90/Untitled10.png\"\n        srcset=\"/static/35e216d7838ea09162167e1c3dc717aa/8890b/Untitled10.png 293w,\n/static/35e216d7838ea09162167e1c3dc717aa/d8a90/Untitled10.png 583w\"\n        sizes=\"(max-width: 583px) 100vw, 583px\"\n      />\n  </a>\n    </span></p>\n<p>N + 1이 해결 되고 join 쿼리 한번만 수행 되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bb9c707870a618152342643277064f0c/05775/Untitled11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 2.3890784982935154%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMElEQVQI12MwNLb7b2Ri/9/E1OG/gRGUbeYIZ5sC2SAazDaHsEF6jIHqQTRIDJkPABrAIN/Y5pM/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JPA%20N%201/Untitled11.png\"\n        title=\"JPA%20N%201/Untitled11.png\"\n        src=\"/static/bb9c707870a618152342643277064f0c/463a7/Untitled11.png\"\n        srcset=\"/static/bb9c707870a618152342643277064f0c/8890b/Untitled11.png 293w,\n/static/bb9c707870a618152342643277064f0c/1f316/Untitled11.png 585w,\n/static/bb9c707870a618152342643277064f0c/463a7/Untitled11.png 1170w,\n/static/bb9c707870a618152342643277064f0c/e1fbe/Untitled11.png 1755w,\n/static/bb9c707870a618152342643277064f0c/05775/Untitled11.png 1768w\"\n        sizes=\"(max-width: 1170px) 100vw, 1170px\"\n      />\n  </a>\n    </span></p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Kotlin"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"SpringBoot(2.2.4)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"querydsl(4.2.1)"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"문제"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"JPA로 쿼리를 하다보면, N + 1 문제를 마주하게 될 수도 있는데요."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"사실 저의 문제는 정확하게 말하면 N+1 문제는 아닙니다. N+1이란\n@OneToMany의 관계에서 One에 해당하는 엔티티를 조회하면 Many의 해당하는 엔티티가 지연로딩 되어 그 갯수만큼 더 조회한다고 하여 One+N(Many) N+1현상이라고 하는데 저의 경우엔 @ManyToOne의 조회인데도 One에 해당하는\n엔티티가 영속성 컨텍스트에 존재하지 않으면 쿼리하게 되는 현상입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"저는 보통  "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@Query"}]},{"type":"text","value":" 어노테이션에 JPQL 쿼리를 작성해서 해결하곤 했었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"근데 querydsl에도 fetchJoin이 있다는걸 최근(?)에서야 알고 사용해보려고 하는데 문제가 해결이 되지 않았습니다. 그 이유는.. 참 어처구니가 없었는데요 혹시나 이런 경우를 겪고 있는 분이 계실까 해서 공유차 포스팅합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이유는 저처럼 join 함수를 잘못 이해하고 사용하면 매개변수 타입에 따라 fetchJoin 함수를 호출하여도 N + 1 문제가 해결이 안될수도 있다는 것인데요 ㅋㅋ"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 241px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/4aaedf67b06c9852ae700e6f222a2bbf/e27e9/Untitled.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 86.72199170124482%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAETklEQVQ4yyWUaVNTZxiGz/9qZ/o32g/tOJ3aaREHaQUaRAraalEU2StrxIQAScjKFiALSwIEshGWAGHNBgQQQVw7Vx+PH85kcuY993tvz6Pkz3Js762yFJ1leTXIXnqNYGgG/7yXmYCXkYlhxr0umtuaeNZcx8iYk0GrEfuQFa2+m+4XbawkQrgm7aysL6FEYktEYgtsJCPEVhbwz3lJbMXR971kyGVnMTbHlAC/6NXiHLPi83sw2YxM+MYZdJjlv1t9QvEAsbUgSigSJH24SSjqZ2snzmLEj3fWjW3Ypn4UjAYEdJ4BSz/umQn8i7MYrQM4Rx2Mu12sbEbIne6ROdnhIL+Dcn5xwsn5PkenuxyebpM62mI+NIuuXyc3e1WG8USUDm0Hja31XwAtA5gsRl7qe1hPRskJ2J6QSp3toXz4dMXR2S5ZeZnJb5O/SDE64aDf2IvLMyZSFrA5LXQKYE3dP9iGLDiG7XRpO5kVe/Kv9sWiKAfZLdYEXHn7/kIFzOSTQn2XnWyC3r4eLDYTg+KVa3KEltZG2jr/5UHt39Q1POF5ewuVVRUCbOHsIi0BTpLcXcXtHUX5+N87Xl1lOX2T5ujVAclUQuT0Y+jX0zdg4PHTGjQVZdx/WM2T+sc0tTZQdb+SgsJf6NF1ElsVBQ6j+DnEYtiPks7usyCeWZ1GAovTZIVleHkBXW8PHd0d6Ad0kq4Di9OMwWRQk/XPzzDhHuOFrovl9aBY5JRqjbIh9VNW15flwJTcXC8SrKxsxOgz6TGa++RmqyTuodeok6oMMDw+xPTclNpBg1zUK+d20gnO3x1jthsxi0XK8UmOiDBy+1wcn6YJRgI0ND8TOd1MeseISVk7etrpMWhZ346znAgLSxOOUTuTU+Nkj7dZ2wgzt+Bjdz+BcpjPsr4ZJSppZo6lS4dJ+kVac0sjswEfW/vrIivGUmwRX8Aj0k14ZtxSdh9j7hEJc0f8G2HU5eAgs4HyiQ+cv8mqSZ9eZtQOPmuso6GpXoLRsbwWFtYLdPZ00CC2aPVa9EY9k1J6rwDvS10OT/ZI5b78Ku8+XpF/nSKd3+Ly/bFUxUBhcSGPnj5SuxiQAJZkmmrqarhTVU71g3vq1JhlntvaW5kLenl9lZNyJ9WWKG8/F1u6lJIpyb8+ICzzXHqnhNLyEnUJTM948ExPqgzNdpMajFuY9Uoofz2oloUQZvtglZPLtAxFGuVKGGbPUxycbKuT4pWP6yWUkrLfeFInLM0GrI5Bhl1OdUkEQ/OMuIZobKmnQhi3dT3nRtGvPKy9Tzguy+G9FDt/mSMjc3j+NifyAvxRXkpR8U0qKjWU/6mh5XkT2pddKkuL3Uyt2FFYdIOfC36iuKRIzpfw9TdfyYprlpRPc2xKIeMS/ednxGWjsvou5RUaqu7dpUTzO9eu/8CNWwWUlN+muOwWmrtl3C4tRnOnlJtFBdTV1/Lj9Wt8+/13/A/eaTr2CfhIZAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled.png","title":"JPA%20N%201/Untitled.png","src":"/static/4aaedf67b06c9852ae700e6f222a2bbf/e27e9/Untitled.png","srcSet":["/static/4aaedf67b06c9852ae700e6f222a2bbf/e27e9/Untitled.png 241w"],"sizes":["(max-width:","241px)","100vw,","241px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"예제 구성"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 상황을 설명하기 위해 "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"제가 구성한 예제 구성은 다음과 같습니다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Restaurant(식당)"}]},{"type":"text","value":"과 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Menu(식당의 메뉴)"}]},{"type":"text","value":"를 표현하는 다음과 같은 ERD와 엔티티가 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"데이터베이스 ERD"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 280px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/0458039850fbca4e9e1332d4825576ee/f1fc5/Untitled1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 58.92857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACJ0lEQVQoz32SaW/TQBCG/f9/C4iPiKqtBBTRhtKQ017HR3wkTnwkdXwkjpM8rN1CW1ox0sjj1ew7z+yMoq0iboKIr37IRMZaEmGsY/pRQrE/0NjpdJLeRjy3l38PBwong5vY4Z1QUQcf6Q4vKEsVM7WJy/0zwYfr5nrDe8PjzJxyZ4/p2ILuVOPKnjDLtyi9MEFzbRbriLQqSYqMvCpQk5TVtn4laKxXXM5sOr7ORL+kN7hAiM8MnFu8vEBRFzG9sUq82bYt7B/pzbQmKZ8Ej4+C3bDkV5Aw1IaEWclOnjVZXl7hpDuUzizFmIeoloM+9RiZLqaMf3oJ2YFXNkgqdAmhWxarYk9enyirgxSTgpsK5bsdoRsWEyHwXZdFsCANF/T9mCvhtdTNcLb1kY28+Gmacu7l2BKiN1Txo1Wb4+f7VlT5EpT4iwhT6ETJ6i9JU81b521cH0+tN3a3LLgOCpZhhO84zOZzdnlGcF/IodQo4r7CcmZYhkFVP/XoSsG0Oj5txJ83lILnbsZsscSaCISu49kWbnTPvDigfJPVnFmAoU+YBwGhrHyodrIFOZTt66Fcz3M+mClj0+G2N6TT7TFWNX7oLk4mCS+9DD+MEarcQ+m6blDKFhr8t9bGk+T9qESLMtRwg4hzhIz7YU4s85UziS9sn/FoyJ2sNjFNlpLU2exfrM3z7/9MuZVvosVl6/p6x2gpC6y2jJJtO9l/CY+P7b/lTc5vjTuKy4ma6AgAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled1.png","title":"JPA%20N%201/Untitled1.png","src":"/static/0458039850fbca4e9e1332d4825576ee/f1fc5/Untitled1.png","srcSet":["/static/0458039850fbca4e9e1332d4825576ee/f1fc5/Untitled1.png 280w"],"sizes":["(max-width:","280px)","100vw,","280px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"엔티티 ERD"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 251px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/b427b48566fd34333afd6904d51cd61d/fe9a0/Untitled2.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 203.58565737051794%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled2.png","title":"JPA%20N%201/Untitled2.png","src":"/static/b427b48566fd34333afd6904d51cd61d/fe9a0/Untitled2.png","srcSet":["/static/b427b48566fd34333afd6904d51cd61d/fe9a0/Untitled2.png 251w"],"sizes":["(max-width:","251px)","100vw,","251px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Restaurant 엔티티 코드"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Entity\ndata class Restaurant(\n        var name: String = \"\"\n): MutableEntity()"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Menu 엔티티 코드"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Entity\ndata class Menu(\n        @ManyToOne\n        var restaurant: Restaurant,\n        var price: BigDecimal = BigDecimal.ZERO,\n        var name: String = \"\"\n): MutableEntity()"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"데이터"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 323px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/85c053342824f6bf2604fdfa924dd1af/bfd06/Untitled3.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 26.621160409556317%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5klEQVQY033Me2uCUByHcd//O2qwW6spaFNz07xO8xpUnrlkLIsnjQ02aPvjw3Pg9+VIXrXBdBxekxQlWPUKtLhiYVnEccKubanrGiEG4qLmTVCta67tEsmOcizHx40ydC9FNhweNIuJrKJoJnMnIFxWhElJ8A8/LnnyMqRi01JuPxiargS2nzCWZ4xuH5n2H99MVGbPIfm6/bL78f6t2rZI++7Ivjv0OkTzTpblTBUF3ZzjLFxczyeKl3zuO7rDsD2ee8lwk6JCEPaGvkQVhh0yGqvcyTpXfe8VE8VwicrmvPve/uUE9LNuaYri7EAAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled3.png","title":"JPA%20N%201/Untitled3.png","src":"/static/85c053342824f6bf2604fdfa924dd1af/bfd06/Untitled3.png","srcSet":["/static/85c053342824f6bf2604fdfa924dd1af/8890b/Untitled3.png 293w","/static/85c053342824f6bf2604fdfa924dd1af/bfd06/Untitled3.png 323w"],"sizes":["(max-width:","323px)","100vw,","323px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 358px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/10da870a8839e8ed23d6f9a223d2c6fc/46af1/Untitled4.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 50.170648464163826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFElEQVQozz2S7XKiQBBFff8X2n+bTVlJ1I0gH6KiiCIoiIAIqCHGsw2WO1VT1XXm9p2Z7u6Y3o7Z1GLi7VGcLb2pi2EY6JqGNhrhzG2MlZwtfAbrCFM3WDoOw6XEqwDV2WDpGstdwh91RsdyAiwRG/aGobVCsVz6qsV4EWDON5i2x5vl8TlZ0xsa/O4O+KvNMJchpmgmyx2jicvrh8LrQKdTnGvK6400r4jTE0X1RbhPWlZcbpzKK3ZUEBxOqNoYZWSy2oRUzbloG10iubph4awDOvHxzCG/sJMET559OF3b3fD4eJFLSnQ/wwmPDD5H9Ic6c/lqLDlxVrXabZwzUHQmi/XT8MpO4CZMSf6bPS7apwVjMXSjh2G3N2TmBmRl3Ro2+iZP0S2mUs9OVlzJq5ooyQmitI0b9uQHKYO2jvGTAlU3eRPDgaKJWcmxbDRfbPcpo8aweeEuqQizs3w3ZenHRBI37Mn9MKO/iLC3RxRjJo0x6fZV3G3SasP03MYDdYwuE9IpL7UU+FuKfyY9lm3csCfPTxW2mIZZwXRmy7dVKb7P7Y405cpZNIcsZzK1WXrSlLV0cBOXzL24HQE/rlhHJxruCXeDhHdbRkRm8aXb49fLBx/qFMuNRJO3uU6Q8vquoIwdOiBXyarrL6qq4rHuPPntu2YrLz+dLwSBj7OwsedzNkHA/efnob7/sNsGRPs9/wDaF+D/CSWjdQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled4.png","title":"JPA%20N%201/Untitled4.png","src":"/static/10da870a8839e8ed23d6f9a223d2c6fc/46af1/Untitled4.png","srcSet":["/static/10da870a8839e8ed23d6f9a223d2c6fc/8890b/Untitled4.png 293w","/static/10da870a8839e8ed23d6f9a223d2c6fc/46af1/Untitled4.png 358w"],"sizes":["(max-width:","358px)","100vw,","358px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"문제의 코드"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"문제의 코드 입니다. (어떤게 문제인지 바로 아시겠나요?)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"class MenuRepositoryCustomImpl: MenuRepositoryCustom, QuerydslRepositorySupport(Menu::class.java) {\n    override fun findAllJoinRestaurant(): MutableList<Menu> {\n        val m = QMenu.menu\n        val r = QRestaurant.restaurant\n        return from(m)\n                .leftJoin(r)\n                .on(r.id.eq(m.restaurant.id))\n                .fetchJoin()\n                .fetch()\n    }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"함수 호출을 위해 테스트코드를 작성하고 실행했습니다.\n( 테스트의 결과값 보다는 N+1 쿼리가 수행되는 것을 보기 위함이므로 일단 테스트는 통과하게끔 했습니다. )"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Test\nfun `Menu 만 조회했는데, Restaurant 가 조회되는 N+1 현상 테스트` () {\n    val menus = menuRepository.findAllJoinRestaurant()\n\n    assertTrue(true)\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 681px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/ca29f3317ce1b991208902715823f9f7/ad007/idea64_xOWUXfJUQM.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 96.24573378839591%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC9klEQVQ4y62UW3PaSBCF9V8SjC4Ig3VBVyQkhLiDJITtOLGTvDn5/88nZ0Z4zSa7D1u1D191q3t01GeaQolnR5hZAiOOMJiGGDkRRncpLHcGY+xDnwTEh2GHuHVzDCdzjOwMhjHBjWajrzlQdVfGvuZCibMjBmUCfUbBLIbp+7iNQlheCNMMoZoedMeH5vpQHQ+aF8Bw2XMzjCxyG1PIlqKq7kBJ1xWsOCMpbC+FPo4xcFNON5XobgCNgsNxiPFthOGIwqYLzeT0A36Ik75NKQVnqxqWGcEexIhGOTynQDKdY5bmCMME42mO8WwFOyhhjRKYhgdV2nvnb5aj+AB9OEHPdPBRtfHxxsKHnoVeX2Cjd0P6Dj4wl33SUx3eXydwLSZyJStqGEPa8WLcjT1M/QjrWcJJA4xHHms+AtqeRzFcy8eUd5sGEVyb1g33YvUdJc0raEzGhg/f4kErwHIaoYxDZEEAlwu64/Y9Ls1ibRL6UnjEjxkD3qUQldvuUMr9F+jFK/TND+iHVwx2r7DKn9AWP6EWF5j3ix/vz0XX18s/UZKswYC/O3UYQ7tCvYrqb7Xr+u8oaXbCPHvAIn9CkX9CktTIZ/esPcqaiAXJZmf2n5ClLXKeL/JHxNMDgmiL8AoKNsiK8/+GslidkOR7JNmfpPl/R6mrJ2zKGnNSLJsO5vmi+seP/DsHCh645WWNetNitW6xZCzXJ6y299jueYecvli+0bDXytq8bC498XHWV7zXRX0R5KH9loLbM9Zkyeem/Yr24TtO5684M7b331GfXmStffiGqnmWedV8Qd2+yDPLzVlOqgiB/aabbsWiaBx5sDo9y1gzCgHxshATz7vDJ/aecag/Y199loL741M3oRh5s6IF2ippY0EbG9rd8iURxctbyaOc5kCBNa9kvXuQfZHvKLZ7ExQiR1peXyyLKYW90/03KSBiQ+ud5S6vpIMX6UIgzzKKe+SfQ4U5yQWLjm7bp6vY5X8tqWzefxGXM2IXQvAX1omhAyscfFUAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled5.png","title":"JPA%20N%201/Untitled5.png","src":"/static/ca29f3317ce1b991208902715823f9f7/ad007/idea64_xOWUXfJUQM.png","srcSet":["/static/ca29f3317ce1b991208902715823f9f7/8890b/idea64_xOWUXfJUQM.png 293w","/static/ca29f3317ce1b991208902715823f9f7/1f316/idea64_xOWUXfJUQM.png 585w","/static/ca29f3317ce1b991208902715823f9f7/ad007/idea64_xOWUXfJUQM.png 681w"],"sizes":["(max-width:","681px)","100vw,","681px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/529686da0e8c95478ee8f7bb8c2acff1/d33d3/Untitled6.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 4.778156996587031%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOklEQVQI12OwsnH/b2Pn8d/S2vW/tS2EbQ0Us7Jx+29r7wnGMD5IDqQerM7WA0yDxHX1rf7r6FmBaQBpSSJeAjFzHAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled6.png","title":"JPA%20N%201/Untitled6.png","src":"/static/529686da0e8c95478ee8f7bb8c2acff1/463a7/Untitled6.png","srcSet":["/static/529686da0e8c95478ee8f7bb8c2acff1/8890b/Untitled6.png 293w","/static/529686da0e8c95478ee8f7bb8c2acff1/1f316/Untitled6.png 585w","/static/529686da0e8c95478ee8f7bb8c2acff1/463a7/Untitled6.png 1170w","/static/529686da0e8c95478ee8f7bb8c2acff1/e1fbe/Untitled6.png 1755w","/static/529686da0e8c95478ee8f7bb8c2acff1/d33d3/Untitled6.png 1783w"],"sizes":["(max-width:","1170px)","100vw,","1170px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n해당 함수를 호출해서 query하면!? N + 1현상이 발생합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"첫번째 쿼리인 menu left outer join restaurant 를 했는데도 불구하고, 밑에 세개의 추가 쿼리가 실행되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"왜 이럴까? 하고 querydsl의 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"leftJoin"}]},{"type":"text","value":" 함수가 정의된 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"JPQLQuery"}]},{"type":"text","value":" 인터페이스를 추적 해보았습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 460px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/7cd075e617306d11657e6ed3c7d8ad5a/b3f9e/Untitled7.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 42.32081911262799%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYUlEQVQoz4WR63KCMBCFeZh6Qe6EJAZBRBBQlNZLO/by/q9xukRrdaYz/fHNybJZcnbXYGKFkFfwWAnHz+BHK312g1yrFy7h96q/LRCKNSxnhpEZYTwRmpHJbximHSOgS5HaEVuI+BlMrqmwAVcdoulWI2Z70hac8jzuEPD6auBipteJrWD0rzn0U8uawiIdW/L2Wn/WaCfyioBJhT19bFKdRscChuOmeI1P6GQHEVZwnVRf+GlrOGYPLf2H4XkZ3tMzDmoPJVqoKbUpN5DJgWZXwPbmdy7FnVvxJ4ZlJ0j9EqmTwaXzmJxZbkYtJLD9Jc0px2AY4mkQXFQTaB2MetgDRlYekNZvSDYfmDdnZMUeVdFiW3VYr1pklMvWn8i3X1hURyyKI8r6jKo+Yb54gUp2iNNfDMZz2l4FnrSI4oY2XELKJbVeIFYFbb4GU81FBcWC8hRLtQLjBY0lR8CWN74Bfn4FeUGF4c8AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled7.png","title":"JPA%20N%201/Untitled7.png","src":"/static/7cd075e617306d11657e6ed3c7d8ad5a/b3f9e/Untitled7.png","srcSet":["/static/7cd075e617306d11657e6ed3c7d8ad5a/8890b/Untitled7.png 293w","/static/7cd075e617306d11657e6ed3c7d8ad5a/b3f9e/Untitled7.png 460w"],"sizes":["(max-width:","460px)","100vw,","460px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"언뜻 보기에 함수의 주석 설명에는"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"주어진 target 매개변수를 기반으로 left join이 생성되어 질 것이고,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"fetchJoin을 사용하기 위해서는 fetchJoin 파라미터를 해당 join 에 추가 ("},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"정확하게는 파라미터로 이해하기보다는, fetch join 할 join 함수 뒤에 fetchJoin 함수를 추가해주면 됩니다."}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"하라고 되어있습니다. 이렇게만 보면 제 코드에서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"leftJoin"}]},{"type":"text","value":" 함수에 매개변수로 넘겨준 target이 restaurant이니 맞는 것 같기도 합니다만 현재 문제에서 안되는 이유를 찾기 위해 코드를 추적하다 querydsl fetchJoin은 다음과 같이 동작하여 JPQLQuery를 생성한다는 것을 알게되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 834px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/b1ffa0c14526d6534fbf70eab3e727c2/7df40/idea64_G1UvBO54eI.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 69.96587030716725%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB/ElEQVQ4y4WSWXPaQBCE988kIEwibgoMSFrdoPsO4NiObYhdectL/n1nVgTKRQJ5+GpmS7u93bNimp5hMDQgSyN8lscY9kboUW00e2g0ukTvjO5VmO2UmNp3uOHfMAz26BfPmEav9VrSHtDSHut6RKyvwXQjx/jWQ0tW0f6kotVR0JTnkGQFUkf9i6asXIXVkUcm5PYE/ckcM+7CdlIo2gq3MxuzuXNivnBx0x7ROPpoSgM0RT2DBHMMxxY+0MwkaQhVD1BtXhCldzDdDKaTwbBTWG4OzQjRao/xsTlAgwRFPYdxijyZehgpLrpTnZz5tViUfkWYbE8k+T2JZuj0FMjdyzCFp+BGCce9h2lvyGF4EYUHUHkCbhZ05t8wm6KIzQtyJhCHNCM6oVvJQZDTN82rE6h6dPFS5nolwqCih6B5uWk9p/NNQthcbmE4FfXB1RRMIwfF+gkZCXteAcOKalEBN0TMg+t0+wt+9gML1asvEC7fJznCbBLJvjxh45coqXeXGZx36FZMcQPM1SWJrU6OLzrUlyny9TPWfgV/VcAhUYeqS5j0u3AzJgHC/IMRXYVxO0ZWPWDj5eQwR7zKYVohOaMHMcmN7h9i1w/yf5gdPqJ6/Iky3SMnCiLL35AU35GWrwiLN8T5Hn66g5eISlA99l6ywyre1b2ovwGCq/XLCwAGBgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled8.png","title":"JPA%20N%201/Untitled8.png","src":"/static/b1ffa0c14526d6534fbf70eab3e727c2/7df40/idea64_G1UvBO54eI.png","srcSet":["/static/b1ffa0c14526d6534fbf70eab3e727c2/8890b/idea64_G1UvBO54eI.png 293w","/static/b1ffa0c14526d6534fbf70eab3e727c2/1f316/idea64_G1UvBO54eI.png 585w","/static/b1ffa0c14526d6534fbf70eab3e727c2/7df40/idea64_G1UvBO54eI.png 834w"],"sizes":["(max-width:","834px)","100vw,","834px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"디버그 된 변수를 살펴보시면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"self"}]},{"type":"text","value":"에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"JPQLQuery"}]},{"type":"text","value":"가 텍스트 로 표현되고 있습니다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"가만살펴보니 뭔가 이상합니다. 흠 네.. 지금껏 멍청하게 target을 잘못 전달하고 있었던 것이었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 708px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/44460dcff0f905267982c0ab1e966588/6106f/Untitled9.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 76.79180887372013%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUUlEQVQ4y22TS0vyURDGz2ds7VLoG7hpE7Ro4UdwEQhRtMlI1NTQIlIRkSxUvEXmpfJ+17ImfvNyfF00MJzzP2fmmXmeM3/z8/Mj1rHv728pFAqyWCzk6+tL1uu1rFYr+fz8lOVyqfvZbCaDwUBjiL+9vZVwOCzxeFyMbJkFbbVammALAMwKKAWIY53P5+rEHx0dKaixQDhJ2Gg00iCCSaQj9gBPJhMpl8tSLBalUqmoY/f393JyciJmm641kt/f36XRaMjZ2Zm4XC5JJpPaYalUkoODA9nd3ZVAICD1el1zkOn8/Pw/ZasNK512Oh3p9XoSiUTE7XarPtlsVu+r1ap4PB7tihgMYLo1luJ0Ot1Qwvv9vozHYz0D5Pn5WRMoRrxlRh731gzJdLb9KFC2HdqXZm+74X44HOors7eAgBsu/jIKoaNN6Ha7EovFJJ1Ob8aGO+IYJ+zj4+MfIOLncjmp1WpKDeGpRpfQs6PCyyI+35wDCLgdoePjYzEkNZtNeXp62ujESjWSENvOGx1zjrfbbb3Hsevra0kkEmJeXl7+pGwTAMHRi/nL5/Pa6fbwMz4+n0+ZmlQqpd2hBQ8AVbri8u3tbTPkvDhacg4rpgC7u7uT/f19PX99fRUTjUa1AnP2+PgoFGClCPShh07Iwn7bQqGQOJ1OZUPXDL65vLyUi4sLBUWDm5sbBc1kMhoEEN0gPMURPhgMyt7enjgcDi0OdWJgZvipvV6v/mJ+v1+1uLq60ur8bg8PD+qAc8ZvuLOzI6enpyoFXVOU7g4PD+UX7sJILZuQWp0AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled9.png","title":"JPA%20N%201/Untitled9.png","src":"/static/44460dcff0f905267982c0ab1e966588/6106f/Untitled9.png","srcSet":["/static/44460dcff0f905267982c0ab1e966588/8890b/Untitled9.png 293w","/static/44460dcff0f905267982c0ab1e966588/1f316/Untitled9.png 585w","/static/44460dcff0f905267982c0ab1e966588/6106f/Untitled9.png 708w"],"sizes":["(max-width:","708px)","100vw,","708px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"fetch Join이 되려면 "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"타겟이 restaurant가 아닌 menu의 프로퍼티로 존재하는 menu.restaurant가 되어야 하는것이었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n그래서 코드를 다음과 같이 수정하고 해결하였습니다!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"수정된 코드"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"class MenuRepositoryCustomImpl: MenuRepositoryCustom, QuerydslRepositorySupport(Menu::class.java) {\n    override fun findAllJoinRestaurant(): MutableList<Menu> {\n        val m = QMenu.menu\n        val r = QRestaurant.restaurant\n        return from(m)\n                //.leftJoin(r)\n                .leftJoin(m.restaurant)\n                //.on(r.id.eq(m.restaurant.id)) entity 연관관계 기반으로 어차피 맵핑되서 join함 on 조건을 주면 fetch 할 때 with 에 property를 에\n                .fetchJoin()\n                .fetch()\n    }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"수정 후 쿼리"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 583px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/35e216d7838ea09162167e1c3dc717aa/d8a90/Untitled10.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 100.6825938566553%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADLklEQVQ4y5WT2XbiRhRF9TO2BgxtBklgQEhoQhODBJKY2oEHOsNKx3aSp3xBHvPFJ7dKYNPuJKvzsFdpKJ17zz0lYWRm6Kg2GmIL3UYfjZaKvqbC1LpofehAvP0A8aZB67ch+EGOnvcRsnlAMzxBy35Ac33CQ/ETBtPPuLOPkK0DlPHxmxD8MMeDu8HtsEBtUKDV30CyckjjFepGAXm4/l8IhplyyzXxHk1ZhSzdo1Nrok2IYh23N9c0Kvv/gWCOM6hdHzWlh07HQtMwodsjjEwXujZBq8XWGLoa4r5pQFJ0SLV/QKngghoJ3sht1Bs96G0TynCI+miI5v0DZLkLhYoptR5kRcOt1HlHm68SvWMIIyuFqvsQayqkOw2iolJabcgkoPZ9DIwJegOP9ozJiU3FLzj8vtv3+CrKdCJoZILj5tBIUGrpqA8HuNP7JKah3jLgxRtE0xITCs60Z7Cc+VfYXgbDSiDf6fQdWbbdAiYlGriPmHpH+OM1HErd9TaYpzss8wOWxQFhXHCBsctYcFgRhmHFGI7oepzSDO0VvSzg+luO7ZEgYdlL+OEKs3RP7DBb7JDMWMdrJPMtpnO2N4VJRUbjKQkvuY7AHo6oCnt4DataXb+9u3Rknvezbx0/43sZ7LkwX1Ale1rZuZqNaU//dW7vYTN8FQyiFZZkKQzIIl1PiCDKyf6Cd8E/+kr4+p72kSCD3QsuzWR9+BFlWAnFSUEBkOAkfRP8QmB2dkC22Vi43Yj2ngVD6i7fn1CQYEFJpiTKwrgIXs/tFV5oAT9+hJ8cYLnVHLlgnH1E8fg973CblChJNCJRhyybr4LvhKkb2y+wPf2J489/kegRhhnyIkKU7ZE/fsKehHKyG5AwszyJaKbUpRewJOdVkmb8mqhhRvwvGhg+hiR2CVDw6WytyPKausqpwxmtAa3OJKMuMn4sHD+9Sn/+RSBvVM+EKN2i/O4TdtTRnjrcJzlZL7AIMkyoQ5d3mcEnHK8KxXQugSTnUOLzuU3oHO5+x+b0B8rVE7LiCStG/gvK8gX55jekmxcU22daf+Wsti9Yrp8wK54xJ2ZnFuUzouwz/galys6f0lJ8kQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled10.png","title":"JPA%20N%201/Untitled10.png","src":"/static/35e216d7838ea09162167e1c3dc717aa/d8a90/Untitled10.png","srcSet":["/static/35e216d7838ea09162167e1c3dc717aa/8890b/Untitled10.png 293w","/static/35e216d7838ea09162167e1c3dc717aa/d8a90/Untitled10.png 583w"],"sizes":["(max-width:","583px)","100vw,","583px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"N + 1이 해결 되고 join 쿼리 한번만 수행 되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1170px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/bb9c707870a618152342643277064f0c/05775/Untitled11.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 2.3890784982935154%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAMElEQVQI12MwNLb7b2Ri/9/E1OG/gRGUbeYIZ5sC2SAazDaHsEF6jIHqQTRIDJkPABrAIN/Y5pM/AAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"JPA%20N%201/Untitled11.png","title":"JPA%20N%201/Untitled11.png","src":"/static/bb9c707870a618152342643277064f0c/463a7/Untitled11.png","srcSet":["/static/bb9c707870a618152342643277064f0c/8890b/Untitled11.png 293w","/static/bb9c707870a618152342643277064f0c/1f316/Untitled11.png 585w","/static/bb9c707870a618152342643277064f0c/463a7/Untitled11.png 1170w","/static/bb9c707870a618152342643277064f0c/e1fbe/Untitled11.png 1755w","/static/bb9c707870a618152342643277064f0c/05775/Untitled11.png 1768w"],"sizes":["(max-width:","1170px)","100vw,","1170px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]}],"data":{"quirksMode":false}},"excerpt":"JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유 Kotlin SpringBoot(2.2.4) querydsl(4.2.1) 문제 JPA로 쿼리를 하다보면, N + 1 문제를 마주하게 될 수도 있는데요. 사실 저의 문제는 정확하게 …","timeToRead":4,"frontmatter":{"title":"JPA N+1현상 삽질","userDate":"24 February 2020","date":"2020-02-24T02:08:55.000Z","tags":["springboot","jpa","N+1","fetch join"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHEeuRQD//EABYQAQEBAAAAAAAAAAAAAAAAAAEgMf/aAAgBAQABBQI1Cf/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwIq/wD/xAAaEAEAAgMBAAAAAAAAAAAAAAABABARIVGB/9oACAEBAAE/ISOzg7DGsvKI1//aAAwDAQACAAMAAAAQ+8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAwADAAAAAAAAAAAAAAABABExEFGx/9oACAEBAAE/EDQbai6lyF9WPY7wTWx2f//Z","aspectRatio":1.7816091954022988,"src":"/static/7addc8c3b7e92bb4253ac9a7ce3c174d/2cb8a/JPA-N%2B1-postbg.jpg","srcSet":"/static/7addc8c3b7e92bb4253ac9a7ce3c174d/2f037/JPA-N%2B1-postbg.jpg 930w,\n/static/7addc8c3b7e92bb4253ac9a7ce3c174d/2cb8a/JPA-N%2B1-postbg.jpg 1424w","sizes":"(max-width: 1424px) 100vw, 1424px"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHUlEQVQ4y23UaUzTdxgH8MdjMrwiEVRALqFaoAflamGWckkLhRZpEQql9KQtxR70X44CLVdBEEQJ4BRkImZRMGSyQ5mKx+amMQ6VeMQ5jZkTyMjmwVBB9xs73/z3TZ4X3zefd88X4J+YlRagBRP+rYuytqZaisuMsiRdwoFgAvUTH/+oLzL4XQ69qTqdSU+plIszV2ft4IE4Nx9azHWASxPWBNGhzMWEQBIE0Kik6E1RSJmcORG+o3Bu44YRxFrzEcrzq0dhQbaXRM9wZFMahZhIDoUC5dJ95Y140KIshazg3MU84nZIICUN6pjYNxc/GHmcETj8NGDLmeNWWs/FvsTm0fLEs4MRHtmPdCzFTYTQkoWDdmszHkxhpwH3RD5gqOu9gFX+D0s3G69fSrs5lhFQ+9ZtxdLr/FTO9E69AdVUV51XhSvuJ/luRY5SK9luwKBUUrQYD3KzQTnQCkNXb7/vsc7vdktQI7pEPPy0KcrSH09JfGU0GOf0Ow2oTlo9JnCTvYghxKMuaxOpFauFsnwMD2ZuV0Byux0EH550ZnhRb1Yw+1/WRJ1D5bENAxWV2LTZjCFzgf6ng6y2zxkBCpTG4KOz9cfIw/WHYa+5EQ8KM4rAcrAJeoZvOG1aT7snJg2i7KBxJPSxoSKN8hU9goGqZfqSOt9dj4Iycl7HxDFRY/ZuiiO3Hkx5xXiQl6WEduUgIO1bp9VxxHsmqg1NBo+aNDHqCzqVBrF53ElbtNykjWi+7xVceIdIiURYsYNsMthBJjfgwTg+D9QcLTTH9zj5xPnfpVDLUOFG+6naImxcVahBZZjlRVFk/mVKYO0Ywb/sQUIC9400X02VSeUgypbiQe8UPyA/9gLSDMWJyqWMC1yLkWld8fc1O7Hv+CIhKmDnzrUxbadJLMP+TIG+jc8TTstE0hBplgTyc/4HjOfwIedEG1SiK8t83LY80nmlH6oUY99W2aveiNV5qJFvR2k+fRPksI5zUYycr9j02J+POvoCjtR1LzxF/SIcGEVnQSyPA0K1xNl1+foxlVg7bqmqQnqNCelEincchn3Om9L2lkz87LG3t+FlOjllEv04u3Z2/AH0NO3Hg3QC7e8nBnCOCAwdq7A5kKXEikqM5nc5dMn8BlIyog34PludJphxXyJF1vDCC0fRwIqh+V5oqKnGg2HkrbBomQu4uPmuDCHQRh2F9Vdadu2Z02oKUGmEAZ2LODZrEskmuEbOFNuTP6mgis603x1a1Xr1KJTprXgwmskB88H9cPz0rWXLnV1+iF3LRjWUStTBcfxeRy1HnxIPPD9J7X49Quq9dSRk9xPP9V7PSzQlXhq1DnIzxHiQ6EMBD1c38F7rsTKcyBrhMJRfajfveyL07UBlZDsaiume6me1T3czWu6YvFW/sSO5z9r2dro7mlvAKDfhQSqFBUVyP7CZI518N6Vc8yY0zLKYx+8Uh55EjZL+iVrj7l8qVI1zffz2URvVeDc2JPl5qkzkzsrhAy9FiAe3cdKgpikROg9plru4kqc2utcjr+ChX4sCe6ewmL3IoG2daZB0vjkW/fF8Z2Ad2uK+eU5fW+kpq9CDRCzHg0plPqSlmkAq1cKOzMz6VK7sBS2s4IaIjl1TRenHrOyK671Je27pOKUPFelyJODyOk4tbOHFhStQavB7KJPnQVdnI6D5mb96uVWdLhBuO8KKCztPZ5C+poUGXg6PCTnLSmIMs4XbJK4r1sCf44rZy0GlUP/n/AGzLBP/3rIs3AAAAABJRU5ErkJggg==","width":151,"height":151,"src":"/static/bf7f9f29887116a6d496e42f356b60db/192fd/thxwelchs.png","srcSet":"/static/bf7f9f29887116a6d496e42f356b60db/192fd/thxwelchs.png 1x"}}]}}}},"relatedPosts":{"totalCount":2,"edges":[{"node":{"id":"7254531c-d2c4-5936-8579-10bd37f8b3b0","timeToRead":5,"excerpt":"이번 포스팅에서는 내장톰캣과 설치형으로 사용하는 외장톰캣이 무엇이 다른지, 그리고 내장톰캣으로는 해결 할 수 없는것이 있는지\n간단하게 알아보았습니다.\n포스팅 내용을 작성하기 전 이 내용을 조사해본 것은 전 직장 동료분과 오랜만에 만나 개발 담소를 나…","frontmatter":{"title":"Embedded Tomcat과 Tomcat의 차이"},"fields":{"slug":"/EmbeddedTomcat과Tomcat의차이/"}}},{"node":{"id":"2df25db5-7251-5114-b0bc-61db8afd6c24","timeToRead":4,"excerpt":"JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유 Kotlin SpringBoot(2.2.4) querydsl(4.2.1) 문제 JPA로 쿼리를 하다보면, N + 1 문제를 마주하게 될 수도 있는데요. 사실 저의 문제는 정확하게 …","frontmatter":{"title":"JPA N+1현상 삽질"},"fields":{"slug":"/JPA-N+1/"}}}]}},"pageContext":{"slug":"/JPA-N+1/","prev":{"excerpt":"안녕하세요 이번에는 React로 프론트엔드 개발할 때 Visual Studio Code + Debugger for Chrome 를 활용한 디버깅 하는 방법에 대해 알아보겠습니다. 이미 디버거를 잘 활용하고 계셨던 분이라면 굳이 이 포스팅을 보실 필요…","timeToRead":4,"frontmatter":{"title":"React debugging 하기","tags":["react","deubg"],"date":"2020-02-11T23:33:04.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7816091954022988,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHt1SNFf//EABYQAQEBAAAAAAAAAAAAAAAAAAECIP/aAAgBAQABBQK1JFz/AP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABkQAAEFAAAAAAAAAAAAAAAAAAABICEiMf/aAAgBAQAGPwKuiQ3/xAAaEAABBQEAAAAAAAAAAAAAAAABABEgITFR/9oACAEBAAE/IaodNDQs8j//2gAMAwEAAgADAAAAELgP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEh/9oACAECAQE/EFR//8QAGxABAAICAwAAAAAAAAAAAAAAAREhABAxQVH/2gAIAQEAAT8QSPXFTGJRHZJS82AcEa//2Q==","sizes":"(max-width: 1424px) 100vw, 1424px","src":"/static/3e6b6a2f984747d9cc583f58840faa5e/2cb8a/react-debug-postbg.jpg","srcSet":"/static/3e6b6a2f984747d9cc583f58840faa5e/2f037/react-debug-postbg.jpg 930w,\n/static/3e6b6a2f984747d9cc583f58840faa5e/2cb8a/react-debug-postbg.jpg 1424w"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"fixed":{"src":"/static/bf7f9f29887116a6d496e42f356b60db/192fd/thxwelchs.png"}}]}}},"fields":{"layout":"post","slug":"/react-debug/"}},"next":{"excerpt":"Spring 다형성, 상속성을 이용한 중복코드 줄여보기 스프링부트를 활용하면 상당 부분 설정이 편리해진 부분이 있었지만, 흔한 MVC 패턴에서(물론 실제 개발은 MVVM 패턴으로 개발중) 엔드포인트 혹은 엔티티가 늘어 날 때마다 반복되는 코드들이 생…","timeToRead":6,"frontmatter":{"title":"Spring 중복코드 줄여보기","tags":["java","kotlin","spring","다형성","상속성"],"date":"2020-02-25T12:51:55.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7816091954022988,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHFYmSoB//EABcQAQEBAQAAAAAAAAAAAAAAAAECESD/2gAIAQEAAQUCk1qQOP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwIq/wD/xAAXEAEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAEBAAE/IYBZqkLwzz//2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSEQcf/aAAgBAQABPxAnQHVThL18aoofux3wuR2f/9k=","sizes":"(max-width: 1424px) 100vw, 1424px","src":"/static/a35a8e884b14f74b53a5eaa0d438e2f3/2cb8a/SPRING-DUPLICATION-postbg.jpg","srcSet":"/static/a35a8e884b14f74b53a5eaa0d438e2f3/2f037/SPRING-DUPLICATION-postbg.jpg 930w,\n/static/a35a8e884b14f74b53a5eaa0d438e2f3/2cb8a/SPRING-DUPLICATION-postbg.jpg 1424w"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"fixed":{"src":"/static/bf7f9f29887116a6d496e42f356b60db/192fd/thxwelchs.png"}}]}}},"fields":{"layout":"post","slug":"/SPRING-DUPLICATION/"}},"primaryTag":"springboot"}},"staticQueryHashes":["3212170248","3213104607","3993936949","794779027"]}