{"componentChunkName":"component---src-templates-post-tsx","path":"/SPRING-DUPLICATION/","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDklEQVQY003QwUoCURiG4WOExAQVuapFkUFg2cbIKDQMLY1iKMukJEvSMLR0FYqg0K42Ea1aSMsuoe6kVXQHYovGWc3pPTATLh6+/3wzwxx+kQqcLiUC9WpyQZ/8eHsXX5/fbinlkGVZgvznnPt6j5rhYtacXpz5ay+56I0M+WJpiqOeYWbIW8xgFn54MY8JLCOMQ/vZFlqYwro43sw8puNl0zMSiVOcG7+9bfIBJ7hHBXdoo4FnbqOySl6Sc3hCCU2hrxZfKxs1uaYFdYqYaZhZcgcHuEaSD9XLZfUTZpW72EceEaQQRVEs+gqh7MpV8yK4N6128NPpjtn7cNu7GoCrb3caRu15mN6ZBzH+B9oQInTA7ID+AAAAAElFTkSuQmCC","width":400,"height":90,"src":"/static/8637e594ca86d58e20988ba8c4cfc1e7/497c6/thxwelchs-logo-v2.png","srcSet":"/static/8637e594ca86d58e20988ba8c4cfc1e7/497c6/thxwelchs-logo-v2.png 1x"}}},"markdownRemark":{"html":"<h1>Spring 다형성, 상속성을 이용한 중복코드 줄여보기</h1>\n<p>스프링부트를 활용하면 상당 부분 설정이 편리해진 부분이 있었지만, 흔한 MVC 패턴에서(물론 실제 개발은 MVVM 패턴으로 개발중) 엔드포인트 혹은 엔티티가 늘어 날 때마다 반복되는 코드들이 생기는게 불만스러웠습니다. 그래서 고민을 하게 되었습니다.</p>\n<blockquote>\n<p>객체지향스럽게(?) 다형성과 상속성을 지키는 구조로 중복되는 코드들을 줄여보는게 어떨까?</p>\n</blockquote>\n<h1>공통이되 중복되는 부분 제거</h1>\n<p>먼저 저의 스프링부트 구조에서 중복을 없앨만한 요소들을 찾아 보았습니다.</p>\n<p>저의 스프링부트 프로젝트의 모듈구조는 싱글모듈 구조 였고, </p>\n<p><code class=\"language-text\">controller</code>, <code class=\"language-text\">model</code>(entity), <code class=\"language-text\">service</code>, <code class=\"language-text\">repository</code> 를 주요 레이어로 가지는 구조였기에</p>\n<p><code class=\"language-text\">entity</code>가 늘어나면 늘어난 entity 기반으로 <code class=\"language-text\">controller</code>, <code class=\"language-text\">repository</code>, <code class=\"language-text\">service</code>를 생성해주어야 했습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 123px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eb9cd826c2f454a0edfebb81e2a80baf/44f7a/Untitled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.41463414634146%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZklEQVQ4y3VTyW7aQBjmgZqqlyopwRvBLMZ431iMjQFjsxmKSBelyiGKlCqHHqo+QO99x68zhlBctYdZrPH8/7fMV2J4GZvtRwzDFGVBRvrWwH3Fx219BFF2oZtDGNYQfjCD149hmANE4yV6A7K3A1RrGvgbFQJZ6SgxfAfTWQbHG4EROvAuVXzr7/Er+wrVDuGHcwRBimSeYTjOEIYzTKcrzFe3CMIEXFU5FcsL0umy3ECZkSCIGmq8Ak0w0K4Z4EjnqqjnCOhFTlDy/d9DOENZYsmPFL6i98ETtG80G696AzCOjxtSTGxauKkbqNVNtDsemm0XjZZJGvyhWaBc4dr48Oke43gNhpNxoVqQdrfo/fgOu59ilWaYrfaYzLbY7j5js96TwjbYc6rnBelE6VAtqcBXYgdXpgveC3J0YsOApHRzdJQFXYWaWkBVQEg/6EWqFVeVIWkxZH0OQSCXSCP22IwlhtEXUdT1Hxpes23cfXlAnG5RrjThxs+wxo+wp0/QnRGS5D1myQrhNMtdXS53iOINglGKUZSg3rILTucIVX1AxHbIQQeyOYdir6F4O0hqD447wTRewPNjuN0I3d4YljeB7Y4QRCkaTTNHXdCQPhmKtEq0YUQD5VaPGCSBJRTfkbP8/PhPmWmBGkll4M+onihXyKXsmBSWbeHCv8Pl4hm1xSOakg3bi+B0x4R+CIskwyQytDvO/015SYpNksKR6L0215A3TzAefkLR+nmzMFqSlCwwHCaYJBtY1iA36VCEGnNYT5Svcwpy/mxYkpCqFqKp+qfOVPTDXicOa8eEaIXIvYzfDN/4XhFuKZcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled/Untitled.png\"\n        title=\"Untitled/Untitled.png\"\n        src=\"/static/eb9cd826c2f454a0edfebb81e2a80baf/44f7a/Untitled.png\"\n        srcset=\"/static/eb9cd826c2f454a0edfebb81e2a80baf/44f7a/Untitled.png 123w\"\n        sizes=\"(max-width: 123px) 100vw, 123px\"\n      />\n  </a>\n    </span></p>\n<p><br>\n그래서 controller, repository, service의 공통되는 부분을 묶어서 중복을 제거하고자 했습니다.</p>\n<p><br/><br/></p>\n<h2>Service 공통 부분 중복 제거</h2>\n<p>중복되는 부분은 예를 들어 <code class=\"language-text\">service</code>에서 단순히 <code class=\"language-text\">repository</code>를 통해 처리 한 뒤  <code class=\"language-text\">controller</code>에게 전달해주는 그런 로직들이 대상이 될 것 입니다.  예시 코드입니다. </p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Service\nclass MenuService(private val menuRepository: MenuRepository) {\n        // 이런거.. 일일이 굳이 코드로 작성 할 필요는 없지 않을까?\n        fun save(menu: Menu): Menu { \n        return menuRepository.save()\n        }\n\n    fun findAll(): MutableList&lt;Menu&gt; {\n        return menuRepository.findAll()\n    }\n\n        ...\n}</code>\n        </deckgo-highlight-code>\n      \n<p>물론 controller에서 바로 repository를 DI하여 작업을 수행 할 수도 있겠지만\n가능하면 <code class=\"language-text\">controller</code> -> <code class=\"language-text\">service</code> -> <code class=\"language-text\">repository</code> | <code class=\"language-text\">other service</code> 의 레이어 형태를 지키는\n것이 바람직하지 않을까? 라는 생각 하고 있습니다.\n그래서 위 예시코드에 기본적으로 제공되는 메소드들을 굳이 직접 service에 작성하지 않고 호출하는 구조로 만들고 싶어서 다음과 같이 entity를 다루는 service라면 반드시 상속받게 할 BaseEntityService를 생성했습니다.</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">/**\n    * Entity 공통 Service\n    * Generics description\n    * E: Entity, ID: Entity Primary Key (직렬화 할 수 있는 형태의 자료 형태)\n    *\n    * SimpleJpaRepository는 JpaRepository의 실질적인 구현체 클래스입니다.\n    * SimpleJpaRepository를 상속받기 위해선 반드시 super생성자로 클래스를 초기화 해주어야 하는 것 같은데,\n    * 그 super 생성자는 찾아보니 두개의 생성자로 오버로딩 되어 있고, 저는 그 중 하나인 \n    * entity의 클래스 타입과, entityManager를 받는 생성자로 슈퍼클래스 상속받게 했습니다.\n    */\nabstract class BaseEntityService&lt;E : Any, ID : Serializable?&gt;(\n        clazz: KClass&lt;E&gt;,\n        entityManager: EntityManager) : SimpleJpaRepository&lt;E, ID&gt;(clazz.java, entityManager) {\n}</code>\n        </deckgo-highlight-code>\n      \n<p>저는 JpaRepository가 어떤 구현체로 이루어져있는지 관심도 없었는데 이번에 처음 관심 갖게 되었고, 살펴보게 되었습니다. </p>\n<p>다음과 같이 두가지 생성자가 있는데 저는 두번째 타입의 생성자를 통해 상속하고 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 750px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/739946555da520379ebceb0d8d474aeb/44507/Untitled1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.25938566552901%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUElEQVQ4y11T13ajMBTkY7I2TYAqYJrBTrOTs7vJtv//kdmRHJzyMGdA92puVZSXA5J8h0J0qIis6pHJgTwgFS0yf1b0Aenbd05Wglz2F3/6+jtJ5hAV5YiUTrqa4Ko9hJog9B4ZUdC5LCcUcubl8SJGFuTG+8oJuRqvSPMa0UvzA7W8Q21OAUrfodK36PQRz+4JnbmjcIdNrD/hZquw2eqAb2/f28QicnJB4Q4X6BnCMLJdoOwB0h4vpWcNhM+M7fFIPdOes5qCdmnmEHSbUjBzO6iGGdaPUG6Grg8BhaajHWFqlrcbULcjmm6EawbaiWYMLArf5zaUGwRj1zDCATVLlXqCYaYVGyxVB206CvXY9QNs3cE2PGMCxu4ghKOIQ0yRTWxCuXHCoWhBZ9WgplNrO5SMKDi9kqUUFPZRbzaKfTKEDryJbRBYEacuIGTYqwMWltK3C9rxDNs/sJ/sK/tiOBzDzD0kpyjZX0VkvrzEvQt9EI1i/qSpj2Rw4yN6Q1YHY5o2YSAefscSnqfelqxlmqvYylEu90i4V4pTdNzFPEx5RkZOS5bPM8E9FNw7/wg8+7NSLYF9kE8Z1lybstxDkzUvlob/HE7LCyqI8IXkLV8T4bN94/V/zW5FdHbPsPKWQ+CqVDMmc49eHrHT/OeT9Bc26xLH5jrRrwO5ZnicXzE9/cV4/oPx9AvT4yv643eMywvm5Tcm2sdb2h/+YTr8RNufuI8X2OaBe/kZkfZ9aQfkzTsy7pzUC6y+D5PWhH85ir31q1TIPrwM37+v+A93tMIbg/5eUQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled/Untitled%201.png\"\n        title=\"Untitled/Untitled%201.png\"\n        src=\"/static/739946555da520379ebceb0d8d474aeb/44507/Untitled1.png\"\n        srcset=\"/static/739946555da520379ebceb0d8d474aeb/8890b/Untitled1.png 293w,\n/static/739946555da520379ebceb0d8d474aeb/1f316/Untitled1.png 585w,\n/static/739946555da520379ebceb0d8d474aeb/44507/Untitled1.png 750w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n      />\n  </a>\n    </span></p>\n<p>그럼 <code class=\"language-text\">BaseEntityService</code>가 완성되었으니 사용하게 될 Service에서 상속만 하면 되겠죠? </p>\n<p>그 구조는 다음과 같습니다.</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Service\nclass MenuService(\n        private val menuRepository: MenuRepository,\n        private val entityManager: EntityManager\n) : BaseEntityService&lt;Menu, Int&gt;(Menu::class, entityManager) {\n\n        // 이런거.. 일일이 굳이 코드로 작성 할 필요는 없지 않을까?\n        // BaseEntityService에 이미 구현되어 있으니\n        // 이제 이런 JpaRepository에서 정의된 함수들은 없어도 됌\n        /*\n        fun save(menu: Menu): Menu { \n        return menuRepository.save()\n        }\n\n    fun findAll(): MutableList&lt;Menu&gt; {\n        return menuRepository.findAll()\n    }\n        \n        ...\n        */\n\n    fun findAllJoinRestaurant(): MutableList&lt;Menu&gt; {\n        return menuRepository.findAllJoinRestaurant()\n    }\n}</code>\n        </deckgo-highlight-code>\n      \n<p>이 서비스는 <code class=\"language-text\">Menu</code> 엔티티의 비즈니스로직을 처리하는 <code class=\"language-text\">Service</code>이고, Entity 타입과, Entity의 기본키가 될 자료타입을 제네릭으로 넘겨주고 Entity의 클래스와 DI 받은 EntityManager를 슈퍼클래스 생성자에 인자로 전달해주는 구조입니다.</p>\n<p>위처럼 구조를 갖춘 이유는, 사실 아직 제가 잘 몰라서..ㅋㅋ 도 맞지만</p>\n<p>BaseEntityService에서 받을 제네릭타입의 클래스를 런타임에선 얻을 수 없다는 걸 알았습니다.</p>\n<p>Spring에서 제공하는 어떤 Util이 있다는 자료를 보긴 했지만, 일단은 포기하고 저렇게 인자로 전달해주는 방식을 선택했습니다.</p>\n<p>어쨌든.. 저 형태를 갖추게 되면 MenuService에 직접적인 find, save, delete 등 JpaRepository에 정의되어진 spring data jpa의 기본 메소드들을 사용 할 수 있게 됩니다. 혹시 메소드의 재정의가 필요하다면 override하여 재정의 하면 됩니다.</p>\n<p>그 다음은 controller 차례입니다.</p>\n<p><br/><br/></p>\n<h2>Controller 공통 부분 중복 제거</h2>\n<p>먼저 controller에서 항상 공통이되 중복되는 부분이 어떤걸까요?</p>\n<p>주로 <code class=\"language-text\">전체조회하기</code>, <code class=\"language-text\">id로 하나 조회하기,</code> <code class=\"language-text\">삭제하기</code>, <code class=\"language-text\">수정하기</code>, <code class=\"language-text\">등록하기</code> 정도가 될 것 같습니다.</p>\n<p>그래서 이것들을 제거하기 위해 다음과 같은 BaseAPIController를 작성했습니다.</p>\n<p>저는 Restful 한 구조의 엔드포인트를 관리하는 controller를 생성할 것이기 때문에 <code class=\"language-text\">@RestController</code> 전용 슈퍼클래스를 생성 했습니다.</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">/**\n    * Rest API 공통 컨트롤러\n    * Generics description\n    * E: Entity, ID: Entity Primary Key (직렬화 할 수 있는 형태의 자료 형태), S: 해당 엔티티의 비즈니스 로직을 처리하기 위한 서비스 클래스 (BaseEntityService를 상속하는 객체 여야 함.)\n    */\n@RestController\nabstract class BaseAPIController&lt;E : Any, ID : Serializable, S : BaseEntityService&lt;E, ID&gt;&gt; {\n    @Autowired\n    lateinit var service: S\n\n    @GetMapping(&quot;/{id}&quot;)\n    fun getOneByID(@PathVariable id: ID): ResponseEntity&lt;E&gt; {\n        return ResponseEntity.ok(service.findById(id).orElseThrow { EntityNotFoundException() })\n    }\n\n    @GetMapping\n    fun get(): ResponseEntity&lt;MutableList&lt;E&gt;?&gt; {\n        return ResponseEntity.ok(service.findAll())\n    }\n\n    @PostMapping\n    fun create(entity: E): ResponseEntity&lt;E&gt; {\n        return ResponseEntity.ok(service.save(entity))\n    }\n\n    @PutMapping\n    fun update(entity: E): ResponseEntity&lt;E&gt; {\n        return ResponseEntity.ok(service.save(entity))\n    }\n\n    @DeleteMapping(&quot;/{id}&quot;)\n    fun deleteById(@PathVariable id: ID) {\n        service.deleteById(id)\n    }\n\n    @DeleteMapping\n    fun delete(entity: E) {\n        service.delete(entity)\n    }\n}</code>\n        </deckgo-highlight-code>\n      \n<p>상속받을 슈퍼클래스를 만들었으니 상속만 하면 슈퍼클래스에서 제공하는 엔드포인트는 모두 코드 작성 없이도 얻을 수 있을 것 같습니다.</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@RestController\n@RequestMapping(&quot;$API_VERSION_PREFIX/menus&quot;) // ENDPOINT: localhost:8080/v1/menus\nclass MenuController(\n        private val menuService: MenuService\n) : BaseAPIController&lt;Menu, Int, MenuService&gt;() {\n        // 여긴 분명.. 비어 있는데?\n}</code>\n        </deckgo-highlight-code>\n      \n<p>다음과 같이 슈퍼클래스에서 제공하는 엔드포인트에 정상적으로 요청하여 응답받아오는 것을 보실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 926px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6818db4932de6dc846a786978921974e/96b7d/Untitled2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.26621160409556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhElEQVQoz5WSSVbDMAyGfQ/qZm4GZ3BGpylNgbYs2HAMdhyMW3CyH8nQvEfZ0MX3LMmypF+JeHh8xG63wzzPOB6POJ/POJ1OOBwOMMYsTNOEcRx/xdgfR4POTAjePnD3/gnxNO/Rdy2GYcDQ9zCU1JsBPdlt26LrOnsaMy6xpmksWmvUNUF2cf+CfP8KMRt6UNdI0/QPeZ6jqqrFz7LMcrFrene5z5IIKg4hsryAUgpxHCNJkgX2uSBPcH13gVVx0e/71CIMyS3LkjpplLqyHdkviuKH0vrXcKGyraEbmvIH3WiI5+MTttstRl7ydiR7sgvn2EQL72uSRPKUyhbJmfUVMkJdIRLeDyXkuiGJFEwThGFoiSI6Ax+u68LzvF/YmOtZ2L4gHMeBXK2gWgNFRVUUYENFfNfBWkqsVhJS/h/x3d1HWmhU/YBNGMClJh7FHWeN9fo2BD8M6es0uwPqgn4Jkhl4LnyCO3KSvKWg75M82ldME0bRBoHL0zl2Sik5Sd404ReeLEf2Bga8xwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled/Untitled%202.png\"\n        title=\"Untitled/Untitled%202.png\"\n        src=\"/static/6818db4932de6dc846a786978921974e/96b7d/Untitled2.png\"\n        srcset=\"/static/6818db4932de6dc846a786978921974e/8890b/Untitled2.png 293w,\n/static/6818db4932de6dc846a786978921974e/1f316/Untitled2.png 585w,\n/static/6818db4932de6dc846a786978921974e/96b7d/Untitled2.png 926w\"\n        sizes=\"(max-width: 926px) 100vw, 926px\"\n      />\n  </a>\n    </span></p>\n<p>음.. 이걸론 뭔가 부족한 것 같아서 덧붙여 AOP로 request 정보를 logging하는 것도 추가해보겠습니다.</p>\n<h2>AOP request logger 추가</h2>\n<p>먼저 저는 Kotlin에서 사용하는 KotlinLogging을 통해 logging을 할거라서 의존성을 하나 추가해주었습니다. java나 기존 slf4j를 사용하실거라면 이 의존성은 필요 없습니다.</p>\n<p>그러나 org.springframework.boot:spring-boot-starter-web 에서 제공하는 Aspect를 이용할 것이기 때문에 해당 의존성은 필수입니다. 아마 스프링부트 프로젝트라면 따로 추가하실 필요는 없습니다.</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">//logging\nimplementation(&quot;io.github.microutils:kotlin-logging:1.7.6&quot;)</code>\n        </deckgo-highlight-code>\n      \n<p>다음과 같이 Aspect logger를 작성해주고 pointcut과 around전략을 세웠습니다.</p>\n<p>보시다시피 그냥 request를 받는 controller 메소드들에 한해서 request 정보를 로깅하는 용도입니다.</p>\n<p>추후 APM(애플리케이션 성능 관리 툴)같은 것을 활용해서 로깅 추적 같은 것을 할 때 도움이 될 것 같습니다.</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@Component\n@Aspect\nclass RequestLoggerAspect {\n\n    private val logger = KotlinLogging.logger{}\n\n    // 해당 패키지 하위에 있는 컨트롤러의 모든 메소드에 적용\n    @Pointcut(&quot;execution(* com.example.demo..controller.*.*(..))&quot;)\n    fun requestPointCut() {}\n\n    @Around(&quot;requestPointCut()&quot;)\n    @Throws(Throwable::class)\n    fun requestLogger(joinPoint: ProceedingJoinPoint): Any {\n        val result = joinPoint.proceed()\n        val request = (RequestContextHolder.currentRequestAttributes() as ServletRequestAttributes).request\n\n        // TODO mapper를 빈으로 등록 해버리고 싱글톤 형태로 관리할까?\n        val mapper = ObjectMapper()\n\n        val logMap: MutableMap&lt;String, Any&gt; = HashMap()\n        logMap[&quot;sessionID&quot;] = request.requestedSessionId?: &quot;&quot;\n        logMap[&quot;requestURI&quot;] = request.requestURI\n        logMap[&quot;requestMethod&quot;] = request.method\n        logMap[&quot;sourceMethod&quot;] = joinPoint.signature.declaringType.simpleName + &quot;.&quot; + joinPoint.signature.name\n        logMap[&quot;params&quot;] = request.parameterMap\n\n        logger.info(mapper.writerWithDefaultPrettyPrinter().writeValueAsString(logMap))\n\n        return joinPoint.proceed()\n    }\n}</code>\n        </deckgo-highlight-code>\n      \n<p>자, 이제 AOP 적용 후 요청을 해보면?</p>\n<p>다음과 같이 로깅됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 731px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eeed86cb0f82fee8b5d989908965342b/9f2f1/Untitled3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.795221843003414%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVQY03WO2xKCIBRF/ZkCIw0BQVMB05rpMtP/f80OSB9q6mHNGc5h1t6Z8zdM5yfceIe1Vxg7g6sBhnsUvINpZyjtIaQDqyxKPSWKhbKZwYQF3WmwokUma59kx+6CQ9XDNBOEckFqEW9Kj9jtG2yIBKEKNK8T2/SWy1QgYRfJdBD40yM0sOBiSJKS9+8PITXOmL5CFugfUsMqyGKLlZx9itb0790v4Qus/n8Y8tZBiQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled/Untitled%203.png\"\n        title=\"Untitled/Untitled%203.png\"\n        src=\"/static/eeed86cb0f82fee8b5d989908965342b/9f2f1/Untitled3.png\"\n        srcset=\"/static/eeed86cb0f82fee8b5d989908965342b/8890b/Untitled3.png 293w,\n/static/eeed86cb0f82fee8b5d989908965342b/1f316/Untitled3.png 585w,\n/static/eeed86cb0f82fee8b5d989908965342b/9f2f1/Untitled3.png 731w\"\n        sizes=\"(max-width: 731px) 100vw, 731px\"\n      />\n  </a>\n    </span></p>\n<p><br/><br/></p>\n<h2>Repository 공통 부분 중복 제거</h2>\n<p>예를 들어 createdAt 컬럼에 인덱스가 있고 범위 조회를 해야 하는 조건과 같은 것이 될 수도 있겠습니다. (<code class=\"language-text\">SELECT * FROM entity WHERE createdAt BETWEEN &#39;YYYY-MM-DD&#39; AND &#39;YYYY-MM-DD&#39;</code>) 혹은 2차캐시를 적용하거나 locking이 필요한 경우에도 공통되는 부분들을 이 <code class=\"language-text\">BaseEntityRepository</code>에 정의 후 각각의 엔티티 <code class=\"language-text\">Repository</code>에서 상속받게 하면 중복되는 부분들이 제거 되고 한결 깔끔해진 코드를 볼 수 있을 것 같습니다.</p>\n<p>아 이 공통 repository는 상속용 interface이므로 스프링부트 애플리케이션이\n처음 로드 되면서 컴포넌트 클래스(Controller, Repository, Component)들을 빈에 등록 할 때 이 인터페이스도 포함하면 안되므로 반드시 <code class=\"language-text\">@NoRepositoryBean</code> 어노테이션을 달아주어야 합니다.</p>\n\n        <deckgo-highlight-code language=\"kotlin\" >\n          <code slot=\"code\">@NoRepositoryBean\ninterface BaseEntityRepository&lt;T, ID : Serializable?&gt;: JpaRepository&lt;T, ID&gt; {\n    fun findByCreatedAtBetween(start: LocalDateTime, end: LocalDateTime): MutableList&lt;T&gt;\n\n    @Query(&quot;SELECT t FROM #{#entityName} t WHERE t.id &gt;= :id&quot;) // 이런식으로 T로 받은 제네릭을 JPQL에서도 활용 가능합니다.\n    fun findByBiggerId(id: ID): MutableList&lt;T&gt;\n\n    @Query(&quot;SELECT t FROM #{#entityName} t WHERE t.id = :id&quot;)\n    @Lock(LockModeType.PESSIMISTIC_WRITE)\n    fun findByIdWithExclusiveLock(id: ID): T\n\n    @Query(&quot;SELECT t FROM #{#entityName} t WHERE t.id = :id&quot;)\n    @Lock(LockModeType.PESSIMISTIC_READ)\n    fun findByIdWithSharedLock(id: ID): T\n}</code>\n        </deckgo-highlight-code>\n      \n<p>글이 너무 길어져 쓰고보니 많이 장황하네요, 어쨌든 앞으로 이런 중복되는 코드를 제거해가며 확장성 있는 구조가 될 수 있게 하는 연구를 많이 해 봐야겠습니다!</p>\n<p><br>\n코드링크 -> <a href=\"https://github.com/thxwelchs/springboot-starter-with-kotlin\">https://github.com/thxwelchs/springboot-starter-with-kotlin</a></p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Spring 다형성, 상속성을 이용한 중복코드 줄여보기"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"스프링부트를 활용하면 상당 부분 설정이 편리해진 부분이 있었지만, 흔한 MVC 패턴에서(물론 실제 개발은 MVVM 패턴으로 개발중) 엔드포인트 혹은 엔티티가 늘어 날 때마다 반복되는 코드들이 생기는게 불만스러웠습니다. 그래서 고민을 하게 되었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"객체지향스럽게(?) 다형성과 상속성을 지키는 구조로 중복되는 코드들을 줄여보는게 어떨까?"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"공통이되 중복되는 부분 제거"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 저의 스프링부트 구조에서 중복을 없앨만한 요소들을 찾아 보았습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"저의 스프링부트 프로젝트의 모듈구조는 싱글모듈 구조 였고, "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"controller"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"model"}]},{"type":"text","value":"(entity), "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"service"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"repository"}]},{"type":"text","value":" 를 주요 레이어로 가지는 구조였기에"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"entity"}]},{"type":"text","value":"가 늘어나면 늘어난 entity 기반으로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"controller"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"repository"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"service"}]},{"type":"text","value":"를 생성해주어야 했습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 123px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/eb9cd826c2f454a0edfebb81e2a80baf/44f7a/Untitled.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 63.41463414634146%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZklEQVQ4y3VTyW7aQBjmgZqqlyopwRvBLMZ431iMjQFjsxmKSBelyiGKlCqHHqo+QO99x68zhlBctYdZrPH8/7fMV2J4GZvtRwzDFGVBRvrWwH3Fx219BFF2oZtDGNYQfjCD149hmANE4yV6A7K3A1RrGvgbFQJZ6SgxfAfTWQbHG4EROvAuVXzr7/Er+wrVDuGHcwRBimSeYTjOEIYzTKcrzFe3CMIEXFU5FcsL0umy3ECZkSCIGmq8Ak0w0K4Z4EjnqqjnCOhFTlDy/d9DOENZYsmPFL6i98ETtG80G696AzCOjxtSTGxauKkbqNVNtDsemm0XjZZJGvyhWaBc4dr48Oke43gNhpNxoVqQdrfo/fgOu59ilWaYrfaYzLbY7j5js96TwjbYc6rnBelE6VAtqcBXYgdXpgveC3J0YsOApHRzdJQFXYWaWkBVQEg/6EWqFVeVIWkxZH0OQSCXSCP22IwlhtEXUdT1Hxpes23cfXlAnG5RrjThxs+wxo+wp0/QnRGS5D1myQrhNMtdXS53iOINglGKUZSg3rILTucIVX1AxHbIQQeyOYdir6F4O0hqD447wTRewPNjuN0I3d4YljeB7Y4QRCkaTTNHXdCQPhmKtEq0YUQD5VaPGCSBJRTfkbP8/PhPmWmBGkll4M+onihXyKXsmBSWbeHCv8Pl4hm1xSOakg3bi+B0x4R+CIskwyQytDvO/015SYpNksKR6L0215A3TzAefkLR+nmzMFqSlCwwHCaYJBtY1iA36VCEGnNYT5Svcwpy/mxYkpCqFqKp+qfOVPTDXicOa8eEaIXIvYzfDN/4XhFuKZcAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Untitled/Untitled.png","title":"Untitled/Untitled.png","src":"/static/eb9cd826c2f454a0edfebb81e2a80baf/44f7a/Untitled.png","srcSet":["/static/eb9cd826c2f454a0edfebb81e2a80baf/44f7a/Untitled.png 123w"],"sizes":["(max-width:","123px)","100vw,","123px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n그래서 controller, repository, service의 공통되는 부분을 묶어서 중복을 제거하고자 했습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Service 공통 부분 중복 제거"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"중복되는 부분은 예를 들어 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"service"}]},{"type":"text","value":"에서 단순히 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"repository"}]},{"type":"text","value":"를 통해 처리 한 뒤  "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"controller"}]},{"type":"text","value":"에게 전달해주는 그런 로직들이 대상이 될 것 입니다.  예시 코드입니다. "}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Service\nclass MenuService(private val menuRepository: MenuRepository) {\n        // 이런거.. 일일이 굳이 코드로 작성 할 필요는 없지 않을까?\n        fun save(menu: Menu): Menu { \n        return menuRepository.save()\n        }\n\n    fun findAll(): MutableList<Menu> {\n        return menuRepository.findAll()\n    }\n\n        ...\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"물론 controller에서 바로 repository를 DI하여 작업을 수행 할 수도 있겠지만\n가능하면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"controller"}]},{"type":"text","value":" -> "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"service"}]},{"type":"text","value":" -> "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"repository"}]},{"type":"text","value":" | "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"other service"}]},{"type":"text","value":" 의 레이어 형태를 지키는\n것이 바람직하지 않을까? 라는 생각 하고 있습니다.\n그래서 위 예시코드에 기본적으로 제공되는 메소드들을 굳이 직접 service에 작성하지 않고 호출하는 구조로 만들고 싶어서 다음과 같이 entity를 다루는 service라면 반드시 상속받게 할 BaseEntityService를 생성했습니다."}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"/**\n    * Entity 공통 Service\n    * Generics description\n    * E: Entity, ID: Entity Primary Key (직렬화 할 수 있는 형태의 자료 형태)\n    *\n    * SimpleJpaRepository는 JpaRepository의 실질적인 구현체 클래스입니다.\n    * SimpleJpaRepository를 상속받기 위해선 반드시 super생성자로 클래스를 초기화 해주어야 하는 것 같은데,\n    * 그 super 생성자는 찾아보니 두개의 생성자로 오버로딩 되어 있고, 저는 그 중 하나인 \n    * entity의 클래스 타입과, entityManager를 받는 생성자로 슈퍼클래스 상속받게 했습니다.\n    */\nabstract class BaseEntityService<E : Any, ID : Serializable?>(\n        clazz: KClass<E>,\n        entityManager: EntityManager) : SimpleJpaRepository<E, ID>(clazz.java, entityManager) {\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"저는 JpaRepository가 어떤 구현체로 이루어져있는지 관심도 없었는데 이번에 처음 관심 갖게 되었고, 살펴보게 되었습니다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"다음과 같이 두가지 생성자가 있는데 저는 두번째 타입의 생성자를 통해 상속하고 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 750px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/739946555da520379ebceb0d8d474aeb/44507/Untitled1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 68.25938566552901%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUElEQVQ4y11T13ajMBTkY7I2TYAqYJrBTrOTs7vJtv//kdmRHJzyMGdA92puVZSXA5J8h0J0qIis6pHJgTwgFS0yf1b0Aenbd05Wglz2F3/6+jtJ5hAV5YiUTrqa4Ko9hJog9B4ZUdC5LCcUcubl8SJGFuTG+8oJuRqvSPMa0UvzA7W8Q21OAUrfodK36PQRz+4JnbmjcIdNrD/hZquw2eqAb2/f28QicnJB4Q4X6BnCMLJdoOwB0h4vpWcNhM+M7fFIPdOes5qCdmnmEHSbUjBzO6iGGdaPUG6Grg8BhaajHWFqlrcbULcjmm6EawbaiWYMLArf5zaUGwRj1zDCATVLlXqCYaYVGyxVB206CvXY9QNs3cE2PGMCxu4ghKOIQ0yRTWxCuXHCoWhBZ9WgplNrO5SMKDi9kqUUFPZRbzaKfTKEDryJbRBYEacuIGTYqwMWltK3C9rxDNs/sJ/sK/tiOBzDzD0kpyjZX0VkvrzEvQt9EI1i/qSpj2Rw4yN6Q1YHY5o2YSAefscSnqfelqxlmqvYylEu90i4V4pTdNzFPEx5RkZOS5bPM8E9FNw7/wg8+7NSLYF9kE8Z1lybstxDkzUvlob/HE7LCyqI8IXkLV8T4bN94/V/zW5FdHbPsPKWQ+CqVDMmc49eHrHT/OeT9Bc26xLH5jrRrwO5ZnicXzE9/cV4/oPx9AvT4yv643eMywvm5Tcm2sdb2h/+YTr8RNufuI8X2OaBe/kZkfZ9aQfkzTsy7pzUC6y+D5PWhH85ir31q1TIPrwM37+v+A93tMIbg/5eUQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Untitled/Untitled%201.png","title":"Untitled/Untitled%201.png","src":"/static/739946555da520379ebceb0d8d474aeb/44507/Untitled1.png","srcSet":["/static/739946555da520379ebceb0d8d474aeb/8890b/Untitled1.png 293w","/static/739946555da520379ebceb0d8d474aeb/1f316/Untitled1.png 585w","/static/739946555da520379ebceb0d8d474aeb/44507/Untitled1.png 750w"],"sizes":["(max-width:","750px)","100vw,","750px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그럼 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"BaseEntityService"}]},{"type":"text","value":"가 완성되었으니 사용하게 될 Service에서 상속만 하면 되겠죠? "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그 구조는 다음과 같습니다."}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Service\nclass MenuService(\n        private val menuRepository: MenuRepository,\n        private val entityManager: EntityManager\n) : BaseEntityService<Menu, Int>(Menu::class, entityManager) {\n\n        // 이런거.. 일일이 굳이 코드로 작성 할 필요는 없지 않을까?\n        // BaseEntityService에 이미 구현되어 있으니\n        // 이제 이런 JpaRepository에서 정의된 함수들은 없어도 됌\n        /*\n        fun save(menu: Menu): Menu { \n        return menuRepository.save()\n        }\n\n    fun findAll(): MutableList<Menu> {\n        return menuRepository.findAll()\n    }\n        \n        ...\n        */\n\n    fun findAllJoinRestaurant(): MutableList<Menu> {\n        return menuRepository.findAllJoinRestaurant()\n    }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이 서비스는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Menu"}]},{"type":"text","value":" 엔티티의 비즈니스로직을 처리하는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Service"}]},{"type":"text","value":"이고, Entity 타입과, Entity의 기본키가 될 자료타입을 제네릭으로 넘겨주고 Entity의 클래스와 DI 받은 EntityManager를 슈퍼클래스 생성자에 인자로 전달해주는 구조입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위처럼 구조를 갖춘 이유는, 사실 아직 제가 잘 몰라서..ㅋㅋ 도 맞지만"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"BaseEntityService에서 받을 제네릭타입의 클래스를 런타임에선 얻을 수 없다는 걸 알았습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Spring에서 제공하는 어떤 Util이 있다는 자료를 보긴 했지만, 일단은 포기하고 저렇게 인자로 전달해주는 방식을 선택했습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"어쨌든.. 저 형태를 갖추게 되면 MenuService에 직접적인 find, save, delete 등 JpaRepository에 정의되어진 spring data jpa의 기본 메소드들을 사용 할 수 있게 됩니다. 혹시 메소드의 재정의가 필요하다면 override하여 재정의 하면 됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그 다음은 controller 차례입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Controller 공통 부분 중복 제거"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 controller에서 항상 공통이되 중복되는 부분이 어떤걸까요?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"주로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"전체조회하기"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"id로 하나 조회하기,"}]},{"type":"text","value":" "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"삭제하기"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"수정하기"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"등록하기"}]},{"type":"text","value":" 정도가 될 것 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그래서 이것들을 제거하기 위해 다음과 같은 BaseAPIController를 작성했습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"저는 Restful 한 구조의 엔드포인트를 관리하는 controller를 생성할 것이기 때문에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@RestController"}]},{"type":"text","value":" 전용 슈퍼클래스를 생성 했습니다."}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"/**\n    * Rest API 공통 컨트롤러\n    * Generics description\n    * E: Entity, ID: Entity Primary Key (직렬화 할 수 있는 형태의 자료 형태), S: 해당 엔티티의 비즈니스 로직을 처리하기 위한 서비스 클래스 (BaseEntityService를 상속하는 객체 여야 함.)\n    */\n@RestController\nabstract class BaseAPIController<E : Any, ID : Serializable, S : BaseEntityService<E, ID>> {\n    @Autowired\n    lateinit var service: S\n\n    @GetMapping(\"/{id}\")\n    fun getOneByID(@PathVariable id: ID): ResponseEntity<E> {\n        return ResponseEntity.ok(service.findById(id).orElseThrow { EntityNotFoundException() })\n    }\n\n    @GetMapping\n    fun get(): ResponseEntity<MutableList<E>?> {\n        return ResponseEntity.ok(service.findAll())\n    }\n\n    @PostMapping\n    fun create(entity: E): ResponseEntity<E> {\n        return ResponseEntity.ok(service.save(entity))\n    }\n\n    @PutMapping\n    fun update(entity: E): ResponseEntity<E> {\n        return ResponseEntity.ok(service.save(entity))\n    }\n\n    @DeleteMapping(\"/{id}\")\n    fun deleteById(@PathVariable id: ID) {\n        service.deleteById(id)\n    }\n\n    @DeleteMapping\n    fun delete(entity: E) {\n        service.delete(entity)\n    }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"상속받을 슈퍼클래스를 만들었으니 상속만 하면 슈퍼클래스에서 제공하는 엔드포인트는 모두 코드 작성 없이도 얻을 수 있을 것 같습니다."}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@RestController\n@RequestMapping(\"$API_VERSION_PREFIX/menus\") // ENDPOINT: localhost:8080/v1/menus\nclass MenuController(\n        private val menuService: MenuService\n) : BaseAPIController<Menu, Int, MenuService>() {\n        // 여긴 분명.. 비어 있는데?\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"다음과 같이 슈퍼클래스에서 제공하는 엔드포인트에 정상적으로 요청하여 응답받아오는 것을 보실 수 있습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 926px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/6818db4932de6dc846a786978921974e/96b7d/Untitled2.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 54.26621160409556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhElEQVQoz5WSSVbDMAyGfQ/qZm4GZ3BGpylNgbYs2HAMdhyMW3CyH8nQvEfZ0MX3LMmypF+JeHh8xG63wzzPOB6POJ/POJ1OOBwOMMYsTNOEcRx/xdgfR4POTAjePnD3/gnxNO/Rdy2GYcDQ9zCU1JsBPdlt26LrOnsaMy6xpmksWmvUNUF2cf+CfP8KMRt6UNdI0/QPeZ6jqqrFz7LMcrFrene5z5IIKg4hsryAUgpxHCNJkgX2uSBPcH13gVVx0e/71CIMyS3LkjpplLqyHdkviuKH0vrXcKGyraEbmvIH3WiI5+MTttstRl7ydiR7sgvn2EQL72uSRPKUyhbJmfUVMkJdIRLeDyXkuiGJFEwThGFoiSI6Ax+u68LzvF/YmOtZ2L4gHMeBXK2gWgNFRVUUYENFfNfBWkqsVhJS/h/x3d1HWmhU/YBNGMClJh7FHWeN9fo2BD8M6es0uwPqgn4Jkhl4LnyCO3KSvKWg75M82ldME0bRBoHL0zl2Sik5Sd404ReeLEf2Bga8xwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Untitled/Untitled%202.png","title":"Untitled/Untitled%202.png","src":"/static/6818db4932de6dc846a786978921974e/96b7d/Untitled2.png","srcSet":["/static/6818db4932de6dc846a786978921974e/8890b/Untitled2.png 293w","/static/6818db4932de6dc846a786978921974e/1f316/Untitled2.png 585w","/static/6818db4932de6dc846a786978921974e/96b7d/Untitled2.png 926w"],"sizes":["(max-width:","926px)","100vw,","926px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"음.. 이걸론 뭔가 부족한 것 같아서 덧붙여 AOP로 request 정보를 logging하는 것도 추가해보겠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"AOP request logger 추가"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"먼저 저는 Kotlin에서 사용하는 KotlinLogging을 통해 logging을 할거라서 의존성을 하나 추가해주었습니다. java나 기존 slf4j를 사용하실거라면 이 의존성은 필요 없습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그러나 org.springframework.boot:spring-boot-starter-web 에서 제공하는 Aspect를 이용할 것이기 때문에 해당 의존성은 필수입니다. 아마 스프링부트 프로젝트라면 따로 추가하실 필요는 없습니다."}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"//logging\nimplementation(\"io.github.microutils:kotlin-logging:1.7.6\")"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"다음과 같이 Aspect logger를 작성해주고 pointcut과 around전략을 세웠습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"보시다시피 그냥 request를 받는 controller 메소드들에 한해서 request 정보를 로깅하는 용도입니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"추후 APM(애플리케이션 성능 관리 툴)같은 것을 활용해서 로깅 추적 같은 것을 할 때 도움이 될 것 같습니다."}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@Component\n@Aspect\nclass RequestLoggerAspect {\n\n    private val logger = KotlinLogging.logger{}\n\n    // 해당 패키지 하위에 있는 컨트롤러의 모든 메소드에 적용\n    @Pointcut(\"execution(* com.example.demo..controller.*.*(..))\")\n    fun requestPointCut() {}\n\n    @Around(\"requestPointCut()\")\n    @Throws(Throwable::class)\n    fun requestLogger(joinPoint: ProceedingJoinPoint): Any {\n        val result = joinPoint.proceed()\n        val request = (RequestContextHolder.currentRequestAttributes() as ServletRequestAttributes).request\n\n        // TODO mapper를 빈으로 등록 해버리고 싱글톤 형태로 관리할까?\n        val mapper = ObjectMapper()\n\n        val logMap: MutableMap<String, Any> = HashMap()\n        logMap[\"sessionID\"] = request.requestedSessionId?: \"\"\n        logMap[\"requestURI\"] = request.requestURI\n        logMap[\"requestMethod\"] = request.method\n        logMap[\"sourceMethod\"] = joinPoint.signature.declaringType.simpleName + \".\" + joinPoint.signature.name\n        logMap[\"params\"] = request.parameterMap\n\n        logger.info(mapper.writerWithDefaultPrettyPrinter().writeValueAsString(logMap))\n\n        return joinPoint.proceed()\n    }\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"자, 이제 AOP 적용 후 요청을 해보면?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"다음과 같이 로깅됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 731px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/eeed86cb0f82fee8b5d989908965342b/9f2f1/Untitled3.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 19.795221843003414%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVQY03WO2xKCIBRF/ZkCIw0BQVMB05rpMtP/f80OSB9q6mHNGc5h1t6Z8zdM5yfceIe1Vxg7g6sBhnsUvINpZyjtIaQDqyxKPSWKhbKZwYQF3WmwokUma59kx+6CQ9XDNBOEckFqEW9Kj9jtG2yIBKEKNK8T2/SWy1QgYRfJdBD40yM0sOBiSJKS9+8PITXOmL5CFugfUsMqyGKLlZx9itb0790v4Qus/n8Y8tZBiQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Untitled/Untitled%203.png","title":"Untitled/Untitled%203.png","src":"/static/eeed86cb0f82fee8b5d989908965342b/9f2f1/Untitled3.png","srcSet":["/static/eeed86cb0f82fee8b5d989908965342b/8890b/Untitled3.png 293w","/static/eeed86cb0f82fee8b5d989908965342b/1f316/Untitled3.png 585w","/static/eeed86cb0f82fee8b5d989908965342b/9f2f1/Untitled3.png 731w"],"sizes":["(max-width:","731px)","100vw,","731px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"br","properties":{},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Repository 공통 부분 중복 제거"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"예를 들어 createdAt 컬럼에 인덱스가 있고 범위 조회를 해야 하는 조건과 같은 것이 될 수도 있겠습니다. ("},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SELECT * FROM entity WHERE createdAt BETWEEN 'YYYY-MM-DD' AND 'YYYY-MM-DD'"}]},{"type":"text","value":") 혹은 2차캐시를 적용하거나 locking이 필요한 경우에도 공통되는 부분들을 이 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"BaseEntityRepository"}]},{"type":"text","value":"에 정의 후 각각의 엔티티 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Repository"}]},{"type":"text","value":"에서 상속받게 하면 중복되는 부분들이 제거 되고 한결 깔끔해진 코드를 볼 수 있을 것 같습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아 이 공통 repository는 상속용 interface이므로 스프링부트 애플리케이션이\n처음 로드 되면서 컴포넌트 클래스(Controller, Repository, Component)들을 빈에 등록 할 때 이 인터페이스도 포함하면 안되므로 반드시 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"@NoRepositoryBean"}]},{"type":"text","value":" 어노테이션을 달아주어야 합니다."}]},{"type":"text","value":"\n\n        "},{"type":"element","tagName":"deckgo-highlight-code","properties":{"language":"kotlin"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"@NoRepositoryBean\ninterface BaseEntityRepository<T, ID : Serializable?>: JpaRepository<T, ID> {\n    fun findByCreatedAtBetween(start: LocalDateTime, end: LocalDateTime): MutableList<T>\n\n    @Query(\"SELECT t FROM #{#entityName} t WHERE t.id >= :id\") // 이런식으로 T로 받은 제네릭을 JPQL에서도 활용 가능합니다.\n    fun findByBiggerId(id: ID): MutableList<T>\n\n    @Query(\"SELECT t FROM #{#entityName} t WHERE t.id = :id\")\n    @Lock(LockModeType.PESSIMISTIC_WRITE)\n    fun findByIdWithExclusiveLock(id: ID): T\n\n    @Query(\"SELECT t FROM #{#entityName} t WHERE t.id = :id\")\n    @Lock(LockModeType.PESSIMISTIC_READ)\n    fun findByIdWithSharedLock(id: ID): T\n}"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n      \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"글이 너무 길어져 쓰고보니 많이 장황하네요, 어쨌든 앞으로 이런 중복되는 코드를 제거해가며 확장성 있는 구조가 될 수 있게 하는 연구를 많이 해 봐야겠습니다!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n코드링크 -> "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/thxwelchs/springboot-starter-with-kotlin"},"children":[{"type":"text","value":"https://github.com/thxwelchs/springboot-starter-with-kotlin"}]}]}],"data":{"quirksMode":false}},"excerpt":"Spring 다형성, 상속성을 이용한 중복코드 줄여보기 스프링부트를 활용하면 상당 부분 설정이 편리해진 부분이 있었지만, 흔한 MVC 패턴에서(물론 실제 개발은 MVVM 패턴으로 개발중) 엔드포인트 혹은 엔티티가 늘어 날 때마다 반복되는 코드들이 생…","timeToRead":6,"frontmatter":{"title":"Spring 중복코드 줄여보기","userDate":"25 February 2020","date":"2020-02-25T12:51:55.000Z","tags":["java","kotlin","spring","다형성","상속성"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHFYmSoB//EABcQAQEBAQAAAAAAAAAAAAAAAAECESD/2gAIAQEAAQUCk1qQOP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwIq/wD/xAAXEAEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAEBAAE/IYBZqkLwzz//2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSEQcf/aAAgBAQABPxAnQHVThL18aoofux3wuR2f/9k=","aspectRatio":1.7816091954022988,"src":"/static/a35a8e884b14f74b53a5eaa0d438e2f3/2cb8a/SPRING-DUPLICATION-postbg.jpg","srcSet":"/static/a35a8e884b14f74b53a5eaa0d438e2f3/2f037/SPRING-DUPLICATION-postbg.jpg 930w,\n/static/a35a8e884b14f74b53a5eaa0d438e2f3/2cb8a/SPRING-DUPLICATION-postbg.jpg 1424w","sizes":"(max-width: 1424px) 100vw, 1424px"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHUlEQVQ4y23UaUzTdxgH8MdjMrwiEVRALqFaoAflamGWckkLhRZpEQql9KQtxR70X44CLVdBEEQJ4BRkImZRMGSyQ5mKx+amMQ6VeMQ5jZkTyMjmwVBB9xs73/z3TZ4X3zefd88X4J+YlRagBRP+rYuytqZaisuMsiRdwoFgAvUTH/+oLzL4XQ69qTqdSU+plIszV2ft4IE4Nx9azHWASxPWBNGhzMWEQBIE0Kik6E1RSJmcORG+o3Bu44YRxFrzEcrzq0dhQbaXRM9wZFMahZhIDoUC5dJ95Y140KIshazg3MU84nZIICUN6pjYNxc/GHmcETj8NGDLmeNWWs/FvsTm0fLEs4MRHtmPdCzFTYTQkoWDdmszHkxhpwH3RD5gqOu9gFX+D0s3G69fSrs5lhFQ+9ZtxdLr/FTO9E69AdVUV51XhSvuJ/luRY5SK9luwKBUUrQYD3KzQTnQCkNXb7/vsc7vdktQI7pEPPy0KcrSH09JfGU0GOf0Ow2oTlo9JnCTvYghxKMuaxOpFauFsnwMD2ZuV0Byux0EH550ZnhRb1Yw+1/WRJ1D5bENAxWV2LTZjCFzgf6ng6y2zxkBCpTG4KOz9cfIw/WHYa+5EQ8KM4rAcrAJeoZvOG1aT7snJg2i7KBxJPSxoSKN8hU9goGqZfqSOt9dj4Iycl7HxDFRY/ZuiiO3Hkx5xXiQl6WEduUgIO1bp9VxxHsmqg1NBo+aNDHqCzqVBrF53ElbtNykjWi+7xVceIdIiURYsYNsMthBJjfgwTg+D9QcLTTH9zj5xPnfpVDLUOFG+6naImxcVahBZZjlRVFk/mVKYO0Ywb/sQUIC9400X02VSeUgypbiQe8UPyA/9gLSDMWJyqWMC1yLkWld8fc1O7Hv+CIhKmDnzrUxbadJLMP+TIG+jc8TTstE0hBplgTyc/4HjOfwIedEG1SiK8t83LY80nmlH6oUY99W2aveiNV5qJFvR2k+fRPksI5zUYycr9j02J+POvoCjtR1LzxF/SIcGEVnQSyPA0K1xNl1+foxlVg7bqmqQnqNCelEincchn3Om9L2lkz87LG3t+FlOjllEv04u3Z2/AH0NO3Hg3QC7e8nBnCOCAwdq7A5kKXEikqM5nc5dMn8BlIyog34PludJphxXyJF1vDCC0fRwIqh+V5oqKnGg2HkrbBomQu4uPmuDCHQRh2F9Vdadu2Z02oKUGmEAZ2LODZrEskmuEbOFNuTP6mgis603x1a1Xr1KJTprXgwmskB88H9cPz0rWXLnV1+iF3LRjWUStTBcfxeRy1HnxIPPD9J7X49Quq9dSRk9xPP9V7PSzQlXhq1DnIzxHiQ6EMBD1c38F7rsTKcyBrhMJRfajfveyL07UBlZDsaiume6me1T3czWu6YvFW/sSO5z9r2dro7mlvAKDfhQSqFBUVyP7CZI518N6Vc8yY0zLKYx+8Uh55EjZL+iVrj7l8qVI1zffz2URvVeDc2JPl5qkzkzsrhAy9FiAe3cdKgpikROg9plru4kqc2utcjr+ChX4sCe6ewmL3IoG2daZB0vjkW/fF8Z2Ad2uK+eU5fW+kpq9CDRCzHg0plPqSlmkAq1cKOzMz6VK7sBS2s4IaIjl1TRenHrOyK671Je27pOKUPFelyJODyOk4tbOHFhStQavB7KJPnQVdnI6D5mb96uVWdLhBuO8KKCztPZ5C+poUGXg6PCTnLSmIMs4XbJK4r1sCf44rZy0GlUP/n/AGzLBP/3rIs3AAAAABJRU5ErkJggg==","width":151,"height":151,"src":"/static/bf7f9f29887116a6d496e42f356b60db/192fd/thxwelchs.png","srcSet":"/static/bf7f9f29887116a6d496e42f356b60db/192fd/thxwelchs.png 1x"}}]}}}},"relatedPosts":{"totalCount":6,"edges":[{"node":{"id":"1be5d82f-1384-5422-9261-03f165e6a660","timeToRead":1,"excerpt":"AOP 직역하면 관점지향프로그래밍 인데, 한국말로 들으면 전혀 와닿지 않습니다. 좀 더 이해가 가기 쉬운 의미로 해석해보자면, 애플리케이션 전체에 걸쳐 사용되는 기능을 재사용하도록 지원하는 것입니다. 실무에서는 흔히 공통적인 흐름의 코드를 적용시켜 …","frontmatter":{"title":"AOP 관점지향프로그래밍"},"fields":{"slug":"/AOP/"}}},{"node":{"id":"0cae626f-2f31-5a5d-b97a-f8f8bb745f18","timeToRead":3,"excerpt":"Java 와일드카드 제네릭  제네릭은 Unbound wildcard라고 불리며, 어떤 타입이 될지 모른다 라는 의미입니다. wildcard가 사용된 제네릭은 타입으로 들어온 타입에 대하여 관심이 없다 라는 의미도 되며 기능적인 메소드 외에 원소 값과…","frontmatter":{"title":"제네릭 1편 와일드카드 (Generic Wildcard)"},"fields":{"slug":"/GENERIC-1/"}}},{"node":{"id":"9d3d5903-8625-510d-a3d2-7a8e73051b91","timeToRead":3,"excerpt":"낙관적 락 충돌이 발생하지 않을 거라고 낙관적으로 가정하는 방법 데이터베이스 레벨이 아닌 JPA레벨에서 버전 관리 기능을 통해 구현되어있음 테이블에 version 관리를 할 컬럼을 지정해놓고 읽었을 때의 버전과, 변경 할 때의 버전이 같지 않으면 예…","frontmatter":{"title":"JPA Locking"},"fields":{"slug":"/JPA-locking/"}}}]}},"pageContext":{"slug":"/SPRING-DUPLICATION/","prev":{"excerpt":"JPA N+1현상 querydsl fetchJoin 삽질한 경험 공유 Kotlin SpringBoot(2.2.4) querydsl(4.2.1) 문제 JPA로 쿼리를 하다보면, N + 1 문제를 마주하게 될 수도 있는데요. 사실 저의 문제는 정확하게 …","timeToRead":4,"frontmatter":{"title":"JPA N+1현상 삽질","tags":["springboot","jpa","N+1","fetch join"],"date":"2020-02-24T02:08:55.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7816091954022988,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHEeuRQD//EABYQAQEBAAAAAAAAAAAAAAAAAAEgMf/aAAgBAQABBQI1Cf/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwIq/wD/xAAaEAEAAgMBAAAAAAAAAAAAAAABABARIVGB/9oACAEBAAE/ISOzg7DGsvKI1//aAAwDAQACAAMAAAAQ+8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAwADAAAAAAAAAAAAAAABABExEFGx/9oACAEBAAE/EDQbai6lyF9WPY7wTWx2f//Z","sizes":"(max-width: 1424px) 100vw, 1424px","src":"/static/7addc8c3b7e92bb4253ac9a7ce3c174d/2cb8a/JPA-N%2B1-postbg.jpg","srcSet":"/static/7addc8c3b7e92bb4253ac9a7ce3c174d/2f037/JPA-N%2B1-postbg.jpg 930w,\n/static/7addc8c3b7e92bb4253ac9a7ce3c174d/2cb8a/JPA-N%2B1-postbg.jpg 1424w"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"fixed":{"src":"/static/bf7f9f29887116a6d496e42f356b60db/192fd/thxwelchs.png"}}]}}},"fields":{"layout":"post","slug":"/JPA-N+1/"}},"next":{"excerpt":"2020년이 되면서 javascript 표준 규격인 ECMA script 에도 몇가지 추가된 사항들이 생겼습니다!\n 어떤 것들이 있는지 한번 살펴보겠습니다. 널 병합 연산자 (Nullish coalescing operator) 널 병합 연산자란 왼쪽…","timeToRead":3,"frontmatter":{"title":"ES2020","tags":["javascript","es2020","ecma script","ECMA"],"date":"2020-02-29T22:31:55.000Z","draft":false,"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7816091954022988,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHvSsjRX//EABgQAAMBAQAAAAAAAAAAAAAAAAECEQAg/9oACAEBAAEFAiZka8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGH/8QAFhAAAwAAAAAAAAAAAAAAAAAAACAh/9oACAEBAAY/Air/AP/EABkQAQEAAwEAAAAAAAAAAAAAAAERACAhUf/aAAgBAQABPyEBVmOkZbyea//aAAwDAQACAAMAAAAQ8A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAWEQEBAQAAAAAAAAAAAAAAAAABEFH/2gAIAQIBAT8QQo5P/8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAIEFRYf/aAAgBAQABPxAjSbhPnJN9V//Z","sizes":"(max-width: 1424px) 100vw, 1424px","src":"/static/b9d3879f84d259be41f5e4820f4ebfef/2cb8a/ES2020-postbg.jpg","srcSet":"/static/b9d3879f84d259be41f5e4820f4ebfef/2f037/ES2020-postbg.jpg 930w,\n/static/b9d3879f84d259be41f5e4820f4ebfef/2cb8a/ES2020-postbg.jpg 1424w"}}},"author":{"id":"thxwelchs","bio":"thxwelchs","avatar":{"children":[{"fixed":{"src":"/static/bf7f9f29887116a6d496e42f356b60db/192fd/thxwelchs.png"}}]}}},"fields":{"layout":"post","slug":"/ES2020/"}},"primaryTag":"java"}},"staticQueryHashes":["3212170248","3213104607","3993936949","794779027"]}